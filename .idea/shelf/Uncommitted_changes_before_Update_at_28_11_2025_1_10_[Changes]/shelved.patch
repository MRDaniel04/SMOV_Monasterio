Index: app/src/main/java/com/nextapp/monasterio/repository/PinRepository.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.repository\r\n\r\nimport android.util.Log\r\nimport androidx.compose.ui.graphics.toArgb\r\nimport com.google.firebase.firestore.DocumentReference\r\nimport com.google.firebase.firestore.FirebaseFirestore\r\nimport com.google.firebase.firestore.SetOptions\r\nimport com.nextapp.monasterio.models.*\r\nimport kotlinx.coroutines.tasks.await\r\n\r\nobject PinRepository {\r\n    private val firestore = FirebaseFirestore.getInstance()\r\n    private val collection = firestore.collection(\"pines\")\r\n\r\n    // -----------------------\r\n    // CREATE\r\n    // -----------------------\r\n    suspend fun createPinAutoId(pinPayload: Map<String, Any?>): String {\r\n        val docRef = collection.add(pinPayload).await()\r\n        val generatedId = docRef.id\r\n        docRef.set(mapOf(\"id\" to generatedId), SetOptions.merge()).await()\r\n        return generatedId\r\n    }\r\n\r\n\r\n\r\n\r\n    suspend fun createPin(pin: PinData): String {\r\n\r\n        val imagenesRefs = pin.imagenes.map { url ->\r\n            createImagenDocument(url)\r\n        }\r\n\r\n        val payload = mapOf(\r\n            \"titulo\" to pin.titulo,\r\n            \"tituloIngles\" to pin.tituloIngles,\r\n            \"tituloAleman\" to pin.tituloAleman,\r\n            \"ubicacion\" to pin.ubicacion?.name,\r\n            \"x\" to pin.x.toDouble(),\r\n            \"y\" to pin.y.toDouble(),\r\n            \"imagenes\" to imagenesRefs,\r\n            \"descripcion\" to pin.descripcion,\r\n            \"descripcionIngles\" to pin.descripcionIngles,\r\n            \"descripcionAleman\" to pin.descripcionAleman,\r\n            \"vista360Url\" to pin.vista360Url,\r\n            \"audioUrl_es\" to pin.audioUrl_es,\r\n            \"audioUrl_en\" to pin.audioUrl_en,\r\n            \"audioUrl_ge\" to pin.audioUrl_ge,\r\n            \"tipoDestino\" to \"detalle\",\r\n            \"valorDestino\" to \"auto\"\r\n        )\r\n\r\n        return createPinAutoId(payload)\r\n    }\r\n\r\n\r\n\r\n    suspend fun createPinFromForm(\r\n        titulo: String,\r\n        descripcion: String?,\r\n        tituloIngles: String? = null,\r\n        tituloAleman: String? = null,\r\n        descripcionIngles: String? = null,\r\n        descripcionAleman: String? = null,\r\n        ubicacion: String?,\r\n        imagenes: List<String>,   // URLs de Cloudinary\r\n        imagen360: String?,       // URL de la imagen 360 (opcional)\r\n        x: Float,\r\n        y: Float\r\n    ): String {\r\n\r\n        // 1\uFE0F‚É£ Crear documentos en la colecci√≥n /imagenes y obtener REFERENCIAS\r\n        val imagenesRefs: List<DocumentReference> = imagenes.map { url ->\r\n            createImagenDocument(url) // crea doc y retorna DocumentReference\r\n        }\r\n\r\n        val payload = mapOf(\r\n            \"titulo\" to titulo,\r\n            \"descripcion\" to descripcion,\r\n\r\n            \"tituloIngles\" to tituloIngles.orEmpty(),\r\n            \"tituloAleman\" to tituloAleman.orEmpty(),\r\n            \"descripcionIngles\" to descripcionIngles,\r\n            \"descripcionAleman\" to descripcionAleman,\r\n\r\n            \"ubicacion\" to ubicacion,\r\n            \"x\" to x.toDouble(),\r\n            \"y\" to y.toDouble(),\r\n            \"imagenes\" to imagenesRefs,\r\n            \"vista360Url\" to imagen360,\r\n            \"audioUrl_es\" to null,\r\n            \"audioUrl_en\" to null,\r\n            \"audioUrl_ge\" to null,\r\n            \"tipoDestino\" to \"detalle\",\r\n            \"valorDestino\" to \"auto\"\r\n        )\r\n\r\n        // 3\uFE0F‚É£ Crear el documento del pin\r\n        return createPinAutoId(payload)\r\n    }\r\n\r\n\r\n\r\n    private fun safeUbicacionOf(name: String): Ubicacion? {\r\n        return try {\r\n            Ubicacion.valueOf(name)\r\n        } catch (_: Exception) {\r\n            null\r\n        }\r\n    }\r\n    // -----------------------\r\n    // READ: todos los pines\r\n    // -----------------------\r\n    suspend fun getAllPins(): List<PinData> {\r\n        val snapshot = collection.get().await()\r\n        Log.d(\"PinRepository\", \"\uD83D\uDCE6 getAllPins() ‚Üí ${snapshot.size()} documentos\")\r\n        return snapshot.documents.mapNotNull { doc ->\r\n            mapDocToPinData(doc.id, doc.data)\r\n        }\r\n    }\r\n\r\n    // -----------------------\r\n    // READ: pin individual\r\n    // -----------------------\r\n    suspend fun getPinById(id: String): PinData? {\r\n        val doc = collection.document(id).get().await()\r\n        if (!doc.exists()) return null\r\n\r\n        val basePin = mapDocToPinData(doc.id, doc.data) ?: return null\r\n\r\n        // \uD83D\uDD25 Cargar cada imagen desde /imagenes/\r\n        val imagenesDetalladas = basePin.imagenes.map { imagenId ->\r\n            val imgDoc = firestore.collection(\"imagenes\").document(imagenId).get().await()\r\n\r\n            ImagenData(\r\n                url = imgDoc.getString(\"url\") ?: \"\",\r\n                etiqueta = imgDoc.getString(\"etiqueta\") ?: \"\",\r\n                titulo = imgDoc.getString(\"titulo\") ?: \"\",\r\n                tituloIngles = imgDoc.getString(\"tituloIngles\") ?: \"\",\r\n                tituloAleman = imgDoc.getString(\"tituloAleman\") ?: \"\"\r\n            )\r\n        }\r\n\r\n        return basePin.copy(\r\n            imagenesDetalladas = imagenesDetalladas\r\n        )\r\n    }\r\n\r\n\r\n    suspend fun deletePin(pinId: String): Boolean {\r\n        return try {\r\n            collection.document(pinId)\r\n                .delete()\r\n                .await()\r\n            Log.d(\"PinRepository\", \"‚úÖ Pin '$pinId' eliminado correctamente.\")\r\n            true\r\n        } catch (e: Exception) {\r\n            Log.e(\"PinRepository\", \"‚ùå Error al eliminar el pin '$pinId'\", e)\r\n            false\r\n        }\r\n    }\r\n\r\n    suspend fun updatePinPosition(pinId: String, newX: Float, newY: Float) {\r\n        val payload = mapOf(\r\n            \"x\" to newX.toDouble(), // Firebase usa Double para n√∫meros\r\n            \"y\" to newY.toDouble()\r\n        )\r\n        try {\r\n            collection.document(pinId)\r\n                .update(payload)\r\n                .await()\r\n\r\n        } catch (e: Exception) {\r\n\r\n            throw e // Propagar el error para manejo en la UI\r\n        }\r\n    }\r\n\r\n    // -----------------------\r\n    // Helper: mapear doc -> PinData\r\n    // -----------------------\r\n    private fun mapDocToPinData(docId: String, data: Map<String, Any>?): PinData? {\r\n        if (data == null) return null\r\n\r\n        return try {\r\n\r\n            val titulo = data[\"titulo\"] as? String ?: \"\"\r\n            val tituloIngles = data[\"tituloIngles\"] as? String ?: \"\"\r\n            val tituloAleman = data[\"tituloAleman\"] as? String ?: \"\"\r\n\r\n            val ubicacion = (data[\"ubicacion\"] as? String)?.let { safeUbicacionOf(it) }\r\n            val ubicacionIngles = (data[\"ubicacionIngles\"] as? String)?.let { safeUbicacionOf(it) }\r\n            val ubicacionAleman = (data[\"ubicacionAleman\"] as? String)?.let { safeUbicacionOf(it) }\r\n\r\n            val x = (data[\"x\"] as? Number)?.toFloat() ?: 0f\r\n            val y = (data[\"y\"] as? Number)?.toFloat() ?: 0f\r\n\r\n            // \uD83D\uDFE6 Cargamos SOLO los IDs de referencias a im√°genes\r\n            val imagenes: List<String> = when (val raw = data[\"imagenes\"]) {\r\n                is List<*> -> raw.mapNotNull { ref ->\r\n                    when (ref) {\r\n                        is DocumentReference -> ref.id\r\n                        else -> null\r\n                    }\r\n                }\r\n                else -> emptyList()\r\n            }\r\n\r\n            val descripcion = data[\"descripcion\"] as? String\r\n            val descripcionIngles = data[\"descripcionIngles\"] as? String\r\n            val descripcionAleman = data[\"descripcionAleman\"] as? String\r\n            val vista360Url = data[\"vista360Url\"] as? String\r\n\r\n            val audioUrl_es = data[\"audioUrl_es\"] as? String\r\n            val audioUrl_en = data[\"audioUrl_en\"] as? String\r\n            val audioUrl_ge = data[\"audioUrl_ge\"] as? String\r\n\r\n            val tapRadius = (data[\"tapRadius\"] as? Number)?.toFloat() ?: 0.04f\r\n            val tipoDestino = data[\"tipoDestino\"] as? String\r\n            val valorDestino = data[\"valorDestino\"] as? String\r\n\r\n            val destino = when (tipoDestino?.lowercase()) {\r\n                \"ruta\" -> DestinoPin.Ruta(valorDestino ?: \"\")\r\n                \"detalle\" -> DestinoPin.Detalle(valorDestino ?: docId)\r\n                \"popup\" -> DestinoPin.Popup(valorDestino ?: \"Sin mensaje\")\r\n                else -> DestinoPin.Detalle(docId)\r\n            }\r\n\r\n            PinData(\r\n                id = docId,\r\n                titulo = titulo,\r\n                tituloIngles = tituloIngles,\r\n                tituloAleman = tituloAleman,\r\n                ubicacion = ubicacion,\r\n                ubicacionIngles = ubicacionIngles,\r\n                ubicacionAleman = ubicacionAleman,\r\n                x = x,\r\n                y = y,\r\n                color = null,\r\n                iconRes = null,\r\n                imagenes = imagenes,\r\n                imagenesDetalladas = emptyList(),   // ‚úî CORRECTO\r\n                descripcion = descripcion,\r\n                descripcionIngles = descripcionIngles,\r\n                descripcionAleman = descripcionAleman,\r\n                tipoDestino = tipoDestino,\r\n                valorDestino = valorDestino,\r\n                destino = destino,\r\n                tapRadius = tapRadius,\r\n                vista360Url = vista360Url,\r\n                audioUrl_es = audioUrl_es,\r\n                audioUrl_en = audioUrl_en,\r\n                audioUrl_ge = audioUrl_ge\r\n            )\r\n\r\n\r\n        } catch (e: Exception) {\r\n            Log.e(\"PinRepository\", \"‚ùå Error mapeando pin $docId\", e)\r\n            null\r\n        }\r\n    }\r\n\r\n\r\n    private suspend fun createImagenDocument(url: String): DocumentReference {\r\n        val imagenesCollection = firestore.collection(\"imagenes\")\r\n\r\n        val payload = mapOf(\r\n            \"url\" to url,\r\n            \"etiqueta\" to \"\",\r\n            \"titulo\" to \"\",\r\n            \"tituloIngles\" to \"\",\r\n            \"tituloAleman\" to \"\",\r\n            \"tituloFrances\" to \"\",\r\n            \"foco\" to \"centro\"\r\n        )\r\n\r\n        val docRef = imagenesCollection.add(payload).await()\r\n        return docRef\r\n    }\r\n\r\n    suspend fun deletePinAndImages(pinId: String): Boolean {\r\n        return try {\r\n            val firestore = FirebaseFirestore.getInstance()\r\n\r\n            val pinDoc = firestore.collection(\"pines\").document(pinId).get().await()\r\n            if (!pinDoc.exists()) return false\r\n\r\n            val imagenesRefs = pinDoc.get(\"imagenes\") as? List<DocumentReference> ?: emptyList()\r\n\r\n            imagenesRefs.forEach { ref ->\r\n                try {\r\n                    ref.delete().await()\r\n                    Log.d(\"PinRepository\", \"\uD83D\uDDD1 Imagen eliminada: ${ref.id}\")\r\n                } catch (e: Exception) {\r\n                    Log.e(\"PinRepository\", \"‚ùå Error eliminando imagen ${ref.id}\", e)\r\n                }\r\n            }\r\n\r\n            firestore.collection(\"pines\").document(pinId).delete().await()\r\n\r\n            Log.d(\"PinRepository\", \"\uD83D\uDDD1 Pin eliminado correctamente: $pinId\")\r\n            true\r\n\r\n        } catch (e: Exception) {\r\n            Log.e(\"PinRepository\", \"‚ùå Error eliminando pin completo $pinId\", e)\r\n            false\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/repository/PinRepository.kt b/app/src/main/java/com/nextapp/monasterio/repository/PinRepository.kt
--- a/app/src/main/java/com/nextapp/monasterio/repository/PinRepository.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/repository/PinRepository.kt	(date 1764288605343)
@@ -145,6 +145,51 @@
             imagenesDetalladas = imagenesDetalladas
         )
     }
+        if (basePin.imagenes.isEmpty()) {
+            Log.w("PinRepository", "‚ö†Ô∏è El pin $id no tiene referencias de im√°genes")
+        } else {
+            Log.d("PinRepository", "üîó Referencias detectadas: ${basePin.imagenes}")
+        }
+
+        val imagenesDetalladas = mutableListOf<ImagenData>()
+
+        for (ref in basePin.imagenes) {
+            try {
+                val imageId = ref.substringAfterLast("/")
+                val imageDoc = firestore.collection("imagenes").document(imageId).get().await()
+                if (imageDoc.exists()) {
+                    val url = imageDoc.getString("url") ?: ""
+                    val etiqueta = imageDoc.getString("etiqueta") ?: ""
+                    val titulo = imageDoc.getString("titulo") ?: ""
+                    val tituloIngles = imageDoc.getString("tituloIngles") ?: ""
+                    val tituloAleman = imageDoc.getString("tituloAleman") ?: ""
+                    val foco = imageDoc.getString("foco") ?: ""
+
+                    Log.d(
+                        "PinRepository",
+                        "‚úÖ Imagen encontrada '$imageId' ‚Üí etiqueta='$etiqueta', titulo='$titulo', url='$url'"
+                    )
+
+                    if (url.isNotBlank()) {
+                        imagenesDetalladas.add(
+                            ImagenData(
+                                id = imageId,
+                                url = url,
+                                etiqueta = etiqueta,
+                                titulo = titulo,
+                                tituloIngles = tituloIngles,
+                                tituloAleman = tituloAleman,
+                                foco = foco,
+                            )
+                        )
+                    }
+                } else {
+                    Log.w("PinRepository", "‚ö†Ô∏è Documento no encontrado en /imagenes/: $imageId")
+                }
+            } catch (e: Exception) {
+                Log.e("PinRepository", "‚ùå Error al obtener imagen referenciada para $ref", e)
+            }
+        }
 
 
     suspend fun deletePin(pinId: String): Boolean {
Index: app/src/main/java/com/nextapp/monasterio/models/ImagenData.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.models\r\n\r\ndata class ImagenData(\r\n    val id: String = \"\",\r\n    val url: String = \"\",\r\n    val etiqueta: String = \"\",\r\n    val titulo: String = \"\",\r\n    val tituloIngles: String = \"\",\r\n    val tituloAleman: String = \"\",\r\n    val type: String = \"\"\r\n)\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/models/ImagenData.kt b/app/src/main/java/com/nextapp/monasterio/models/ImagenData.kt
--- a/app/src/main/java/com/nextapp/monasterio/models/ImagenData.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/models/ImagenData.kt	(date 1764288160937)
@@ -7,5 +7,6 @@
     val titulo: String = "",
     val tituloIngles: String = "",
     val tituloAleman: String = "",
+    val foco: Float =0f,
     val type: String = ""
 )
Index: app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PinDetalleScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.virtualvisit.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport android.util.Log\r\nimport androidx.compose.foundation.*\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.pager.HorizontalPager\r\nimport androidx.compose.foundation.pager.rememberPagerState\r\nimport androidx.compose.foundation.shape.CircleShape\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.draw.clip\r\nimport androidx.compose.ui.geometry.Offset\r\nimport androidx.compose.ui.geometry.Size\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.layout.ContentScale\r\nimport androidx.compose.ui.layout.onGloballyPositioned\r\nimport androidx.compose.ui.layout.positionInRoot\r\nimport androidx.compose.ui.platform.LocalConfiguration\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.platform.LocalView\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.text.font.FontWeight\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.unit.sp\r\nimport androidx.compose.ui.viewinterop.AndroidView\r\nimport androidx.compose.ui.window.Dialog\r\nimport androidx.compose.ui.window.DialogProperties\r\nimport androidx.core.view.WindowCompat\r\nimport androidx.media3.common.MediaItem\r\nimport androidx.media3.common.Player\r\nimport androidx.media3.exoplayer.ExoPlayer\r\nimport coil.compose.AsyncImage\r\nimport coil.load\r\nimport com.github.chrisbanes.photoview.PhotoView\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.models.PinData\r\nimport com.nextapp.monasterio.models.Ubicacion\r\nimport com.nextapp.monasterio.ui.virtualvisit.components.GenericTutorialOverlay\r\nimport com.nextapp.monasterio.viewModels.AjustesViewModel\r\nimport java.util.Locale\r\n\r\n// Clase privada para definir los pasos del tutorial del Pin de forma din√°mica\r\nprivate data class PinTutorialStep(\r\n    val description: String,\r\n    val focusCenter: Offset,\r\n    val focusRadius: Float = 0f,      // Para c√≠rculos\r\n    val rectSize: Size? = null,       // Para cuadrados/rect√°ngulos\r\n    val alignment: Alignment = Alignment.BottomCenter // D√≥nde poner el cuadro de texto\r\n)\r\n\r\n@OptIn(ExperimentalFoundationApi::class)\r\n@Composable\r\nfun PinDetalleScreen(\r\n    viewModel: AjustesViewModel,\r\n    pin: PinData,\r\n    onBack: () -> Unit,\r\n    onVer360: (() -> Unit)? = null\r\n) {\r\n    // --- Configuraci√≥n de Ventana y Orientaci√≥n ---\r\n    val view = LocalView.current\r\n    LaunchedEffect(Unit) {\r\n        val window = (view.context as? Activity)?.window\r\n        window?.let { WindowCompat.setDecorFitsSystemWindows(it, false) }\r\n    }\r\n\r\n    val activity = view.context as? Activity\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT\r\n        onDispose {\r\n            activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n        }\r\n    }\r\n\r\n    // --- L√ìGICA DE ESTADO DEL TUTORIAL ---\r\n    val isPinDismissed by viewModel.isPinDismissed.collectAsState()\r\n    var showTutorialSession by remember { mutableStateOf(true) }\r\n    var currentStepIndex by remember { mutableIntStateOf(0) }\r\n\r\n    // --- VARIABLES PARA CAPTURAR POSICIONES REALES (LAYOUT) ---\r\n    // Estas variables se llenar√°n cuando Android dibuje la pantalla\r\n    var backButtonLayout by remember { mutableStateOf<Pair<Offset, Size>?>(null) }\r\n    var imageLayout by remember { mutableStateOf<Pair<Offset, Size>?>(null) }\r\n    var audioButtonLayout by remember { mutableStateOf<Pair<Offset, Size>?>(null) }\r\n    var button360Layout by remember { mutableStateOf<Pair<Offset, Size>?>(null) }\r\n\r\n    // --- Datos del Pin ---\r\n    val imagenes = if (pin.imagenesDetalladas.isNotEmpty()) pin.imagenesDetalladas else emptyList()\r\n    val pagerState = rememberPagerState(pageCount = { imagenes.size })\r\n    var selectedImageUrl by remember { mutableStateOf<String?>(null) }\r\n    var selectedImageTitle by remember { mutableStateOf<String?>(null) }\r\n\r\n    val configuration = LocalConfiguration.current\r\n    val locale: Locale = configuration.locales[0]\r\n    val language = locale.language\r\n\r\n    // --- Textos Multiling√ºes ---\r\n    val titulo_pin: String\r\n    val descripcion_pin: String?\r\n    val ubicacion_pin: Ubicacion?\r\n\r\n    when (language) {\r\n        \"es\" -> {\r\n            titulo_pin = pin.titulo\r\n            descripcion_pin = pin.descripcion\r\n            ubicacion_pin = pin.ubicacion\r\n        }\r\n        \"de\" -> {\r\n            titulo_pin = pin.tituloAleman\r\n            descripcion_pin = pin.descripcionAleman\r\n            ubicacion_pin = pin.ubicacionAleman\r\n        }\r\n        else -> {\r\n            titulo_pin = pin.tituloIngles\r\n            descripcion_pin = pin.descripcionIngles\r\n            ubicacion_pin = pin.ubicacionIngles\r\n        }\r\n    }\r\n\r\n    // --- L√ìGICA DE AUDIO ---\r\n    val context = LocalContext.current\r\n    val audioUrl = when (language) {\r\n        \"es\" -> pin.audioUrl_es\r\n        \"en\" -> pin.audioUrl_en\r\n        \"de\" -> pin.audioUrl_ge\r\n        else -> pin.audioUrl_es\r\n    }\r\n\r\n    Log.d(\"AudioDebug\", \"Pin: '${pin.titulo}', Idioma: $language, URL Audio: [$audioUrl]\")\r\n\r\n    val exoPlayer = remember { ExoPlayer.Builder(context).build() }\r\n    var isPlaying by remember { mutableStateOf(false) }\r\n    var hasUserInteracted by remember { mutableStateOf(false) }\r\n\r\n    DisposableEffect(audioUrl) {\r\n        if (!audioUrl.isNullOrBlank()) {\r\n            val mediaItem = MediaItem.fromUri(audioUrl)\r\n            exoPlayer.setMediaItem(mediaItem)\r\n            exoPlayer.prepare()\r\n        }\r\n        onDispose { }\r\n    }\r\n\r\n    LaunchedEffect(exoPlayer) {\r\n        exoPlayer.addListener(object : Player.Listener {\r\n            override fun onIsPlayingChanged(isPlayingValue: Boolean) {\r\n                isPlaying = isPlayingValue\r\n            }\r\n            override fun onPlaybackStateChanged(state: Int) {\r\n                if (state == Player.STATE_ENDED) {\r\n                    isPlaying = false\r\n                    exoPlayer.seekTo(0)\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    DisposableEffect(Unit) {\r\n        onDispose { exoPlayer.release() }\r\n    }\r\n\r\n    // --- UI PRINCIPAL ---\r\n    Box(\r\n        modifier = Modifier\r\n            .fillMaxSize()\r\n            .background(Color.White)\r\n            .statusBarsPadding()\r\n    ) {\r\n        Column(\r\n            modifier = Modifier\r\n                .fillMaxSize()\r\n                .padding(horizontal = 16.dp)\r\n                .padding(bottom = 40.dp),\r\n            horizontalAlignment = Alignment.CenterHorizontally\r\n        ) {\r\n            // 1. BOT√ìN ATR√ÅS\r\n            Box(\r\n                modifier = Modifier\r\n                    .fillMaxWidth()\r\n                    .padding(top = 16.dp)\r\n                    // \uD83D\uDC47 CAPTURAMOS POSICI√ìN REAL\r\n                    .onGloballyPositioned { coordinates ->\r\n                        val position = coordinates.positionInRoot()\r\n                        val size = coordinates.size\r\n                        backButtonLayout = position to Size(size.width.toFloat(), size.height.toFloat())\r\n                    },\r\n                contentAlignment = Alignment.CenterStart\r\n            ) {\r\n                Image(\r\n                    painter = painterResource(id = R.drawable.arrow_back),\r\n                    contentDescription = stringResource(R.string.go_back),\r\n                    modifier = Modifier\r\n                        .size(28.dp)\r\n                        .clickable { onBack() }\r\n                )\r\n            }\r\n\r\n            Spacer(modifier = Modifier.height(8.dp))\r\n\r\n            // T√≠tulo\r\n            Text(\r\n                text = buildString {\r\n                    append(titulo_pin)\r\n                    ubicacion_pin?.let { append(\" (${it.displayName})\") }\r\n                },\r\n                fontSize = 26.sp,\r\n                fontWeight = FontWeight.Bold,\r\n                color = Color.Black,\r\n                textAlign = TextAlign.Center,\r\n                modifier = Modifier.fillMaxWidth()\r\n            )\r\n\r\n            Spacer(modifier = Modifier.height(16.dp))\r\n\r\n            // 2. CARRUSEL DE IM√ÅGENES\r\n            if (imagenes.isNotEmpty()) {\r\n                Box(\r\n                    modifier = Modifier\r\n                        .fillMaxWidth()\r\n                        .height(250.dp)\r\n                        .clip(RoundedCornerShape(16.dp))\r\n                        .border(3.dp, Color.Black, RoundedCornerShape(16.dp))\r\n                        // \uD83D\uDC47 CAPTURAMOS POSICI√ìN REAL\r\n                        .onGloballyPositioned { coordinates ->\r\n                            val position = coordinates.positionInRoot()\r\n                            val size = coordinates.size\r\n                            imageLayout = position to Size(size.width.toFloat(), size.height.toFloat())\r\n                        }\r\n                ) {\r\n                    HorizontalPager(state = pagerState) { page ->\r\n                        val imagen = imagenes[page]\r\n                        Box(modifier = Modifier.fillMaxSize()) {\r\n                            AsyncImage(\r\n                                model = imagen.url,\r\n                                contentDescription = imagen.etiqueta,\r\n                                contentScale = ContentScale.Crop,\r\n                                modifier = Modifier\r\n                                    .fillMaxSize()\r\n                                    .clickable {\r\n                                        selectedImageUrl = imagen.url\r\n                                        selectedImageTitle = when (language) {\r\n                                            \"es\" -> imagen.titulo\r\n                                            \"de\" -> imagen.tituloAleman\r\n                                            else -> imagen.tituloIngles\r\n                                        }\r\n                                    }\r\n                            )\r\n                            Text(\r\n                                text = imagen.etiqueta,\r\n                                color = Color.White,\r\n                                fontSize = 14.sp,\r\n                                modifier = Modifier\r\n                                    .align(Alignment.BottomStart)\r\n                                    .background(Color.Black.copy(alpha = 0.6f))\r\n                                    .padding(horizontal = 10.dp, vertical = 6.dp)\r\n                            )\r\n                        }\r\n                    }\r\n                    Row(\r\n                        Modifier\r\n                            .align(Alignment.BottomCenter)\r\n                            .padding(bottom = 6.dp)\r\n                    ) {\r\n                        repeat(imagenes.size) { index ->\r\n                            val selected = pagerState.currentPage == index\r\n                            Box(\r\n                                Modifier\r\n                                    .padding(3.dp)\r\n                                    .size(if (selected) 8.dp else 6.dp)\r\n                                    .background(\r\n                                        Color.White.copy(alpha = if (selected) 1f else 0.6f),\r\n                                        CircleShape\r\n                                    )\r\n                            )\r\n                        }\r\n                    }\r\n                }\r\n                Spacer(modifier = Modifier.height(12.dp))\r\n            }\r\n\r\n            // 3. BOT√ìN DE AUDIO\r\n            Row(\r\n                modifier = Modifier.fillMaxWidth(),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                if (!audioUrl.isNullOrBlank()) {\r\n                    val iconRes = when {\r\n                        isPlaying -> R.drawable.pause\r\n                        !hasUserInteracted -> R.drawable.microphone\r\n                        else -> R.drawable.play_arrow\r\n                    }\r\n                    Row(\r\n                        modifier = Modifier\r\n                            .fillMaxWidth()\r\n                            .padding(top = 8.dp),\r\n                        horizontalArrangement = Arrangement.Start\r\n                    ) {\r\n                        IconButton(\r\n                            onClick = {\r\n                                hasUserInteracted = true\r\n                                if (isPlaying) exoPlayer.pause() else exoPlayer.play()\r\n                            },\r\n                            modifier = Modifier\r\n                                // \uD83D\uDC47 CAPTURAMOS POSICI√ìN REAL\r\n                                .onGloballyPositioned { coordinates ->\r\n                                    val position = coordinates.positionInRoot()\r\n                                    val size = coordinates.size\r\n                                    audioButtonLayout = position to Size(size.width.toFloat(), size.height.toFloat())\r\n                                }\r\n                        ) {\r\n                            Box(\r\n                                modifier = Modifier\r\n                                    .size(48.dp)\r\n                                    .clip(CircleShape)\r\n                                    .background(Color.Gray.copy(alpha = 0.3f)),\r\n                                contentAlignment = Alignment.Center\r\n                            ) {\r\n                                Icon(\r\n                                    painter = painterResource(id = iconRes),\r\n                                    contentDescription = stringResource(R.string.play_audio),\r\n                                    tint = Color.Black,\r\n                                    modifier = Modifier.size(28.dp)\r\n                                )\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Descripci√≥n Deslizable\r\n            val descripcion = descripcion_pin ?: \"\"\r\n            if (descripcion.isNotBlank()) {\r\n                val textScrollState = rememberScrollState()\r\n                Box(\r\n                    modifier = Modifier\r\n                        .fillMaxWidth()\r\n                        .weight(1f)\r\n                        .border(1.dp, Color.LightGray.copy(alpha = 0.5f), RoundedCornerShape(8.dp))\r\n                        .clip(RoundedCornerShape(8.dp))\r\n                ) {\r\n                    Text(\r\n                        text = descripcion,\r\n                        fontSize = 16.sp,\r\n                        color = Color.DarkGray,\r\n                        lineHeight = 22.sp,\r\n                        modifier = Modifier\r\n                            .fillMaxSize()\r\n                            .padding(horizontal = 12.dp, vertical = 8.dp)\r\n                            .verticalScroll(textScrollState)\r\n                    )\r\n                }\r\n            }\r\n\r\n            Spacer(modifier = Modifier.height(24.dp))\r\n\r\n            // 4. BOT√ìN 360\r\n            onVer360?.let {\r\n                Box(\r\n                    modifier = Modifier\r\n                        .background(Color.White)\r\n                        .navigationBarsPadding()\r\n                        .padding(horizontal = 16.dp, vertical = 2.dp)\r\n                        .onGloballyPositioned { coordinates ->\r\n                            val position = coordinates.positionInRoot()\r\n                            val size = coordinates.size\r\n                            button360Layout = position to Size(size.width.toFloat(), size.height.toFloat())\r\n                        }\r\n                ) {\r\n                    Button(\r\n                        onClick = it,\r\n                        modifier = Modifier\r\n                            .fillMaxWidth()\r\n                            .height(56.dp),\r\n                        colors = ButtonDefaults.buttonColors(containerColor = Color.Black),\r\n                        shape = RoundedCornerShape(12.dp)\r\n                    ) {\r\n                        Text(\r\n                            text = stringResource(R.string.see_360),\r\n                            color = Color.White,\r\n                            fontSize = 18.sp,\r\n                            fontWeight = FontWeight.Bold,\r\n                        )\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // ====================================================================\r\n        // LOGICA VISUAL DEL TUTORIAL (CON COORDENADAS REALES)\r\n        // ====================================================================\r\n\r\n        // Verificar que tenemos al menos las coordenadas b√°sicas (Bot√≥n atr√°s es lo m√≠nimo)\r\n        val isLayoutReady = backButtonLayout != null\r\n\r\n        if (!isPinDismissed && showTutorialSession && isLayoutReady) {\r\n\r\n            // Construimos la lista de pasos usando las coordenadas CAPTURADAS\r\n            val steps = remember(backButtonLayout, imageLayout, audioButtonLayout, button360Layout, audioUrl, onVer360) {\r\n                val list = mutableListOf<PinTutorialStep>()\r\n\r\n                // PASO 1: Volver (Usamos las coordenadas reales del bot√≥n atr√°s)\r\n                backButtonLayout?.let { (pos, size) ->\r\n                    list.add(\r\n                        PinTutorialStep(\r\n                            description = activity?.getString(R.string.pin_1) ?: \"Volver\",\r\n                            // Calculamos el centro geom√©trico\r\n                            focusCenter = Offset(pos.x + size.width / 20, pos.y + size.height / 2),\r\n                            // Radio un poco m√°s grande que el bot√≥n\r\n                            focusRadius = (size.width / 15),\r\n                            alignment = Alignment.BottomCenter\r\n                        )\r\n                    )\r\n                }\r\n\r\n                // PASO 2: Im√°genes (Usamos coordenadas reales del carrusel)\r\n                imageLayout?.let { (pos, size) ->\r\n                    list.add(\r\n                        PinTutorialStep(\r\n                            description = activity?.getString(R.string.pin_2) ?: \"Im√°genes\",\r\n                            focusCenter = Offset(pos.x + size.width / 2, pos.y + size.height / 2),\r\n                            rectSize = size, // Usamos el tama√±o exacto\r\n                            alignment = Alignment.BottomCenter\r\n                        )\r\n                    )\r\n                }\r\n\r\n                // PASO 3: Audio (Solo si existe y se ha medido)\r\n                if (!audioUrl.isNullOrBlank() && audioButtonLayout != null) {\r\n                    audioButtonLayout?.let { (pos, size) ->\r\n                        list.add(\r\n                            PinTutorialStep(\r\n                                description = activity?.getString(R.string.pin_3) ?: \"Audio\",\r\n                                focusCenter = Offset(pos.x + size.width / 2, pos.y + size.height / 2),\r\n                                focusRadius = (size.width / 2) + 20f,\r\n                                alignment = Alignment.TopCenter\r\n                            )\r\n                        )\r\n                    }\r\n                }\r\n\r\n                // PASO 4: Bot√≥n 360 (Solo si existe y se ha medido)\r\n                if (onVer360 != null && button360Layout != null) {\r\n                    button360Layout?.let { (pos, size) ->\r\n                        list.add(\r\n                            PinTutorialStep(\r\n                                description = activity?.getString(R.string.pin_4) ?: \"360\",\r\n                                focusCenter = Offset(pos.x + size.width / 2, pos.y + size.height / 2),\r\n                                rectSize = size,\r\n                                alignment = Alignment.TopCenter // Dialogo ARRIBA\r\n                            )\r\n                        )\r\n                    }\r\n                }\r\n                list\r\n            }\r\n\r\n            if (steps.isNotEmpty() && currentStepIndex < steps.size) {\r\n                val step = steps[currentStepIndex]\r\n                val isLastStep = currentStepIndex == steps.size - 1\r\n                val btnText = if (isLastStep) stringResource(R.string.understand) else stringResource(R.string.next)\r\n\r\n                GenericTutorialOverlay(\r\n                    description = step.description,\r\n                    highlightCenter = step.focusCenter,\r\n                    highlightRadius = step.focusRadius,\r\n                    highlightRectSize = step.rectSize,\r\n                    buttonText = btnText,\r\n                    dialogAlignment = step.alignment,\r\n\r\n                    onCloseClicked = { permanent ->\r\n                        if (isLastStep) {\r\n                            showTutorialSession = false\r\n                            if (permanent) viewModel.dismissPin()\r\n                        } else {\r\n                            currentStepIndex++\r\n                            if (permanent) viewModel.dismissPin()\r\n                        }\r\n                    }\r\n                )\r\n            }\r\n        }\r\n\r\n        // \uD83D\uDD0D Zoom Dialog\r\n        if (selectedImageUrl != null) {\r\n            ZoomableImageDialog(\r\n                imageUrl = selectedImageUrl!!,\r\n                label = selectedImageTitle ?: \"\",\r\n                onDismiss = {\r\n                    selectedImageUrl = null\r\n                    selectedImageTitle = null\r\n                }\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\n@Composable\r\nprivate fun ZoomableImageDialog(imageUrl: String, label: String, onDismiss: () -> Unit) {\r\n    val view = LocalView.current\r\n    val activity = view.context as? Activity\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_SENSOR\r\n        onDispose {\r\n            activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT\r\n        }\r\n    }\r\n\r\n    Dialog(\r\n        onDismissRequest = onDismiss,\r\n        properties = DialogProperties(usePlatformDefaultWidth = false, dismissOnClickOutside = true)\r\n    ) {\r\n        Box(\r\n            modifier = Modifier.fillMaxSize().background(Color.Black.copy(alpha = 0.95f))\r\n        ) {\r\n            AndroidView(\r\n                factory = { context ->\r\n                    PhotoView(context).apply {\r\n                        load(imageUrl) { crossfade(true) }\r\n                    }\r\n                },\r\n                modifier = Modifier.fillMaxSize()\r\n            )\r\n\r\n            Text(\r\n                text = label,\r\n                color = Color.White,\r\n                fontSize = 16.sp,\r\n                fontWeight = FontWeight.Medium,\r\n                modifier = Modifier\r\n                    .align(Alignment.BottomStart)\r\n                    .background(Color.Black.copy(alpha = 0.7f))\r\n                    .padding(horizontal = 12.dp, vertical = 8.dp)\r\n            )\r\n\r\n            IconButton(\r\n                onClick = onDismiss,\r\n                modifier = Modifier\r\n                    .align(Alignment.TopEnd)\r\n                    .statusBarsPadding()\r\n                    .padding(16.dp)\r\n                    .background(Color.Black.copy(alpha = 0.5f), CircleShape)\r\n            ) {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.arrow_back),\r\n                    contentDescription = stringResource(R.string.close),\r\n                    tint = Color.White\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PinDetalleScreen.kt b/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PinDetalleScreen.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PinDetalleScreen.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PinDetalleScreen.kt	(date 1764288142363)
@@ -12,6 +12,7 @@
 import androidx.compose.material3.*
 import androidx.compose.runtime.*
 import androidx.compose.ui.Alignment
+import androidx.compose.ui.BiasAlignment
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.draw.clip
 import androidx.compose.ui.geometry.Offset
@@ -237,10 +238,17 @@
                     HorizontalPager(state = pagerState) { page ->
                         val imagen = imagenes[page]
                         Box(modifier = Modifier.fillMaxSize()) {
+
+                            val alignment = remember{
+                                BiasAlignment(horizontalBias = 0f, verticalBias = imagen.foco)
+                            }
+
+
                             AsyncImage(
                                 model = imagen.url,
                                 contentDescription = imagen.etiqueta,
                                 contentScale = ContentScale.Crop,
+                                alignment = alignment,
                                 modifier = Modifier
                                     .fillMaxSize()
                                     .clickable {
Index: app/src/main/java/com/nextapp/monasterio/MainActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio\r\n\r\nimport android.R.attr.text\r\nimport android.app.Activity\r\nimport android.os.Bundle\r\nimport android.widget.Toast\r\nimport androidx.activity.compose.setContent\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport androidx.appcompat.app.AppCompatDelegate\r\nimport androidx.compose.foundation.Image\r\nimport androidx.compose.foundation.border\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.navigation.compose.rememberNavController\r\nimport com.nextapp.monasterio.ui.navigation.AppDrawerContent\r\nimport com.nextapp.monasterio.ui.navigation.AppNavigationHost\r\nimport com.nextapp.monasterio.ui.theme.*\r\nimport kotlinx.coroutines.launch\r\nimport androidx.compose.ui.draw.clip\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.layout.ContentScale\r\nimport androidx.compose.ui.platform.LocalConfiguration\r\nimport androidx.compose.ui.platform.LocalDensity\r\nimport androidx.compose.ui.unit.Density\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.lifecycle.viewmodel.compose.viewModel\r\nimport androidx.navigation.compose.currentBackStackEntryAsState\r\nimport com.nextapp.monasterio.utils.FontSize\r\nimport com.nextapp.monasterio.viewModels.AuthViewModel\r\n\r\n\r\nclass MainActivity : AppCompatActivity() {\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO)\r\n        super.onCreate(savedInstanceState)\r\n        LanguageHelper.loadLocale(this)\r\n\r\n        setContent {\r\n            // 1. Leemos el tama√±o guardado\r\n            val appFontScale = FontSize.devolverFontScale(this)\r\n            val currentDensity = LocalDensity.current\r\n            val currentConfig = LocalConfiguration.current\r\n\r\n            // 2. Calculamos la nueva Densidad\r\n            val newDensity = Density(\r\n                density = currentDensity.density,\r\n                fontScale = appFontScale\r\n            )\r\n\r\n            // 3. Actualizamos la Configuraci√≥n\r\n            val newConfiguration = android.content.res.Configuration(currentConfig).apply {\r\n                fontScale = appFontScale\r\n            }\r\n\r\n            // 4. Inyectamos AMBOS valores\r\n            CompositionLocalProvider(\r\n                LocalDensity provides newDensity,\r\n                LocalConfiguration provides newConfiguration\r\n            ) {\r\n                Smov_monasterioTheme {\r\n                    // \uD83D\uDC47 PASAMOS 'this' (la actividad)\r\n                    MonasteryAppScreen(activity = this@MainActivity)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun MonasteryAppScreen(activity: AppCompatActivity) { // \uD83D\uDC48 Recibimos la actividad\r\n    val context = LocalContext.current\r\n    val navController = rememberNavController()\r\n    val drawerState = rememberDrawerState(initialValue = DrawerValue.Closed)\r\n    val scope = rememberCoroutineScope()\r\n\r\n    // ViewModel Auth\r\n    val authViewModel: AuthViewModel = viewModel()\r\n    val currentUser by authViewModel.currentUser.collectAsState(initial = null)\r\n\r\n    // Estado global edici√≥n\r\n    var isEditing by remember { mutableStateOf(false) }\r\n\r\n    val currentTitle = remember { mutableStateOf(context.getString(R.string.title_inicio)) }\r\n\r\n    // Detectar ruta actual\r\n    val currentBackStackEntry by navController.currentBackStackEntryAsState()\r\n    val currentRoute = currentBackStackEntry?.destination?.route\r\n\r\n    val isPanorama = currentRoute?.startsWith(AppRoutes.PANORAMA) == true\r\n    val isVirtualVisit = currentRoute == AppRoutes.VIRTUAL_VISIT\r\n    val isPin360 = currentRoute?.startsWith(AppRoutes.PIN_360) == true\r\n    val isEdicion = currentRoute == AppRoutes.EDICION_PINES\r\n    val isEdicionFondo = currentRoute == AppRoutes.EDICION_FONDO_INICIO\r\n\r\n    val isImmersive = isPanorama || isVirtualVisit || isPin360 || isEdicion || isEdicionFondo\r\n\r\n    val gesturesEnabled = when(currentRoute){\r\n        AppRoutes.VIRTUAL_VISIT -> false\r\n        else -> true\r\n    }\r\n    LaunchedEffect(navController) {\r\n        navController.currentBackStackEntryFlow.collect { backStackEntry ->\r\n            val route = backStackEntry.destination.route\r\n            val routeBase = route?.split(\"/\")?.firstOrNull() ?: route\r\n\r\n            currentTitle.value = when (routeBase) { // <-- Usamos routeBase\r\n                AppRoutes.INFO -> context.getString(R.string.title_info_general)\r\n                AppRoutes.HISTORIA -> context.getString(R.string.title_history)\r\n                AppRoutes.GALERIA -> context.getString(R.string.title_gallery)\r\n                AppRoutes.PERFIL -> context.getString(R.string.title_profile)\r\n                AppRoutes.AJUSTES -> context.getString(R.string.title_settings)\r\n                AppRoutes.OPCIONES_RESERVA,\r\n                AppRoutes.RESERVA,\r\n                AppRoutes.CONFIRMACION_RESERVA -> context.getString(R.string.title_appointment)\r\n                AppRoutes.VIRTUAL_VISIT -> context.getString(R.string.title_monasterio)\r\n                AppRoutes.MODO_NINYOS -> context.getString(R.string.child_mode_view)\r\n                AppRoutes.VIDEO_NINYOS -> context.getString(R.string.video_view)\r\n                AppRoutes.JUEGO_NINYOS -> context.getString(R.string.game_view)\r\n                AppRoutes.MODO_EDICION -> context.getString(R.string.edit_mode)\r\n                AppRoutes.PIN_ENTRADA_MONASTERIO -> context.getString(R.string.title_entrada)\r\n                AppRoutes.JUEGO_PUZZLE -> context.getString(R.string.puzzle_screen)\r\n                AppRoutes.JUEGO_PAREJAS -> context.getString(R.string.memory_screen)\r\n                AppRoutes.PUZZLENIVEL1 -> context.getString(R.string.puzzle_screen)\r\n                AppRoutes.PUZZLENIVEL2 -> context.getString(R.string.puzzle_screen)\r\n                AppRoutes.PUZZLENIVEL3 -> context.getString(R.string.puzzle_screen)\r\n                AppRoutes.PUZZLENIVEL4 -> context.getString(R.string.puzzle_screen)\r\n                AppRoutes.PAREJASNIVEL1 -> context.getString(R.string.memory_screen)\r\n                AppRoutes.PAREJASNIVEL2 -> context.getString(R.string.memory_screen)\r\n                AppRoutes.PAREJASNIVEL3 -> context.getString(R.string.memory_screen)\r\n                AppRoutes.PAREJASNIVEL4 -> context.getString(R.string.memory_screen)\r\n                else -> context.getString(R.string.title_inicio)\r\n            }\r\n        }\r\n    }\r\n\r\n    ModalNavigationDrawer(\r\n        drawerState = drawerState,\r\n        drawerContent = {\r\n            AppDrawerContent(\r\n                navController = navController,\r\n                scope = scope,\r\n                drawerState = drawerState\r\n            )\r\n        },\r\n        gesturesEnabled = gesturesEnabled && !isImmersive\r\n    ) {\r\n        Scaffold(\r\n            topBar = {\r\n                if (!isImmersive) {\r\n                    CenterAlignedTopAppBar(\r\n                        title = { Text(currentTitle.value) },\r\n                        colors = TopAppBarDefaults.topAppBarColors(\r\n                            containerColor = MonasteryRed,\r\n                            titleContentColor = White,\r\n                            navigationIconContentColor = White,\r\n                            actionIconContentColor = White\r\n                        ),\r\n                        navigationIcon = {\r\n                            IconButton(onClick = {\r\n                                scope.launch {\r\n                                    if (drawerState.isClosed) drawerState.open() else drawerState.close()\r\n                                }\r\n                            }) {\r\n                                val iconRes = if (drawerState.isOpen) R.drawable.menu_close else R.drawable.ic_menu_24\r\n                                Icon(\r\n                                    painter = painterResource(id = iconRes),\r\n                                    contentDescription = stringResource(id = R.string.navigation_drawer_open)\r\n                                )\r\n                            }\r\n                        },\r\n                        actions = {\r\n                            // \uD83D\uDC47 1. SELECTOR DE IDIOMA LIMPIO\r\n                            MainLanguageSelector(activity)\r\n\r\n                            // Icono Editar\r\n                            if (currentUser != null) {\r\n                                IconButton(onClick = {\r\n                                    isEditing = !isEditing\r\n                                    val message = if (isEditing) context.getString(R.string.edit_mode_activate_message) else context.getString(R.string.edit_mode_deactivate_message)\r\n                                    Toast.makeText(context, message, Toast.LENGTH_SHORT).show()\r\n                                }) {\r\n                                    Icon(\r\n                                        painter = painterResource(id = R.drawable.lapiz),\r\n                                        contentDescription = if (isEditing) stringResource(id = R.string.edit_mode_deactivate_icon) else stringResource(id = R.string.edit_mode_activate_icon),\r\n                                        tint = White\r\n                                    )\r\n                                }\r\n                            }\r\n                        }\r\n                    )\r\n                }\r\n            }\r\n        ) { paddingValues ->\r\n            AppNavigationHost(\r\n                authViewModel = authViewModel,\r\n                navController = navController,\r\n                isEditing = isEditing,\r\n                modifier = Modifier.padding(paddingValues)\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\n// --- COMPONENTES DE IDIOMA PARA LA BARRA ---\r\n\r\n@Composable\r\nfun MainLanguageSelector(activity: AppCompatActivity) {\r\n    var expanded by remember { mutableStateOf(false) }\r\n\r\n    // Obtenemos idioma actual\r\n    val currentLanguageCode = activity.resources.configuration.locales[0].language\r\n\r\n    // Determinamos bandera actual\r\n    val currentFlag = when (currentLanguageCode) {\r\n        \"de\" -> R.drawable.alemania\r\n        \"en\" -> R.drawable.reinounido\r\n        else -> R.drawable.espanya\r\n    }\r\n\r\n    Box {\r\n        // Bot√≥n de la bandera\r\n        IconButton(onClick = { expanded = true }) {\r\n            Image(\r\n                painter = painterResource(id = currentFlag),\r\n                contentDescription = \"Cambiar idioma\",\r\n                contentScale = ContentScale.Crop,\r\n                modifier = Modifier\r\n                    .size(28.dp)\r\n                    .clip(RoundedCornerShape(4.dp))\r\n                    .border(1.dp, Color.White.copy(alpha = 0.5f), RoundedCornerShape(4.dp))\r\n            )\r\n        }\r\n\r\n        // Men√∫ desplegable\r\n        DropdownMenu(\r\n            expanded = expanded,\r\n            onDismissRequest = { expanded = false },\r\n            modifier = Modifier.width(150.dp)\r\n        ) {\r\n            MainLanguageItem(activity, \"es\", stringResource(R.string.lang_es), R.drawable.espanya) { expanded = false }\r\n            MainLanguageItem(activity, \"en\", stringResource(R.string.lang_en), R.drawable.reinounido) { expanded = false }\r\n            MainLanguageItem(activity, \"de\", stringResource(R.string.lang_de), R.drawable.alemania) { expanded = false }\r\n        }\r\n    }\r\n}\r\n\r\n@Composable\r\nfun MainLanguageItem(\r\n    activity: AppCompatActivity,\r\n    code: String,\r\n    name: String,\r\n    flagRes: Int,\r\n    onDismiss: () -> Unit\r\n) {\r\n    DropdownMenuItem(\r\n        text = {\r\n            Row(verticalAlignment = Alignment.CenterVertically) {\r\n                Image(\r\n                    painter = painterResource(id = flagRes),\r\n                    contentDescription = null,\r\n                    modifier = Modifier.size(24.dp).clip(RoundedCornerShape(2.dp))\r\n                )\r\n                Spacer(modifier = Modifier.width(12.dp))\r\n                Text(text = name, style = MaterialTheme.typography.bodyMedium)\r\n            }\r\n        },\r\n        onClick = {\r\n            onDismiss()\r\n            val currentLanguage = activity.resources.configuration.locales[0].language\r\n            if (currentLanguage != code) {\r\n                LanguageHelper.saveLocale(activity, code)\r\n                activity.recreate()\r\n            }\r\n        }\r\n    )\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/MainActivity.kt b/app/src/main/java/com/nextapp/monasterio/MainActivity.kt
--- a/app/src/main/java/com/nextapp/monasterio/MainActivity.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/MainActivity.kt	(date 1764287747512)
@@ -7,6 +7,9 @@
 import androidx.activity.compose.setContent
 import androidx.appcompat.app.AppCompatActivity
 import androidx.appcompat.app.AppCompatDelegate
+import androidx.compose.animation.AnimatedVisibility
+import androidx.compose.animation.fadeIn
+import androidx.compose.animation.fadeOut
 import androidx.compose.foundation.Image
 import androidx.compose.foundation.border
 import androidx.compose.foundation.layout.*
@@ -34,6 +37,7 @@
 import androidx.navigation.compose.currentBackStackEntryAsState
 import com.nextapp.monasterio.utils.FontSize
 import com.nextapp.monasterio.viewModels.AuthViewModel
+import com.nextapp.monasterio.ui.screens.pinEdition.components.AppStatus
 
 
 class MainActivity : AppCompatActivity() {
@@ -136,6 +140,8 @@
                 AppRoutes.PAREJASNIVEL2 -> context.getString(R.string.memory_screen)
                 AppRoutes.PAREJASNIVEL3 -> context.getString(R.string.memory_screen)
                 AppRoutes.PAREJASNIVEL4 -> context.getString(R.string.memory_screen)
+                AppRoutes.EDICION_FONDO_INICIO -> context.getString(R.string.background_edit_screen)
+                AppRoutes.EDICION_PINES -> context.getString(R.string.pin_edit_screen)
                 else -> context.getString(R.string.title_inicio)
             }
         }
@@ -154,48 +160,73 @@
     ) {
         Scaffold(
             topBar = {
-                if (!isImmersive) {
-                    CenterAlignedTopAppBar(
-                        title = { Text(currentTitle.value) },
-                        colors = TopAppBarDefaults.topAppBarColors(
-                            containerColor = MonasteryRed,
-                            titleContentColor = White,
-                            navigationIconContentColor = White,
-                            actionIconContentColor = White
-                        ),
-                        navigationIcon = {
-                            IconButton(onClick = {
-                                scope.launch {
-                                    if (drawerState.isClosed) drawerState.open() else drawerState.close()
-                                }
-                            }) {
-                                val iconRes = if (drawerState.isOpen) R.drawable.menu_close else R.drawable.ic_menu_24
-                                Icon(
-                                    painter = painterResource(id = iconRes),
-                                    contentDescription = stringResource(id = R.string.navigation_drawer_open)
-                                )
-                            }
-                        },
-                        actions = {
-                            // üëá 1. SELECTOR DE IDIOMA LIMPIO
-                            MainLanguageSelector(activity)
+                Column {
+                        CenterAlignedTopAppBar(
+                            title = { Text(currentTitle.value) },
+                            colors = TopAppBarDefaults.topAppBarColors(
+                                containerColor = MonasteryRed,
+                                titleContentColor = White,
+                                navigationIconContentColor = White,
+                                actionIconContentColor = White
+                            ),
+                            navigationIcon = {
+                                if (!isImmersive) {
+                                    IconButton(onClick = {
+                                        scope.launch {
+                                            if (drawerState.isClosed) drawerState.open() else drawerState.close()
+                                        }
+                                    }) {
+                                        val iconRes =
+                                            if (drawerState.isOpen) R.drawable.menu_close else R.drawable.ic_menu_24
+                                        Icon(
+                                            painter = painterResource(id = iconRes),
+                                            contentDescription = stringResource(id = R.string.navigation_drawer_open)
+                                        )
+                                    }
+                                }
+                            },
+                            actions = {
+                                if (!isImmersive) {
+                                    // üëá 1. SELECTOR DE IDIOMA LIMPIO
+                                    MainLanguageSelector(activity)
 
-                            // Icono Editar
-                            if (currentUser != null) {
-                                IconButton(onClick = {
-                                    isEditing = !isEditing
-                                    val message = if (isEditing) context.getString(R.string.edit_mode_activate_message) else context.getString(R.string.edit_mode_deactivate_message)
-                                    Toast.makeText(context, message, Toast.LENGTH_SHORT).show()
-                                }) {
-                                    Icon(
-                                        painter = painterResource(id = R.drawable.lapiz),
-                                        contentDescription = if (isEditing) stringResource(id = R.string.edit_mode_deactivate_icon) else stringResource(id = R.string.edit_mode_activate_icon),
-                                        tint = White
-                                    )
-                                }
-                            }
-                        }
-                    )
+                                    // Icono Editar
+                                    if (currentUser != null) {
+                                        IconButton(onClick = {
+                                            isEditing = !isEditing
+                                            val message =
+                                                if (isEditing) context.getString(R.string.edit_mode_activate_message) else context.getString(
+                                                    R.string.edit_mode_deactivate_message
+                                                )
+                                            Toast.makeText(context, message, Toast.LENGTH_SHORT)
+                                                .show()
+                                        }) {
+                                            Icon(
+                                                painter = painterResource(id = R.drawable.lapiz),
+                                                contentDescription = if (isEditing) stringResource(
+                                                    id = R.string.edit_mode_deactivate_icon
+                                                ) else stringResource(
+                                                    id = R.string.edit_mode_activate_icon
+                                                ),
+                                                tint = White
+                                            )
+                                        }
+                                    }
+                                }
+                            }
+                        )
+                    val isGlobalLoading by AppStatus.isUploading.collectAsState()
+                    AnimatedVisibility(
+                        visible = isGlobalLoading,
+                        enter = fadeIn(),
+                        exit = fadeOut()
+                    ) {
+                        // Se dibuja JUSTO debajo de la TopAppBar
+                        LinearProgressIndicator(
+                            modifier = Modifier.fillMaxWidth(),
+                            color = MonasteryBlue
+                        )
+                    }
                 }
             }
         ) { paddingValues ->
@@ -222,7 +253,9 @@
     val currentFlag = when (currentLanguageCode) {
         "de" -> R.drawable.alemania
         "en" -> R.drawable.reinounido
+        "fr" -> R.drawable.francia
         else -> R.drawable.espanya
+
     }
 
     Box {
@@ -248,6 +281,7 @@
             MainLanguageItem(activity, "es", stringResource(R.string.lang_es), R.drawable.espanya) { expanded = false }
             MainLanguageItem(activity, "en", stringResource(R.string.lang_en), R.drawable.reinounido) { expanded = false }
             MainLanguageItem(activity, "de", stringResource(R.string.lang_de), R.drawable.alemania) { expanded = false }
+            MainLanguageItem(activity, "fr", stringResource(R.string.lang_fr), R.drawable.francia) { expanded = false }
         }
     }
 }
Index: .idea/deploymentTargetSelector.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"deploymentTargetSelector\">\r\n    <selectionStates>\r\n      <SelectionState runConfigName=\"app\">\r\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\r\n        <DropdownSelection timestamp=\"2025-11-27T11:19:10.519801900Z\">\r\n          <Target type=\"DEFAULT_BOOT\">\r\n            <handle>\r\n              <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=R52T40GVQQB\" />\r\n            </handle>\r\n          </Target>\r\n        </DropdownSelection>\r\n        <DialogSelection>\r\n          <targets>\r\n            <Target type=\"DEFAULT_BOOT\">\r\n              <handle>\r\n                <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=RZCX7216PCM\" />\r\n              </handle>\r\n            </Target>\r\n            <Target type=\"DEFAULT_BOOT\">\r\n              <handle>\r\n                <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=R52T40GVQQB\" />\r\n              </handle>\r\n            </Target>\r\n          </targets>\r\n        </DialogSelection>\r\n      </SelectionState>\r\n    </selectionStates>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/deploymentTargetSelector.xml b/.idea/deploymentTargetSelector.xml
--- a/.idea/deploymentTargetSelector.xml	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/.idea/deploymentTargetSelector.xml	(date 1764284128995)
@@ -4,27 +4,6 @@
     <selectionStates>
       <SelectionState runConfigName="app">
         <option name="selectionMode" value="DROPDOWN" />
-        <DropdownSelection timestamp="2025-11-27T11:19:10.519801900Z">
-          <Target type="DEFAULT_BOOT">
-            <handle>
-              <DeviceId pluginId="PhysicalDevice" identifier="serial=R52T40GVQQB" />
-            </handle>
-          </Target>
-        </DropdownSelection>
-        <DialogSelection>
-          <targets>
-            <Target type="DEFAULT_BOOT">
-              <handle>
-                <DeviceId pluginId="PhysicalDevice" identifier="serial=RZCX7216PCM" />
-              </handle>
-            </Target>
-            <Target type="DEFAULT_BOOT">
-              <handle>
-                <DeviceId pluginId="PhysicalDevice" identifier="serial=R52T40GVQQB" />
-              </handle>
-            </Target>
-          </targets>
-        </DialogSelection>
       </SelectionState>
     </selectionStates>
   </component>
Index: app/src/main/java/com/nextapp/monasterio/ui/screens/ParejasScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport androidx.compose.animation.Crossfade\r\nimport androidx.compose.animation.core.tween\r\nimport androidx.compose.foundation.Image\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.clickable\r\nimport androidx.compose.foundation.layout.Arrangement\r\nimport androidx.compose.foundation.layout.Box\r\nimport androidx.compose.foundation.layout.Column\r\nimport androidx.compose.foundation.layout.aspectRatio\r\nimport androidx.compose.foundation.layout.fillMaxHeight\r\nimport androidx.compose.foundation.layout.fillMaxSize\r\nimport androidx.compose.foundation.layout.fillMaxWidth\r\nimport androidx.compose.foundation.layout.padding\r\nimport androidx.compose.foundation.layout.width\r\nimport androidx.compose.foundation.layout.wrapContentHeight\r\nimport androidx.compose.foundation.layout.wrapContentWidth\r\nimport androidx.compose.foundation.lazy.grid.GridCells\r\nimport androidx.compose.foundation.lazy.grid.LazyVerticalGrid\r\nimport androidx.compose.foundation.lazy.grid.items\r\nimport androidx.compose.material3.AlertDialog\r\nimport androidx.compose.material3.Button\r\nimport androidx.compose.material3.Card\r\nimport androidx.compose.material3.CardDefaults\r\nimport androidx.compose.material3.MaterialTheme\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.DisposableEffect\r\nimport androidx.compose.runtime.collectAsState\r\nimport androidx.compose.runtime.getValue\r\nimport androidx.compose.runtime.remember\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.layout.ContentScale\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.lifecycle.viewmodel.compose.viewModel\r\nimport androidx.navigation.NavController\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.models.ParejasPieza\r\nimport com.nextapp.monasterio.models.ParejasSize\r\nimport com.nextapp.monasterio.viewModels.ParejasViewModel\r\nimport com.nextapp.monasterio.viewModels.ParejasViewModelFactory\r\n\r\n\r\n@Composable\r\nfun ParejasScreen(\r\n    navController: NavController,\r\n    size : ParejasSize,\r\n    imagenes : List<Int>\r\n){\r\n    val factory = remember { ParejasViewModelFactory(size, imagenes) }\r\n    val viewModel: ParejasViewModel = viewModel(factory = factory)\r\n    val state by viewModel.uiState.collectAsState()\r\n\r\n    val context = LocalContext.current\r\n    val activity = context as? Activity\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT\r\n        onDispose {\r\n\r\n        }\r\n    }\r\n\r\n    Column(\r\n        modifier = Modifier\r\n            .fillMaxSize()\r\n            .background(MaterialTheme.colorScheme.surfaceVariant)\r\n            .padding(16.dp),\r\n        horizontalAlignment = Alignment.CenterHorizontally,\r\n        verticalArrangement = Arrangement.Center\r\n    ) {\r\n\r\n        Column(\r\n            modifier = Modifier\r\n                .fillMaxWidth()\r\n                .padding(bottom = 16.dp),\r\n            horizontalAlignment = Alignment.CenterHorizontally\r\n        ) {\r\n            Text(\r\n                text = stringResource(R.string.left_pairs,state.parejas),\r\n                style = MaterialTheme.typography.titleMedium,\r\n                modifier = Modifier.padding(start = 4.dp)\r\n            )\r\n        }\r\n\r\n        LazyVerticalGrid(\r\n            columns = GridCells.Fixed(size.columns),\r\n            modifier = Modifier\r\n                .wrapContentHeight(Alignment.CenterVertically)\r\n                .wrapContentWidth(Alignment.CenterHorizontally)\r\n                .padding(vertical = 8.dp)\r\n                .then(\r\n                    if(size.rows == 4 ) {\r\n                        Modifier.width(300.dp)\r\n                    } else if (size.rows == 5){\r\n                        Modifier.width(250.dp)\r\n                    } else{\r\n                        Modifier.fillMaxWidth()\r\n                    }\r\n                ),\r\n            verticalArrangement = Arrangement.spacedBy(8.dp),\r\n            horizontalArrangement = Arrangement.spacedBy(8.dp),\r\n        ) {\r\n            items(\r\n                state.piezas,\r\n            ){pieza ->\r\n                GridCell(pieza = pieza, mostradoInicial = state.mostradoInicial,onClick = { id -> viewModel.onClickPieza(id) })\r\n            }\r\n        }\r\n    }\r\n\r\n    if (state.solucionado) {\r\n        ParejaDialog(onDismiss = {}, onConfirm = { navController.popBackStack() })\r\n    }\r\n}\r\n\r\n\r\n\r\n@Composable\r\nfun ParejaDialog(\r\n    onDismiss: () -> Unit,\r\n    onConfirm : () -> Unit\r\n){\r\n    AlertDialog(\r\n        onDismissRequest=onDismiss,\r\n        title = {\r\n            Text(stringResource(R.string.congratulations))\r\n        },\r\n        text = {\r\n            Text(stringResource(R.string.message_game_completed))\r\n        },confirmButton = {\r\n            Button(\r\n                onClick = onConfirm\r\n            ) {\r\n                Text(stringResource(R.string.ready))\r\n            }\r\n        },\r\n    )\r\n}\r\n\r\n@Composable\r\nfun GridCell(\r\n    pieza: ParejasPieza,\r\n    mostradoInicial : Boolean,\r\n    onClick : (Int) -> Unit,\r\n) {\r\n    val conPareja = pieza.conPareja\r\n    val isClickable = !conPareja\r\n\r\n    Card(\r\n        elevation = CardDefaults.cardElevation(defaultElevation = if (conPareja || pieza.estaVolteada) 4.dp else 2.dp),\r\n        modifier = Modifier\r\n            .aspectRatio(1f)\r\n            .then(\r\n                if (isClickable && !mostradoInicial){\r\n                    Modifier.clickable{ onClick(pieza.id) }\r\n                } else{\r\n                    Modifier\r\n                }\r\n            ),\r\n        shape = MaterialTheme.shapes.medium,\r\n        colors = CardDefaults.cardColors(\r\n            containerColor = Color.White\r\n        )\r\n    ) {\r\n        Box(\r\n            modifier = Modifier.fillMaxSize(),\r\n            contentAlignment = Alignment.Center\r\n        ) {\r\n            Crossfade(\r\n                targetState = if(conPareja || pieza.estaVolteada || mostradoInicial) 1 else 0,\r\n                animationSpec = tween(durationMillis = 300),\r\n                label=\"CardFlipAnimation\"\r\n            ) { state ->\r\n                if (state == 1) {\r\n                    Image(\r\n                        painter = painterResource(id = pieza.imagen),\r\n                        contentDescription = \"Pieza ${pieza.id}\",\r\n                        contentScale = ContentScale.Crop,\r\n                        modifier = Modifier.fillMaxSize()\r\n                    )\r\n                } else {\r\n                    Image(\r\n                        painterResource(R.drawable.escudo),\r\n                        contentDescription = stringResource(R.string.back_piece),\r\n                        contentScale = ContentScale.Fit,\r\n                        modifier = Modifier.fillMaxSize()\r\n                    )\r\n                }\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/ParejasScreen.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/ParejasScreen.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/ParejasScreen.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/ParejasScreen.kt	(date 1764284129001)
@@ -108,11 +108,12 @@
                 ),
             verticalArrangement = Arrangement.spacedBy(8.dp),
             horizontalArrangement = Arrangement.spacedBy(8.dp),
+            userScrollEnabled = false
         ) {
             items(
                 state.piezas,
             ){pieza ->
-                GridCell(pieza = pieza, mostradoInicial = state.mostradoInicial,onClick = { id -> viewModel.onClickPieza(id) })
+                GridCell(pieza = pieza, mostradoInicial = state.mostradoInicial, verificandoPareja = state.verificandoPareja, onClick = { id -> viewModel.onClickPieza(id) })
             }
         }
     }
@@ -150,11 +151,11 @@
 fun GridCell(
     pieza: ParejasPieza,
     mostradoInicial : Boolean,
+    verificandoPareja : Boolean,
     onClick : (Int) -> Unit,
 ) {
     val conPareja = pieza.conPareja
-    val isClickable = !conPareja
-
+    val isClickable = !conPareja && !verificandoPareja
     Card(
         elevation = CardDefaults.cardElevation(defaultElevation = if (conPareja || pieza.estaVolteada) 4.dp else 2.dp),
         modifier = Modifier
Index: app/src/main/java/com/nextapp/monasterio/ui/screens/JuegoPuzzleScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.rememberScrollState\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.foundation.verticalScroll\r\nimport androidx.compose.material3.Button\r\nimport androidx.compose.material3.ButtonDefaults\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.DisposableEffect\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.unit.sp\r\nimport androidx.constraintlayout.compose.ChainStyle\r\nimport androidx.constraintlayout.compose.ConstraintLayout\r\nimport androidx.constraintlayout.compose.Dimension\r\nimport androidx.navigation.NavController\r\nimport com.nextapp.monasterio.AppRoutes\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.ui.theme.MonasteryBlue\r\n\r\n\r\n\r\n@Composable\r\nfun JuegoPuzzleScreen(navController:NavController,modifier: Modifier = Modifier) {\r\n    val context = LocalContext.current\r\n\r\n    val activity = (context as? Activity)\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n\r\n        onDispose {\r\n\r\n        }\r\n    }\r\n\r\n    ConstraintLayout(modifier = modifier.fillMaxSize().background(Color.White).verticalScroll(rememberScrollState())) {\r\n        val (btn4,btn9,btn16,btn25) = createRefs()\r\n        createVerticalChain(btn4,btn9,btn16,btn25, chainStyle = ChainStyle.Packed)\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.PUZZLENIVEL1)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .padding(bottom = 40.dp)\r\n                .constrainAs(btn4) {\r\n                    top.linkTo(parent.top)\r\n                    bottom.linkTo(btn9.top, margin = 40.dp)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            )  {\r\n                Text(\r\n                    stringResource(id = R.string.four_pieces),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.PUZZLENIVEL2)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .padding(bottom = 40.dp)\r\n                .constrainAs(btn9) {\r\n                    top.linkTo(btn4.bottom, margin = 40.dp)\r\n                    bottom.linkTo(btn16.top,margin=40.dp)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Text(\r\n                    stringResource(id = R.string.nine_pieces),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.PUZZLENIVEL3)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .padding(bottom = 40.dp)\r\n                .constrainAs(btn16) {\r\n                    top.linkTo(btn9.bottom, margin = 40.dp)\r\n                    bottom.linkTo(btn25.top,margin=40.dp)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Text(\r\n                    stringResource(id = R.string.sixteen_pieces),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.PUZZLENIVEL4)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .padding(bottom = 40.dp)\r\n                .constrainAs(btn25) {\r\n                    top.linkTo(btn16.bottom, margin = 40.dp)\r\n                    bottom.linkTo(parent.bottom)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Text(\r\n                    stringResource(id = R.string.twentyfive_pieces),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/JuegoPuzzleScreen.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/JuegoPuzzleScreen.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/JuegoPuzzleScreen.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/JuegoPuzzleScreen.kt	(date 1764284826378)
@@ -2,6 +2,7 @@
 
 import android.app.Activity
 import android.content.pm.ActivityInfo
+import androidx.compose.foundation.Image
 import androidx.compose.foundation.background
 import androidx.compose.foundation.layout.*
 import androidx.compose.foundation.rememberScrollState
@@ -15,7 +16,9 @@
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.graphics.Color
+import androidx.compose.ui.layout.ContentScale
 import androidx.compose.ui.platform.LocalContext
+import androidx.compose.ui.res.painterResource
 import androidx.compose.ui.res.stringResource
 import androidx.compose.ui.text.style.TextAlign
 import androidx.compose.ui.unit.dp
@@ -44,9 +47,25 @@
         }
     }
 
-    ConstraintLayout(modifier = modifier.fillMaxSize().background(Color.White).verticalScroll(rememberScrollState())) {
-        val (btn4,btn9,btn16,btn25) = createRefs()
+    ConstraintLayout(modifier = modifier.fillMaxSize().verticalScroll(rememberScrollState())) {
+        val (btn4,btn9,btn16,btn25,background) = createRefs()
         createVerticalChain(btn4,btn9,btn16,btn25, chainStyle = ChainStyle.Packed)
+
+        Image(
+            painter = painterResource(R.drawable.fondo),
+            contentDescription = "Fondo",
+            contentScale = ContentScale.Crop,
+            modifier = Modifier
+                .constrainAs(background){
+                    top.linkTo(parent.top)
+                    bottom.linkTo(parent.bottom)
+                    start.linkTo(parent.start)
+                    end.linkTo(parent.end)
+                    width = Dimension.fillToConstraints
+                    height = Dimension.fillToConstraints
+                }
+        )
+
         Button(
             onClick = {
                 navController.navigate(AppRoutes.PUZZLENIVEL1)
Index: app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesJuegoNinyos.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport androidx.compose.foundation.Image\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.rememberScrollState\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.foundation.verticalScroll\r\nimport androidx.compose.material3.Button\r\nimport androidx.compose.material3.ButtonDefaults\r\nimport androidx.compose.material3.Icon\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.DisposableEffect\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.layout.ContentScale\r\nimport androidx.compose.ui.platform.LocalConfiguration\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport androidx.compose.ui.tooling.preview.Preview\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.unit.sp\r\nimport androidx.constraintlayout.compose.ConstraintLayout\r\nimport androidx.constraintlayout.compose.Dimension\r\nimport androidx.navigation.NavController\r\nimport androidx.navigation.compose.rememberNavController\r\nimport com.nextapp.monasterio.AppRoutes\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.ui.theme.MonasteryBlue\r\nimport com.nextapp.monasterio.ui.theme.MonasteryRed\r\n\r\n\r\n@Composable\r\nfun OpcionesJuegoNinyos(navController:NavController,modifier: Modifier = Modifier) {\r\n    val context = LocalContext.current\r\n\r\n    val activity = (context as? Activity)\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n\r\n        onDispose {\r\n\r\n        }\r\n    }\r\n\r\n    ConstraintLayout(modifier = modifier.fillMaxSize().background(Color.White).verticalScroll(rememberScrollState())) {\r\n        val (btnMemory,btnPuzle) = createRefs()\r\n        val centerGuide = createGuidelineFromTop(0.5f)\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.JUEGO_PUZZLE)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .constrainAs(btnPuzle) {\r\n                    bottom.linkTo(centerGuide, margin = 24.dp)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            )  {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.puzzle),\r\n                    contentDescription = null,\r\n                    modifier = Modifier\r\n                        .padding(end = 18.dp)\r\n                        .size(48.dp)\r\n                )\r\n                Text(\r\n                    stringResource(id = R.string.puzzle_option),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.JUEGO_PAREJAS)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryRed),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .constrainAs(btnMemory) {\r\n                    top.linkTo(centerGuide, margin = 24.dp)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.memory),\r\n                    contentDescription = null,\r\n                    modifier = Modifier\r\n                        .padding(end = 16.dp)\r\n                        .size(48.dp)\r\n\r\n                )\r\n                Text(\r\n                    stringResource(id = R.string.memory_option),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesJuegoNinyos.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesJuegoNinyos.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesJuegoNinyos.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesJuegoNinyos.kt	(date 1764284765513)
@@ -50,9 +50,25 @@
         }
     }
 
-    ConstraintLayout(modifier = modifier.fillMaxSize().background(Color.White).verticalScroll(rememberScrollState())) {
-        val (btnMemory,btnPuzle) = createRefs()
+    ConstraintLayout(modifier = modifier.fillMaxSize().verticalScroll(rememberScrollState())) {
+        val (btnMemory,btnPuzle,background) = createRefs()
         val centerGuide = createGuidelineFromTop(0.5f)
+
+        Image(
+            painter = painterResource(R.drawable.fondo),
+            contentDescription = "Fondo",
+            contentScale = ContentScale.Crop,
+            modifier = Modifier
+                .constrainAs(background){
+                    top.linkTo(parent.top)
+                    bottom.linkTo(parent.bottom)
+                    start.linkTo(parent.start)
+                    end.linkTo(parent.end)
+                    width = Dimension.fillToConstraints
+                    height = Dimension.fillToConstraints
+                }
+        )
+
         Button(
             onClick = {
                 navController.navigate(AppRoutes.JUEGO_PUZZLE)
Index: app/src/main/res/values-de/strings.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<resources>\r\n    <string name=\"app_name\">Museum360</string>\r\n    <string name=\"title_inicio\">Startseite</string>\r\n    <string name=\"virtual_visit\">VIRTUELLER BESUCH</string>\r\n    <string name=\"book_appointment\">TERMIN BUCHEN</string>\r\n    <string name=\"monastery_name\">Santa Mar√≠a\\nla Real de Huelgas</string>\r\n    <string name=\"edit_mode_activate_icon\">Bearbeitungsmodus</string>\r\n    <string name=\"edit_mode_deactivate_icon\">Bearbeitungsmodus beenden</string>\r\n    <string name=\"edit_mode_activate_message\">Bearbeitungsmodus aktiviert</string>\r\n    <string name=\"edit_mode_deactivate_message\">Bearbeitungsmodus deaktiviert</string>\r\n    <string name=\"edit_save_changes\">√Ñnderungen speichern</string>\r\n    <string name=\"profile_login\">Anmelden</string>\r\n    <string name=\"profile_logout\">Abmelden</string>\r\n    <string name=\"profile_email\">E-Mail</string>\r\n    <string name=\"profile_password\">Passwort</string>\r\n    <string name=\"navigation_drawer_open\">Men√º √∂ffnen</string>\r\n    <string name=\"navigation_drawer_close\">Men√º schlie√üen</string>\r\n    <string name=\"menu_info\">Klosterinformationen</string>\r\n    <string name=\"menu_history\">Geschichte</string>\r\n    <string name=\"menu_gallery\">Galerie</string>\r\n    <string name=\"menu_profile\">Profil</string>\r\n    <string name=\"menu_settings\">Einstellungen</string>\r\n    <string name=\"title_info_general\">Allgemeine Informationen</string>\r\n    <string name=\"title_history\">Geschichte</string>\r\n    <string name=\"title_gallery\">Galerie</string>\r\n    <string name=\"title_profile\">Profil</string>\r\n    <string name=\"title_settings\">Einstellungen</string>\r\n\r\n\r\n    <string name=\"info_location\">Stra√üe: ‚Ä¶</string>\r\n\r\n    <string name=\"history_1328\">1328 \uD83D\uDD25 Brand und Wiederaufbau</string>\r\n    <string name=\"history_1328_body\">W√§hrend eines Brandes in Valladolid, ausgel√∂st durch die Truppen Alfons‚Äô XI., wurde das Kloster in den Pal√§sten von La Magdalena schwer besch√§digt. Die Nonnen begannen mit dem Wiederaufbau dank der finanziellen Unterst√ºtzung von √Ålvaro Nu√±o P√©rez de Monroy.</string>\r\n\r\n    <string name=\"history_1579\">1579 \uD83C\uDFF0 Wiederaufbau der Kirche und des Kreuzgangs</string>\r\n    <string name=\"history_579_body\">Die Nonnen errichteten die Kirche nach dem Entwurf des italienischen Meisters Pietro Palladio. Der Altaraufsatz stammte von Gregorio Fern√°ndez, und der neue Kreuzgang wurde von Francisco de Praves gebaut. All dies wurde durch die Spenden der √Ñbtissinnen Ana und Isabel de Mendoza erm√∂glicht.</string>\r\n\r\n    <string name=\"history_1869\">1869 \uD83C\uDF93 Gr√ºndung der Klosterschule</string>\r\n    <string name=\"history_1869_body\">Die Gemeinschaft der Huelgas Reales er√∂ffnete ihre eigene Schule und nahm adlige M√§dchen aus Valladolid als Halbinternats\u00ADsch√ºlerinnen auf.</string>\r\n\r\n    <string name=\"history_XX\">20.‚Äì21. Jahrhundert ‚ú® Restaurierung und modernes Leben</string>\r\n    <string name=\"history_XX_body\">Das Kloster wurde vollst√§ndig restauriert. Der R√ºckgang der Berufungen f√ºhrte zur Gr√ºndung der Laien-Zisterzienserbruderschaft, die den Geist der Regula Benedicti lebendig h√§lt.</string>\r\n\r\n    <string name=\"history_2007\">Seit 2007 \uD83D\uDC69\u200D\uD83E\uDDB3 Leitung und weibliche Kongregation</string>\r\n    <string name=\"history_2007_body\">Das Kloster geh√∂rt zur Kastilischen Kongregation des Zisterzienserordens, die seit 2007 als weibliche Kongregation aktiv ist. Die erste Pr√§sidentin der √Ñbtissinnen war Mar√≠a del Mar Mart√≠nez; nach ihrem Tod im Jahr 2013 √ºbernahm Schwester Isabel Vall√©s Gallego das Amt. Derzeit leitet Schwester Mar√≠a das Kloster und die Schule.</string>\r\n    <string name=\"info_hours\">√ñffnungszeiten: XX:XX - YY:YY</string>\r\n    <string name=\"general_info\">Allgemeine Informationen:</string>\r\n    <string name=\"title_appointment\">Termin buchen</string>\r\n    <string name=\"option_phone_appointment\">Telefonisch buchen</string>\r\n    <string name=\"option_online_appointment\">Online buchen</string>\r\n    <string name=\"name_appointment\">Name</string>\r\n    <string name=\"email_appointment\">E-Mail</string>\r\n    <string name=\"date_appointment\">Datum</string>\r\n    <string name=\"hour_appointment\">Uhrzeit</string>\r\n    <string name=\"placeholdername_appointment\">Geben Sie Ihren vollst√§ndigen Namen ein</string>\r\n    <string name=\"placeholderemail_appointment\">Geben Sie Ihre E-Mail-Adresse ein</string>\r\n    <string name=\"placeholderdate_appointment\">W√§hlen Sie ein Datum</string>\r\n    <string name=\"placeholderhour_appointment\">W√§hlen Sie eine Uhrzeit</string>\r\n    <string name=\"compulsory_name\">Name ist erforderlich</string>\r\n    <string name=\"valid_name\">Der Name enth√§lt ein ung√ºltiges Symbol</string>\r\n    <string name=\"compulsory_email\">E-Mail ist erforderlich</string>\r\n    <string name=\"valid_email\">Das E-Mail-Format ist ung√ºltig</string>\r\n    <string name=\"date_no_selected\">Ein Datum muss ausgew√§hlt werden</string>\r\n    <string name=\"hour_no_selected\">Eine Uhrzeit muss ausgew√§hlt werden</string>\r\n    <string name=\"datepicker_ok\">Ok</string>\r\n    <string name=\"datepicker_cancel\">Abbrechen</string>\r\n    <string name=\"confirm_button\">BEST√ÑTIGEN</string>\r\n    <string name=\"contentimage_confirmation\">Best√§tigt</string>\r\n    <string name=\"confirmation_appointment\">FAST FERTIG!!</string>\r\n    <string name=\"details_appointment\">Ihre Buchungsanfrage ist bereit. Bitte klicken Sie auf \\'Senden\\' in der gerade ge√∂ffneten E-Mail-Anwendung, um Ihre Anfrage abzuschlie√üen. Wir werden auf diese E-Mail antworten, um die Verf√ºgbarkeit zu best√§tigen.</string>\r\n    <string name=\"email_subject\">Anfrage f√ºr Besuchsreservierung - %1$s</string>\r\n    <string name=\"email_message\">Hallo,\\n\\nIch m√∂chte eine Reservierung f√ºr einen Besuch des Klosters mit den folgenden Details anfordern:\\n\\n* Name: %1$s\\n* E-Mail: %2$s\\n* Besuchsdatum: %3$s\\n* Besuchszeit: %4$s\\n\\nIch freue mich auf Ihre freundliche Best√§tigung.\\n\\nVielen Dank,\\nMit freundlichen Gr√º√üen,\\n\\n%1$s</string>\r\n    <string name=\"email_error\">Es wurde keine E-Mail-App gefunden</string>\r\n    <string name=\"history_content_placeholder\">Mauris vel nisi id metus vestibulum vehicula nec ac orci. Curabitur massa diam, fermentum sit amet augue sit, volutpat efficitur enim. Phasellus a cursus orci, id laoreet dolor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</string>\r\n    <string name=\"language_select\">Sprache ausw√§hlen</string>\r\n    <string name=\"font_size_select\">Schriftgr√∂√üe ausw√§hlen</string>\r\n    <string name=\"font_extrabig\">Extra Gro√ü</string>\r\n    <string name=\"font_normal\">Mittel</string>\r\n    <string name=\"font_big\">Gro√ü</string>\r\n    <string name=\"title_monasterio\">Kloster</string>\r\n    <string name=\"title_entrada\">Klostereingang</string>\r\n    <string name=\"spanish_language\">Spanisch</string>\r\n    <string name=\"german_language\">Deutsch</string>\r\n    <string name=\"english_language\">Englisch</string>\r\n    <string name=\"navegation_button\">Navigationsschaltfl√§chen ausblenden</string>\r\n    <string name=\"close\">Schlie√üen</string>\r\n    <string name=\"go_back\">Zur√ºck</string>\r\n    <string name=\"see_360\">360¬∫ ansehen</string>\r\n    <string name=\"contentdescription_image_pin\">Pin-Bild (zum Vergr√∂√üern klicken)</string>\r\n    <string name=\"readjust\">Neu anpassen</string>\r\n    <string name=\"decrease\">Verringern</string>\r\n    <string name=\"increase\">Erh√∂hen</string>\r\n    <string name=\"out_interactive_area\">Au√üerhalb des interaktiven Bereichs</string>\r\n    <string name=\"notdefined_destiny\">Ziel nicht definiert</string>\r\n    <string name=\"notdefined_destinyplane\">Zielplan nicht definiert</string>\r\n    <string name=\"plane_loading\">Lade Plan...</string>\r\n    <string name=\"error_loading_plane\">Fehler beim Laden der Plandaten</string>\r\n    <string name=\"child_mode\">KINDERMODUS</string>\r\n    <string name=\"child_mode_view\">Kindermodus</string>\r\n    <string name=\"video_view\">Video</string>\r\n    <string name=\"game_view\">Spiele</string>\r\n    <string name=\"video_child\">VIDEO</string>\r\n    <string name=\"game_child\">SPIELE</string>\r\n    <string name=\"edit_mode\">BEARBEITUNGSMODUS</string>\r\n    <string name=\"edit_home_background\">Startseiten-Hintergrund bearbeiten</string>\r\n    <string name=\"edit_pins\">Pins bearbeiten</string>\r\n    <string name=\"location_error\">Es wurde keine App gefunden, mit der der Standort ge√∂ffnet werden kann.</string>\r\n    <string name=\"contact_data\">Kontaktinformationen</string>\r\n    <string name=\"location_data\">Standort</string>\r\n    <string name=\"email_data\">E-Mail</string>\r\n    <string name=\"phone_data\">Telefon</string>\r\n    <string name=\"visit_schedule\">√ñffnungszeiten</string>\r\n    <string name=\"monday_to_friday\">Montag bis Freitag:</string>\r\n    <string name=\"confirm_save_title\">√Ñnderungen speichern?</string>\r\n    <string name=\"confirm_save_message\">Sind Sie sicher, dass Sie die √Ñnderungen speichern m√∂chten?</string>\r\n    <string name=\"confirm_save_button\">Speichern</string>\r\n    <string name=\"confirm_cancel_button\">Abbrechen</string>\r\n    <string name=\"edit_cancel_changes\">Abbrechen</string>\r\n    <string name=\"profile_name\">Name</string>\r\n    <string name=\"image_add\">Bild hinzuf√ºgen</string>\r\n    <string name=\"image_delete\">L√∂schen</string>\r\n    <string name=\"image_delete_confirm_title\">Bild l√∂schen?</string>\r\n    <string name=\"image_delete_confirm_message\">Diese Aktion kann nicht r√ºckg√§ngig gemacht werden</string>\r\n    <string name=\"image_uploading\">Bild wird hochgeladen...</string>\r\n    <string name=\"image_upload_success\">Bild erfolgreich hochgeladen</string>\r\n    <string name=\"image_upload_error\">Fehler beim Hochladen des Bildes</string>\r\n    <string name=\"image_select_error\">Fehler beim Ausw√§hlen des Bildes</string>\r\n    <string name=\"four_pieces\">4 St√ºck</string>\r\n    <string name=\"nine_pieces\">9 St√ºck</string>\r\n    <string name=\"sixteen_pieces\">16 St√ºck</string>\r\n    <string name=\"twentyfive_pieces\">25 St√ºck</string>\r\n    <string name=\"three_pairs\">3 Paare</string>\r\n    <string name=\"four_pairs\">4 Paare</string>\r\n    <string name=\"five_pairs\">5 Paare</string>\r\n    <string name=\"six_pairs\">6 Paare</string>\r\n    <string name=\"congratulations\">Gl√ºckwunsch!</string>\r\n    <string name=\"message_game_completed\">Du hast das Spiel gel√∂st! Bereit f√ºr die n√§chste Herausforderung?</string>\r\n    <string name=\"original_image\">Bild ansehen</string>\r\n    <string name=\"ready\">Bereit</string>\r\n    <string name=\"dont_show_again\">Nicht mehr anzeigen</string>\r\n    <string name=\"understand\">Verstanden</string>\r\n    <string name=\"map_tutorial_body\">Dies ist der Inhalt des Tutorials</string>\r\n    <string name=\"map_tutorial_title\">Dies ist der Titel des Tutorials</string>\r\n    <string name=\"map_tutorial_body2\">Dies ist der Inhalt des Kartentutorials 2</string>\r\n    <string name=\"map_tutorial_title2\">Dies ist der Titel des Kartentutorials 2</string>\r\n    <string name=\"pin_tutorial_body\">Dies ist der Inhalt des Pin-Tutorials</string>\r\n    <string name=\"pin_tutorial_title\">Dies ist der Titel des Pin-Tutorials</string>\r\n    <string name=\"next\">Weiter</string>\r\n\r\n    <string name=\"map_tutorial_body1\">Oben links k√∂nnen Sie √ºber das Symbol (‚Üê) zum Start zur√ºckkehren.</string>\r\n    <string name=\"map_tutorial_body1_2\">Tippen Sie auf die farbigen Bereiche der Karte, um die verschiedenen Bereiche zu erkunden.</string>\r\n    <string name=\"map_tutorial_body1_3\">Mit den Tasten auf der rechten Seite k√∂nnen Sie die Karte vergr√∂√üern, verkleinern oder zur√ºcksetzen.</string>\r\n\r\n    <string name=\"submapa_1\">Tippen Sie auf das Symbol (‚Üê), um zur √úbersichtskarte zur√ºckzukehren.</string>\r\n    <string name=\"submapa_2\">Tippen Sie auf die verschiedenen Pins, um die Details aufzurufen.</string>\r\n\r\n    <string name=\"pin_1\">Dr√ºcken Sie das Symbol (‚Üê), um zur Karte zur√ºckzukehren.</string>\r\n    <string name=\"pin_2\">Wischen Sie durch die Bilder oder tippen Sie darauf, um sie zu vergr√∂√üern.</string>\r\n    <string name=\"pin_3\">Tippen Sie hier, um den Audioguide anzuh√∂ren.</string>\r\n    <string name=\"pin_4\">Dr√ºcken Sie diesen Button, um die 360¬∞-Ansicht zu √∂ffnen.</string>\r\n    <string name=\"image_gallery_title\">Bilder</string>\r\n    <string name=\"visible\">sichtbar</string>\r\n    <string name=\"hidden\">versteckt</string>\r\n    <string name=\"lang_en\">English</string>\r\n    <string name=\"lang_es\">Espa√±ol</string>\r\n    <string name=\"sample_text\">Beispiel</string>\r\n    <string name=\"lang_de\">Deutsch</string>\r\n    <string name=\"font_small\">Klein</string>\r\n    <string name=\"font_medium\">Mittel</string>\r\n    <string name=\"font_large\">Gro√ü</string>\r\n    <string name=\"puzzle_screen\">Puzzle</string>\r\n    <string name=\"puzzle_option\">PUZZLE</string>\r\n    <string name=\"memory_screen\">Memory</string>\r\n    <string name=\"memory_option\">MEMORY</string>\r\n    <string name=\"back_piece\">R√ºckseite des St√ºckes</string>\r\n    <string name=\"left_pairs\">Verbleibende Paare: %1$s</string>\r\n    <string name=\"left_pieces\">Restliche St√ºcke: %1$s</string>\r\n    <!-- Gallery Types -->\r\n    <string name=\"gallery_type_all\">Alle</string>\r\n    <string name=\"gallery_type_painting\">Gem√§lde</string>\r\n    <string name=\"gallery_type_sculpture\">Skulpturen</string>\r\n    <string name=\"gallery_type_architecture\">Architektur</string>\r\n    <string name=\"gallery_type_other\">Andere</string>\r\n</resources>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/values-de/strings.xml b/app/src/main/res/values-de/strings.xml
--- a/app/src/main/res/values-de/strings.xml	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/res/values-de/strings.xml	(date 1764287672732)
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <resources>
-    <string name="app_name">Museum360</string>
+    <string name="app_name">Santa Mar√≠a la Real de Huelgas</string>
     <string name="title_inicio">Startseite</string>
     <string name="virtual_visit">VIRTUELLER BESUCH</string>
     <string name="book_appointment">TERMIN BUCHEN</string>
@@ -166,6 +166,7 @@
     <string name="lang_es">Espa√±ol</string>
     <string name="sample_text">Beispiel</string>
     <string name="lang_de">Deutsch</string>
+    <string name="lang_fr">Fran√ßais</string>
     <string name="font_small">Klein</string>
     <string name="font_medium">Mittel</string>
     <string name="font_large">Gro√ü</string>
@@ -176,6 +177,8 @@
     <string name="back_piece">R√ºckseite des St√ºckes</string>
     <string name="left_pairs">Verbleibende Paare: %1$s</string>
     <string name="left_pieces">Restliche St√ºcke: %1$s</string>
+    <string name="background_edit_screen">HINTERGRUND BEARBEITEN</string>
+    <string name="pin_edit_screen">PIN BEARBEITEN</string>
     <!-- Gallery Types -->
     <string name="gallery_type_all">Alle</string>
     <string name="gallery_type_painting">Gem√§lde</string>
Index: app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesModoEdicion.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport androidx.compose.foundation.Image\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.rememberScrollState\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.foundation.verticalScroll\r\nimport androidx.compose.material3.Button\r\nimport androidx.compose.material3.ButtonDefaults\r\nimport androidx.compose.material3.Icon\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.DisposableEffect\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.layout.ContentScale\r\nimport androidx.compose.ui.platform.LocalConfiguration\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport androidx.compose.ui.tooling.preview.Preview\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.unit.sp\r\nimport androidx.constraintlayout.compose.ConstraintLayout\r\nimport androidx.constraintlayout.compose.Dimension\r\nimport androidx.navigation.NavController\r\nimport androidx.navigation.compose.rememberNavController\r\nimport com.nextapp.monasterio.AppRoutes\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.ui.theme.MonasteryBlue\r\nimport com.nextapp.monasterio.ui.theme.MonasteryOrange\r\n\r\n@Composable\r\nfun OpcionesModoEdicion(navController: NavController, modifier: Modifier = Modifier) {\r\n    val context = LocalContext.current\r\n    val activity = (context as? Activity)\r\n\r\n    // Bloque para establecer la orientaci√≥n vertical y limpiarla (copiado del original)\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT\r\n\r\n        onDispose {\r\n\r\n        }\r\n    }\r\n\r\n    ConstraintLayout(\r\n        modifier = modifier\r\n            .fillMaxSize()\r\n            .background(Color.White)\r\n            .verticalScroll(rememberScrollState())\r\n    ) {\r\n        val (btnInicio, btnPines) = createRefs()\r\n        val centerGuide = createGuidelineFromTop(0.5f)\r\n\r\n        // --- BOT√ìN: Edici√≥n pantalla inicio (btnInicio) ---\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.EDICION_FONDO_INICIO)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryOrange),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .constrainAs(btnInicio) {\r\n                    bottom.linkTo(centerGuide, margin = 24.dp) // Centrado superior\r\n                    start.linkTo(parent.start, margin = 40.dp) // Margen de 40.dp\r\n                    end.linkTo(parent.end, margin = 40.dp)   // Margen de 40.dp\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier = Modifier.padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.ic_photo), // icono temporal\r\n                    contentDescription = null,\r\n                    modifier = Modifier\r\n                        .padding(end = 18.dp)\r\n                        .size(48.dp)\r\n                )\r\n                Text(\r\n                    text = stringResource(R.string.edit_home_background),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n\r\n        // --- BOT√ìN: Edici√≥n pines (btnPines) ---\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.EDICION_PINES)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .constrainAs(btnPines) {\r\n                    top.linkTo(centerGuide, margin = 24.dp) // Centrado inferior\r\n                    start.linkTo(parent.start, margin = 40.dp) // Margen de 40.dp\r\n                    end.linkTo(parent.end, margin = 40.dp)   // Margen de 40.dp\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier = Modifier.padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.pin3), // icono temporal\r\n                    contentDescription = null,\r\n                    modifier = Modifier\r\n                        .padding(end = 18.dp) // Se ha ajustado el padding para igualar el patr√≥n\r\n                        .size(48.dp)\r\n                )\r\n                Text(\r\n                    text = stringResource(R.string.edit_pins),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesModoEdicion.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesModoEdicion.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesModoEdicion.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesModoEdicion.kt	(date 1764284914043)
@@ -52,12 +52,26 @@
     ConstraintLayout(
         modifier = modifier
             .fillMaxSize()
-            .background(Color.White)
             .verticalScroll(rememberScrollState())
     ) {
-        val (btnInicio, btnPines) = createRefs()
+        val (btnInicio, btnPines,background) = createRefs()
         val centerGuide = createGuidelineFromTop(0.5f)
 
+        Image(
+            painter = painterResource(R.drawable.fondo),
+            contentDescription = "Fondo",
+            contentScale = ContentScale.Crop,
+            modifier = Modifier
+                .constrainAs(background){
+                    top.linkTo(parent.top)
+                    bottom.linkTo(parent.bottom)
+                    start.linkTo(parent.start)
+                    end.linkTo(parent.end)
+                    width = Dimension.fillToConstraints
+                    height = Dimension.fillToConstraints
+                }
+        )
+
         // --- BOT√ìN: Edici√≥n pantalla inicio (btnInicio) ---
         Button(
             onClick = {
Index: app/src/main/java/com/nextapp/monasterio/viewModels/ParejasViewModel.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.viewModels\r\n\r\nimport android.util.Log\r\nimport android.widget.ImageView\r\nimport androidx.lifecycle.ViewModel\r\nimport androidx.lifecycle.ViewModelProvider\r\nimport androidx.lifecycle.viewModelScope\r\nimport com.nextapp.monasterio.models.ParejasManager\r\nimport com.nextapp.monasterio.models.ParejasPieza\r\nimport com.nextapp.monasterio.models.ParejasSize\r\nimport com.nextapp.monasterio.models.PuzzleSize\r\nimport kotlinx.coroutines.delay\r\nimport kotlinx.coroutines.flow.MutableStateFlow\r\nimport kotlinx.coroutines.flow.StateFlow\r\nimport kotlinx.coroutines.flow.update\r\nimport kotlinx.coroutines.launch\r\n\r\ndata class parejasUiState(\r\n    val piezas : List<ParejasPieza> = emptyList(),\r\n    val size : ParejasSize,\r\n    val solucionado : Boolean = false,\r\n    val mostradoInicial : Boolean = true,\r\n    val parejas : Int = (size.columns* size.rows)/2\r\n)\r\n\r\nclass ParejasViewModel (\r\n    val size: ParejasSize,\r\n    val imagenesIds: List<Int>\r\n): ViewModel(){\r\n\r\n    private val _uiState = MutableStateFlow(parejasUiState(size=size))\r\n\r\n    val uiState: StateFlow<parejasUiState> = _uiState\r\n\r\n    val piezasManager = ParejasManager(size)\r\n\r\n    init{\r\n        resetGame()\r\n    }\r\n    fun resetGame(){\r\n        val piezasIniciales = piezasManager.inicializarParejaPiezas(imagenesIds)\r\n        _uiState.value = parejasUiState(\r\n            piezas = piezasIniciales,\r\n            size = size,\r\n            solucionado = false,\r\n            mostradoInicial =  true\r\n        )\r\n        viewModelScope.launch {\r\n            delay(3000)\r\n            _uiState.update{\r\n                it.copy(mostradoInicial = false)\r\n            }\r\n        }\r\n    }\r\n\r\n    private val piezasVolteadas = mutableListOf<ParejasPieza>()\r\n\r\n    fun onClickPieza(id:Int){\r\n        if(piezasVolteadas.size == 2) return\r\n\r\n        val piezaClickeada = _uiState.value.piezas.find { it.id == id } ?: return\r\n\r\n        if(piezaClickeada.estaVolteada || piezaClickeada.conPareja) return\r\n\r\n        val nuevasPiezas = _uiState.value.piezas.toMutableList().apply {\r\n            val index = indexOfFirst { it.id == id }\r\n            this[index] = piezaClickeada.copy(estaVolteada = true)\r\n        }\r\n        _uiState.update { it.copy(piezas = nuevasPiezas) }\r\n\r\n        val nuevaPiezaVolteada = nuevasPiezas.find { it.id == id }!!\r\n        piezasVolteadas.add(nuevaPiezaVolteada)\r\n\r\n        // 2. Si ya hay dos piezas volteadas, chequeamos la pareja\r\n        if (piezasVolteadas.size == 2) {\r\n            chequearPareja(piezasVolteadas)\r\n        }\r\n\r\n    }\r\n\r\n    private fun chequearPareja(piezas : List<ParejasPieza>){\r\n        val pieza1 = piezas[0]\r\n        val pieza2 = piezas[1]\r\n\r\n        viewModelScope.launch {\r\n\r\n            delay(1000)\r\n\r\n            var piezasCompletas = _uiState.value.piezas\r\n            var parejasRestantes = _uiState.value.parejas\r\n\r\n            if(pieza1.imagen == pieza2.imagen){\r\n                piezasCompletas = piezasCompletas.map { pieza ->\r\n                    if (pieza.id == pieza1.id || pieza.id == pieza2.id) {\r\n                        // Crea una nueva pieza, resuelta y no volteada\r\n                        pieza.copy(conPareja = true, estaVolteada = false).also{\r\n                        }\r\n                    } else {\r\n                        pieza\r\n                    }\r\n                }\r\n                parejasRestantes -= 1\r\n            }\r\n            else{\r\n                piezasCompletas = piezasCompletas.map { pieza ->\r\n                    if (pieza.id == pieza1.id || pieza.id == pieza2.id) {\r\n                        // Crea una nueva pieza, des-volteada\r\n                        pieza.copy(estaVolteada = false).also{\r\n                        }\r\n                    } else {\r\n                        pieza\r\n                    }\r\n                }\r\n            }\r\n            this@ParejasViewModel.piezasVolteadas.clear()\r\n            _uiState.update { it.copy(piezas = piezasCompletas, parejas=parejasRestantes) }\r\n            val todasPiezasConPareja = estaTerminado()\r\n            _uiState.update { it.copy(solucionado = estaTerminado()) }\r\n\r\n        }\r\n    }\r\n\r\n    private fun estaTerminado(): Boolean{\r\n        val piezasActuales = _uiState.value.piezas\r\n        val todasPiezasConPareja = piezasActuales.all{pieza ->\r\n            pieza.conPareja\r\n        }\r\n        return todasPiezasConPareja\r\n    }\r\n\r\n\r\n}\r\n\r\nclass ParejasViewModelFactory(\r\n    private val size: ParejasSize,\r\n    private val imagenesIds: List<Int>\r\n) : ViewModelProvider.Factory{\r\n    @Suppress(\"UNCHECKED_CAST\")\r\n    override fun <T : ViewModel> create(modelClass: Class<T>): T {\r\n        if (modelClass.isAssignableFrom(ParejasViewModel::class.java)) {\r\n            return ParejasViewModel(size, imagenesIds) as T\r\n        }\r\n        throw IllegalArgumentException(\"Unknown ViewModel class\")\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/viewModels/ParejasViewModel.kt b/app/src/main/java/com/nextapp/monasterio/viewModels/ParejasViewModel.kt
--- a/app/src/main/java/com/nextapp/monasterio/viewModels/ParejasViewModel.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/viewModels/ParejasViewModel.kt	(date 1764284262464)
@@ -20,6 +20,7 @@
     val size : ParejasSize,
     val solucionado : Boolean = false,
     val mostradoInicial : Boolean = true,
+    val verificandoPareja: Boolean = false,
     val parejas : Int = (size.columns* size.rows)/2
 )
 
@@ -56,8 +57,8 @@
     private val piezasVolteadas = mutableListOf<ParejasPieza>()
 
     fun onClickPieza(id:Int){
+        if(_uiState.value.verificandoPareja) return
         if(piezasVolteadas.size == 2) return
-
         val piezaClickeada = _uiState.value.piezas.find { it.id == id } ?: return
 
         if(piezaClickeada.estaVolteada || piezaClickeada.conPareja) return
@@ -78,14 +79,13 @@
 
     }
 
-    private fun chequearPareja(piezas : List<ParejasPieza>){
+    private fun chequearPareja(piezas : List<ParejasPieza>,){
         val pieza1 = piezas[0]
         val pieza2 = piezas[1]
 
         viewModelScope.launch {
-
+            _uiState.update { it.copy(verificandoPareja = true) }
             delay(1000)
-
             var piezasCompletas = _uiState.value.piezas
             var parejasRestantes = _uiState.value.parejas
 
@@ -113,10 +113,9 @@
                 }
             }
             this@ParejasViewModel.piezasVolteadas.clear()
-            _uiState.update { it.copy(piezas = piezasCompletas, parejas=parejasRestantes) }
+            _uiState.update { it.copy(piezas = piezasCompletas, verificandoPareja = false, parejas=parejasRestantes) }
             val todasPiezasConPareja = estaTerminado()
             _uiState.update { it.copy(solucionado = estaTerminado()) }
-
         }
     }
 
Index: app/src/main/res/values/strings.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><resources>\r\n    <string name=\"app_name\">Santa Mar√≠a la Real de Huelgas</string>\r\n    <string name=\"title_inicio\">Inicio</string>\r\n    <string name=\"virtual_visit\">VISITA VIRTUAL</string>\r\n    <string name=\"book_appointment\">RESERVA CITA</string>\r\n    <string name=\"monastery_name\">Santa Mar√≠a\\nla Real de Huelgas</string>\r\n    <string name=\"edit_mode_activate_icon\">Modo edici√≥n</string>\r\n    <string name=\"edit_mode_deactivate_icon\">Salir del modo edici√≥n</string>\r\n    <string name=\"edit_mode_activate_message\">Modo edici√≥n activado</string>\r\n    <string name=\"edit_mode_deactivate_message\">Modo edici√≥n desactivado</string>\r\n    <string name=\"edit_save_changes\">Guardar cambios</string>\r\n    <string name=\"profile_login\">Iniciar Sesi√≥n</string>\r\n    <string name=\"profile_logout\">Cerrar Sesi√≥n</string>\r\n    <string name=\"profile_email\">Correo Electr√≥nico</string>\r\n    <string name=\"profile_password\">Contrase√±a</string>\r\n    <string name=\"navigation_drawer_open\">Abrir men√∫</string>\r\n    <string name=\"navigation_drawer_close\">Cerrar men√∫</string>\r\n    <string name=\"menu_info\">Informaci√≥n monasterio</string>\r\n    <string name=\"menu_history\">Historia</string>\r\n    <string name=\"menu_gallery\">Galer√≠a</string>\r\n    <string name=\"menu_profile\">Perfil</string>\r\n    <string name=\"menu_settings\">Ajustes</string>\r\n    <string name=\"title_info_general\">Informaci√≥n General</string>\r\n    <string name=\"title_history\">Historia</string>\r\n    <string name=\"title_gallery\">Galer√≠a</string>\r\n    <string name=\"title_profile\">Perfil</string>\r\n    <string name=\"title_settings\">Ajustes</string>\r\n    <string name=\"info_location\">C/‚Ä¶</string>\r\n    <string name=\"info_hours\">C/XX:XX - YY:YY</string>\r\n    <string name=\"general_info\">Informaci√≥n general:</string>\r\n    <string name=\"history_1328\">1328 \uD83D\uDD25 Incendio y reconstrucci√≥n</string>\r\n    <string name=\"history_1328_body\">Durante un incendio en Valladolid provocado por tropas de Alfonso XI, el monasterio en los palacios de la Magdalena qued√≥ gravemente da√±ado. Las monjas comenzaron su reconstrucci√≥n gracias a la ayuda econ√≥mica de √Ålvaro Nu√±o P√©rez de Monroy.</string>\r\n    <string name=\"history_1579\">1579 \uD83C\uDFF0 Reconstrucci√≥n de la iglesia y el claustro</string>\r\n    <string name=\"history_579_body\">Las monjas levantaron la iglesia siguiendo el dise√±o del maestro italiano Pietro Palladio. El retablo fue obra de Gregorio Fern√°ndez y el nuevo claustro, de Francisco de Praves. Todo esto se hizo posible gracias a las donaciones de las abadesas Ana e Isabel de Mendoza.</string>\r\n    <string name=\"history_1869\">1869 \uD83C\uDF93 Nace la escuela del monasterio</string>\r\n    <string name=\"history_1869_body\">La comunidad de las Huelgas Reales abri√≥ su propia escuela, acogiendo a ni√±as de la nobleza vallisoletana como medio pensionistas.</string>\r\n    <string name=\"history_XX\">Siglo XX-XXI ‚ú® Restauraci√≥n y vida moderna</string>\r\n    <string name=\"history_XX_body\">El monasterio fue totalmente restaurado. La disminuci√≥n de vocaciones impuls√≥ la creaci√≥n de la Hermandad Laica Cisterciense, que mantiene vivo el esp√≠ritu de la Regla de San Benito.</string>\r\n    <string name=\"history_2007\">2007 en adelante \uD83D\uDC69\u200D\uD83E\uDDB3 Liderazgo y Congregaci√≥n femenina</string>\r\n    <string name=\"history_2007_body\">El monasterio forma parte de la Congregaci√≥n de Castilla de la Orden del Cister, activa como congregaci√≥n femenina desde 2007. La primera abadesa presidenta fue Mar√≠a del Mar Mart√≠nez; tras su fallecimiento en 2013, Sor Isabel Vall√©s Gallego asumi√≥ el cargo. Actualmente, Sor Mar√≠a dirige el monasterio y el colegio.</string>\r\n    <string name=\"title_appointment\">Reservar Cita</string>\r\n    <string name=\"option_phone_appointment\">Reservar por tel√©fono</string>\r\n    <string name=\"option_online_appointment\">Reservar online</string>\r\n    <string name=\"name_appointment\">Nombre y apellidos</string>\r\n    <string name=\"email_appointment\">Correo electr√≥nico</string>\r\n    <string name=\"date_appointment\">Fecha</string>\r\n    <string name=\"hour_appointment\">Hora</string>\r\n    <string name=\"placeholdername_appointment\">Introduce tu nombre y apellidos</string>\r\n    <string name=\"placeholderemail_appointment\">Introduce tu correo electr√≥nico</string>\r\n    <string name=\"placeholderdate_appointment\">Selecciona una fecha</string>\r\n    <string name=\"placeholderhour_appointment\">Selecciona una hora</string>\r\n    <string name=\"compulsory_name\">El nombre es obligatorio</string>\r\n    <string name=\"valid_name\">El nombre contiene alg√∫n simbolo no v√°lido</string>\r\n    <string name=\"compulsory_email\">El email es obligatorio</string>\r\n    <string name=\"valid_email\">El formato del email no es v√°lido</string>\r\n    <string name=\"date_no_selected\">Se debe seleccionar una fecha</string>\r\n    <string name=\"hour_no_selected\">Se debe seleccionar una hora</string>\r\n    <string name=\"datepicker_ok\">Ok</string>\r\n    <string name=\"datepicker_cancel\">Cancelar</string>\r\n    <string name=\"confirm_button\">CONFIRMAR</string>\r\n    <string name=\"contentimage_confirmation\">Confirmado</string>\r\n    <string name=\"confirmation_appointment\">¬°CASI LISTO!</string>\r\n    <string name=\"details_appointment\">Tu solicitud de reserva est√° preparada. Por favor, pulsa \\'enviar\\' en la aplicaci√≥n de correo que se acaba de abrir para finalizar tu solicitud. Te responderemos a ese correo para confirmar la disponibilidad.</string>\r\n    <string name=\"email_subject\">Solicitud de Reserva de Vista - %1$s</string>\r\n    <string name=\"email_message\">Hola,\\n\\nMe gustar√≠a solicitar una reserva para una visita al monasterio con los siguientes datos:\\n\\n* Nombre: %1$s\\n* Email: %2$s\\n* Fecha de la visita: %3$s\\n* Hora de la visita: %4$s\\n\\nQuedo a la espera de su amable confirmaci√≥n.\\n\\nMuchas gracias,\\nAtentamente,\\n\\n%1$s</string>\r\n    <string name=\"email_error\">No se encontr√≥ ninguna app de correo</string>\r\n    <string name=\"history_content_placeholder\">Mauris vel nisi id metus vestibulum vehicula nec ac orci. Curabitur massa diam, fermentum sit amet augue sit, volutpat efficitur enim. Phasellus a cursus orci, id laoreet dolor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</string>\r\n    <string name=\"language_select\">Seleccionar Idioma</string>\r\n    <string name=\"font_size_select\">Selecciona el tama√±o de la letra</string>\r\n    <string name=\"font_extrabig\">Extra Grande</string>\r\n    <string name=\"font_normal\">Mediana</string>\r\n    <string name=\"font_big\">Grande</string>\r\n    <string name=\"title_monasterio\">Monasterio</string>\r\n    <string name=\"title_entrada\">Entrada Monasterio</string>\r\n    <string name=\"spanish_language\">Espa√±ol</string>\r\n    <string name=\"german_language\">Alem√°n</string>\r\n    <string name=\"english_language\">Ingl√©s</string>\r\n    <string name=\"navegation_button\">Ocultar botones de navegaci√≥n</string>\r\n    <string name=\"close\">Cerrar</string>\r\n    <string name=\"go_back\">Volver</string>\r\n    <string name=\"see_360\">Ver 360¬∫</string>\r\n    <string name=\"contentdescription_image_pin\">Imagen del pin (pulsar para ampliar)</string>\r\n    <string name=\"readjust\">Reajustar</string>\r\n    <string name=\"decrease\">Disminuir</string>\r\n    <string name=\"increase\">Aumentar</string>\r\n    <string name=\"out_interactive_area\">Fuera del √°rea interactiva</string>\r\n    <string name=\"notdefined_destiny\">Destino no definido</string>\r\n    <string name=\"notdefined_destinyplane\">Plano destino no definido</string>\r\n    <string name=\"plane_loading\">Cargando plano...</string>\r\n    <string name=\"error_loading_plane\">Error cargando datos del plano</string>\r\n    <string name=\"child_mode\">MODO NI√ëOS</string>\r\n    <string name=\"child_mode_view\">Modo Ni√±os</string>\r\n    <string name=\"video_view\">Video</string>\r\n    <string name=\"game_view\">Juegos</string>\r\n    <string name=\"video_child\">VIDEO</string>\r\n    <string name=\"game_child\">JUEGOS</string>\r\n    <string name=\"edit_mode\">MODO EDICI√ìN</string>\r\n    <string name=\"edit_home_background\">Edici√≥n fondo inicio</string>\r\n    <string name=\"edit_pins\">Edici√≥n pines</string>\r\n    <string name=\"location_error\">No se encontr√≥ una app para abrir la ubicaci√≥n.</string>\r\n    <string name=\"contact_data\">Datos de contacto</string>\r\n    <string name=\"location_data\">Ubicaci√≥n</string>\r\n    <string name=\"email_data\">Correo electr√≥nico</string>\r\n    <string name=\"phone_data\">Tel√©fono</string>\r\n    <string name=\"visit_schedule\">Horarios de Visita</string>\r\n    <string name=\"monday_to_friday\">Lunes a Viernes:</string>\r\n    <string name=\"four_pieces\">4 piezas</string>\r\n    <string name=\"nine_pieces\">9 piezas</string>\r\n    <string name=\"sixteen_pieces\">16 piezas</string>\r\n    <string name=\"twentyfive_pieces\">25 piezas</string>\r\n    <string name=\"three_pairs\">3 Parejas</string>\r\n    <string name=\"four_pairs\">4 Parejas</string>\r\n    <string name=\"five_pairs\">5 parejas</string>\r\n    <string name=\"six_pairs\">6 Parejas</string>\r\n    <string name=\"dont_show_again\">No volver a mostrar</string>\r\n    <string name=\"understand\">Entendido</string>\r\n    <string name=\"map_tutorial_body\">Este es el cuerpo del tutorial</string>\r\n    <string name=\"map_tutorial_title\">Este es el titulo del tutorial</string>\r\n    <string name=\"map_tutorial_body2\">Este es el cuerpo del tutorial del mapa 2</string>\r\n    <string name=\"map_tutorial_title2\">Este es el titulo del tutorial del mapa 2</string>\r\n    <string name=\"pin_tutorial_body\">Este es el cuerpo del tutorial del pin</string>\r\n    <string name=\"pine¬∫¬∫_tutorial_title\">Este es el titulo del tutorial del pin</string>\r\n    <string name=\"next\">Siguiente</string>\r\n    <string name=\"map_tutorial_body1\">En la parte superior izquierda, el s√≠mbolo (‚Üê) permite volver al inicio</string>\r\n    <string name=\"map_tutorial_body1_2\">Tocando en las zonas con color del mapa podemos entrar a las distintas partes visualizables</string>\r\n    <string name=\"map_tutorial_body1_3\">Adem√°s, los botones de la parte derecha te permiten ampliar el mapa, reducirlo o volver a su tama√±o   original</string>\r\n    <string name=\"submapa_1\">Tocando en el s√≠mbolo (‚Üê) podemos volver al mapa general</string>\r\n    <string name=\"submapa_2\">Tocando en los distintos pines podemos entrar a los puntos de inter√©s</string>\r\n    <string name=\"pin_1\">Pulsando en el s√≠mbolo (‚Üê), se puede volver al mapa</string>\r\n    <string name=\"pin_2\">Puedes desplazarte por las im√°genes o pulsar en ellas para ampliarlas</string>\r\n    <string name=\"pin_3\">Pulsando aqu√≠ puedes escuchar el audio del texto</string>\r\n    <string name=\"pin_4\">Para acceder a la vista 360 pulse este bot√≥n</string>\r\n    <string name=\"confirm_save_title\">¬øGuardar cambios?</string>\r\n    <string name=\"confirm_save_message\">¬øEst√°s seguro de que quieres guardar los cambios realizados?</string>\r\n    <string name=\"confirm_save_button\">Guardar</string>\r\n    <string name=\"confirm_cancel_button\">Cancelar</string>\r\n    <string name=\"edit_cancel_changes\">Cancelar</string>\r\n    <string name=\"profile_name\">Nombre</string>\r\n    <string name=\"image_add\">A√±adir imagen</string>\r\n    <string name=\"image_delete\">Borrar</string>\r\n    <string name=\"image_delete_confirm_title\">¬øBorrar imagen?</string>\r\n    <string name=\"image_delete_confirm_message\">¬øSeguro que quieres borrar la imagen?</string>\r\n    <string name=\"image_uploading\">Subiendo imagen...</string>\r\n    <string name=\"image_upload_success\">Imagen subida correctamente</string>\r\n    <string name=\"image_upload_error\">Error al subir la imagen</string>\r\n    <string name=\"image_select_error\">Error al cargar la imagen</string>\r\n    <string name=\"congratulations\">¬°Felicidades!</string>\r\n    <string name=\"message_game_completed\">¬°Has resuelto el juego! ¬øListo para el siguiente desaf√≠o?</string>\r\n    <string name=\"ready\">Listo</string>\r\n    <string name=\"original_image\">Ver imagen</string>\r\n    <string name=\"image_gallery_title\">Im√°genes</string>\r\n    <string name=\"visible\">Visibles</string>\r\n    <string name=\"hidden\">Ocultos</string>\r\n    <string name=\"lang_en\">Engish</string>\r\n    <string name=\"lang_es\">Espa√±ol</string>\r\n    <string name=\"sample_text\">Ejemplo</string>\r\n    <string name=\"lang_de\">Deutsch</string>\r\n    <string name=\"font_small\">Peque√±a</string>\r\n    <string name=\"font_medium\">Mediana</string>\r\n    <string name=\"font_large\">Grande</string>\r\n    <string name=\"puzzle_screen\">Puzle</string>\r\n    <string name=\"puzzle_option\">PUZLE</string>\r\n    <string name=\"memory_screen\">Parejas</string>\r\n    <string name=\"memory_option\">PAREJAS</string>\r\n    <string name=\"back_piece\">Parte de atr√°s de la pieza</string>\r\n    <string name=\"left_pairs\">Parejas restantes: %1$s</string>\r\n    <string name=\"left_pieces\">Piezas restantes: %1$s</string>\r\n\r\n    <string name=\"play_audio\"></string>\r\n    <!-- Gallery Types -->\r\n    <string name=\"gallery_type_all\">Todos</string>\r\n    <string name=\"gallery_type_painting\">Cuadros</string>\r\n    <string name=\"gallery_type_sculpture\">Esculturas</string>\r\n    <string name=\"gallery_type_architecture\">Arquitectura</string>\r\n    <string name=\"gallery_type_other\">Otros</string>\r\n</resources>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
--- a/app/src/main/res/values/strings.xml	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/res/values/strings.xml	(date 1764287615464)
@@ -1,3 +1,4 @@
+<?xml version="1.0" encoding="utf-8"?>
 <resources>
     <string name="app_name">Santa Mar√≠a la Real de Huelgas</string>
     <string name="title_inicio">Inicio</string>
@@ -151,10 +152,11 @@
     <string name="image_gallery_title">Im√°genes</string>
     <string name="visible">Visibles</string>
     <string name="hidden">Ocultos</string>
-    <string name="lang_en">Engish</string>
+    <string name="lang_en">English</string>
     <string name="lang_es">Espa√±ol</string>
     <string name="sample_text">Ejemplo</string>
     <string name="lang_de">Deutsch</string>
+    <string name="lang_fr">Fran√ßais</string>
     <string name="font_small">Peque√±a</string>
     <string name="font_medium">Mediana</string>
     <string name="font_large">Grande</string>
@@ -165,7 +167,8 @@
     <string name="back_piece">Parte de atr√°s de la pieza</string>
     <string name="left_pairs">Parejas restantes: %1$s</string>
     <string name="left_pieces">Piezas restantes: %1$s</string>
-
+    <string name="background_edit_screen">EDITAR FONDO</string>
+    <string name="pin_edit_screen">EDITAR PIN</string>
     <string name="play_audio"></string>
     <!-- Gallery Types -->
     <string name="gallery_type_all">Todos</string>
Index: app/src/main/java/com/nextapp/monasterio/ui/screens/AjustesScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.content.pm.ActivityInfo\r\nimport androidx.activity.compose.LocalActivity\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport androidx.compose.foundation.Image\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.border\r\nimport androidx.compose.foundation.clickable\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.rememberScrollState\r\nimport androidx.compose.foundation.shape.CircleShape\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.foundation.verticalScroll\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.draw.clip\r\nimport androidx.compose.ui.draw.rotate\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.platform.LocalConfiguration\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.text.font.FontWeight\r\nimport androidx.compose.ui.unit.dp\r\nimport com.nextapp.monasterio.LanguageHelper\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.utils.FontSize\r\nimport com.nextapp.monasterio.viewModels.AjustesViewModel\r\nimport java.util.Locale\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun AjustesScreen(viewModel: AjustesViewModel) {\r\n    val activity = LocalActivity.current as? AppCompatActivity ?: return\r\n    val botonesVisibles by viewModel.botonesVisibles.collectAsState()\r\n\r\n    // Configuraci√≥n actual para detectar idioma y fuente inicial\r\n    val configuration = LocalConfiguration.current\r\n    val currentLocale = configuration.locales[0]\r\n    val currentFontScale = configuration.fontScale\r\n\r\n    DisposableEffect(Unit) {\r\n        activity.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n        onDispose {}\r\n    }\r\n\r\n    Column(\r\n        modifier = Modifier\r\n            .fillMaxSize()\r\n            .background(MaterialTheme.colorScheme.background)\r\n            .verticalScroll(rememberScrollState())\r\n            .padding(16.dp),\r\n        horizontalAlignment = Alignment.CenterHorizontally\r\n    ) {\r\n\r\n        // ==========================================\r\n        // 1. SELECTOR DE IDIOMA\r\n        // ==========================================\r\n        SettingsSectionCard(title = stringResource(R.string.language_select)) {\r\n            LanguageSelector(activity, currentLocale)\r\n        }\r\n\r\n        Spacer(modifier = Modifier.height(24.dp))\r\n\r\n        // ==========================================\r\n        // 2. TAMA√ëO DE FUENTE (RADIO BUTTONS)\r\n        // ==========================================\r\n        SettingsSectionCard(title = stringResource(R.string.font_size_select)) {\r\n            // \uD83D\uDC47 Usamos el nuevo componente de Radio Buttons\r\n            FontSizeSelector(activity, currentFontScale)\r\n        }\r\n\r\n        Spacer(modifier = Modifier.height(24.dp))\r\n\r\n        // ==========================================\r\n        // 3. BOTONES DE NAVEGACI√ìN (SWITCH)\r\n        // ==========================================\r\n        SettingsSectionCard(title = stringResource(R.string.navegation_button)) {\r\n            Row(\r\n                modifier = Modifier\r\n                    .fillMaxWidth()\r\n                    .padding(vertical = 8.dp),\r\n                verticalAlignment = Alignment.CenterVertically,\r\n                horizontalArrangement = Arrangement.SpaceBetween\r\n            ) {\r\n                Text(\r\n                    text = if (botonesVisibles) stringResource(R.string.visible) else stringResource(R.string.hidden),\r\n                    style = MaterialTheme.typography.bodyLarge\r\n                )\r\n                Switch(\r\n                    checked = botonesVisibles,\r\n                    onCheckedChange = { viewModel.setBotonesVisibles(it) },\r\n                    colors = SwitchDefaults.colors(\r\n                        checkedThumbColor = MaterialTheme.colorScheme.primary,\r\n                        checkedTrackColor = MaterialTheme.colorScheme.primaryContainer\r\n                    )\r\n                )\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// --- COMPONENTE TARJETA ---\r\n@Composable\r\nfun SettingsSectionCard(title: String, content: @Composable () -> Unit) {\r\n    Card(\r\n        modifier = Modifier.fillMaxWidth(),\r\n        shape = RoundedCornerShape(16.dp),\r\n        elevation = CardDefaults.cardElevation(defaultElevation = 4.dp),\r\n        colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.surface)\r\n    ) {\r\n        Column(modifier = Modifier.padding(20.dp)) {\r\n            Text(\r\n                text = title,\r\n                style = MaterialTheme.typography.titleMedium,\r\n                fontWeight = FontWeight.Bold,\r\n                color = MaterialTheme.colorScheme.onSurface\r\n            )\r\n            Spacer(modifier = Modifier.height(16.dp))\r\n            content()\r\n        }\r\n    }\r\n}\r\n\r\n// --- COMPONENTE SELECTOR DE IDIOMA ---\r\n@Composable\r\nfun LanguageSelector(activity: AppCompatActivity, currentLocale: Locale) {\r\n    var expanded by remember { mutableStateOf(false) }\r\n    val languageCode = currentLocale.language\r\n\r\n    val currentFlag = when (languageCode) {\r\n        \"de\" -> R.drawable.alemania\r\n        \"en\" -> R.drawable.reinounido\r\n        else -> R.drawable.espanya\r\n    }\r\n\r\n    val currentName = when (languageCode) {\r\n        \"de\" -> stringResource(R.string.lang_de)\r\n        \"en\" -> stringResource(R.string.lang_en)\r\n        else -> stringResource(R.string.lang_es)\r\n    }\r\n\r\n    Box(modifier = Modifier.fillMaxWidth()) {\r\n        OutlinedButton(\r\n            onClick = { expanded = true },\r\n            modifier = Modifier.fillMaxWidth(),\r\n            shape = RoundedCornerShape(12.dp),\r\n            colors = ButtonDefaults.outlinedButtonColors(containerColor = Color.Transparent)\r\n        ) {\r\n            Row(\r\n                verticalAlignment = Alignment.CenterVertically,\r\n                horizontalArrangement = Arrangement.SpaceBetween,\r\n                modifier = Modifier.fillMaxWidth()\r\n            ) {\r\n                Row(verticalAlignment = Alignment.CenterVertically) {\r\n                    Image(\r\n                        painter = painterResource(id = currentFlag),\r\n                        contentDescription = null,\r\n                        modifier = Modifier.size(32.dp).clip(RoundedCornerShape(4.dp))\r\n                    )\r\n                    Spacer(modifier = Modifier.width(16.dp))\r\n                    Text(text = currentName, style = MaterialTheme.typography.bodyLarge, color = MaterialTheme.colorScheme.onSurface)\r\n                }\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.arrow_down),\r\n                    contentDescription = null,\r\n                    tint = MaterialTheme.colorScheme.onSurface,\r\n                    modifier = Modifier.rotate(if (expanded) 180f else 0f)\r\n                )\r\n            }\r\n        }\r\n\r\n        DropdownMenu(\r\n            expanded = expanded,\r\n            onDismissRequest = { expanded = false },\r\n            modifier = Modifier.fillMaxWidth(0.85f)\r\n        ) {\r\n            LanguageItem(activity, \"es\", stringResource(R.string.lang_es), R.drawable.espanya) { expanded = false }\r\n            LanguageItem(activity, \"en\", stringResource(R.string.lang_en), R.drawable.reinounido) { expanded = false }\r\n            LanguageItem(activity, \"de\", stringResource(R.string.lang_de), R.drawable.alemania) { expanded = false }\r\n        }\r\n    }\r\n}\r\n\r\n@Composable\r\nfun LanguageItem(\r\n    activity: AppCompatActivity,\r\n    code: String,\r\n    name: String,\r\n    flagRes: Int,\r\n    onDismiss: () -> Unit\r\n) {\r\n    DropdownMenuItem(\r\n        text = {\r\n            Row(verticalAlignment = Alignment.CenterVertically) {\r\n                Image(\r\n                    painter = painterResource(id = flagRes),\r\n                    contentDescription = null,\r\n                    modifier = Modifier.size(28.dp).clip(RoundedCornerShape(4.dp))\r\n                )\r\n                Spacer(modifier = Modifier.width(16.dp))\r\n                Text(text = name)\r\n            }\r\n        },\r\n        onClick = {\r\n            onDismiss()\r\n            val currentLanguage = activity.resources.configuration.locales[0].language\r\n            if (currentLanguage != code) {\r\n                LanguageHelper.saveLocale(activity, code)\r\n                activity.recreate()\r\n            }\r\n        }\r\n    )\r\n}\r\n\r\n// --- NUEVO SELECTOR VERTICAL (ROBUSTO Y CON DRAWABLES) ---\r\n@Composable\r\nfun FontSizeSelector(activity: AppCompatActivity, currentScale: Float) {\r\n\r\n    // 1. Definimos los tama√±os exactos\r\n    val sizeSmall = 1.2f\r\n    val sizeMedium = 1.5f\r\n    val sizeLarge = 1.7f\r\n\r\n    // 2. Estado de la opci√≥n seleccionada.\r\n    // Usamos 'rememberSaveable' para intentar mantener el estado si la recreaci√≥n es parcial,\r\n    // pero inicializamos bas√°ndonos en 'currentScale'.\r\n    var selectedOption by remember(currentScale) {\r\n        mutableIntStateOf(\r\n            when {\r\n                currentScale >= 1.65f -> 2 // Grande\r\n                currentScale >= 1.45f -> 1 // Mediana\r\n                else -> 0                  // Peque√±a\r\n            }\r\n        )\r\n    }\r\n\r\n    fun updateFontSize(newScale: Float, newOptionIndex: Int) {\r\n        // 1. Actualizamos la UI INMEDIATAMENTE para que el check cambie\r\n        selectedOption = newOptionIndex\r\n\r\n        // 2. Guardamos y recreamos\r\n        // (A√±adimos un peque√±o delay o comprobaci√≥n para no bloquear la UI visual)\r\n        if (kotlin.math.abs(newScale - currentScale) > 0.05f) {\r\n            FontSize.guardarFontScale(activity, newScale)\r\n\r\n            // Usamos un Handler para dar tiempo a que se pinte el check antes de reiniciar\r\n            android.os.Handler(android.os.Looper.getMainLooper()).postDelayed({\r\n                activity.recreate()\r\n            }, 150) // 150ms de espera visual\r\n        }\r\n    }\r\n\r\n    // 3. Dise√±o Vertical\r\n    Column(\r\n        modifier = Modifier.fillMaxWidth(),\r\n        verticalArrangement = Arrangement.spacedBy(12.dp)\r\n    ) {\r\n        // Opci√≥n 1: PEQUE√ëA\r\n        FontSizeOptionCard(\r\n            text = stringResource(R.string.font_small),\r\n            isSelected = (selectedOption == 0),\r\n            onClick = { updateFontSize(sizeSmall, 0) }\r\n        )\r\n\r\n        // Opci√≥n 2: MEDIANA\r\n        FontSizeOptionCard(\r\n            text = stringResource(R.string.font_medium),\r\n            isSelected = (selectedOption == 1),\r\n            onClick = { updateFontSize(sizeMedium, 1) }\r\n        )\r\n\r\n        // Opci√≥n 3: GRANDE\r\n        FontSizeOptionCard(\r\n            text = stringResource(R.string.font_large),\r\n            isSelected = (selectedOption == 2),\r\n            onClick = { updateFontSize(sizeLarge, 2) }\r\n        )\r\n    }\r\n}\r\n\r\n@Composable\r\nfun FontSizeOptionCard(\r\n    text: String,\r\n    isSelected: Boolean,\r\n    onClick: () -> Unit\r\n) {\r\n    // Colores din√°micos: Si est√° seleccionado, fondo coloreado y borde primario\r\n    val containerColor = if (isSelected) MaterialTheme.colorScheme.primaryContainer else MaterialTheme.colorScheme.surface\r\n    val borderColor = if (isSelected) MaterialTheme.colorScheme.primary else MaterialTheme.colorScheme.outlineVariant\r\n    val contentColor = if (isSelected) MaterialTheme.colorScheme.onPrimaryContainer else MaterialTheme.colorScheme.onSurface\r\n\r\n    // Grosor del borde: M√°s grueso si est√° seleccionado\r\n    val borderWidth = if (isSelected) 2.dp else 1.dp\r\n\r\n    Card(\r\n        modifier = Modifier\r\n            .fillMaxWidth()\r\n            .clickable { onClick() },\r\n        shape = RoundedCornerShape(12.dp),\r\n        colors = CardDefaults.cardColors(containerColor = containerColor),\r\n        border = androidx.compose.foundation.BorderStroke(borderWidth, borderColor)\r\n    ) {\r\n        Row(\r\n            modifier = Modifier\r\n                .fillMaxWidth()\r\n                .padding(16.dp),\r\n            verticalAlignment = Alignment.CenterVertically,\r\n            horizontalArrangement = Arrangement.SpaceBetween\r\n        ) {\r\n            // Texto de la opci√≥n\r\n            Text(\r\n                text = text,\r\n                style = MaterialTheme.typography.titleMedium,\r\n                fontWeight = if (isSelected) FontWeight.Bold else FontWeight.Normal,\r\n                color = contentColor\r\n            )\r\n\r\n            // Icono o Indicador\r\n            if (isSelected) {\r\n                // \uD83D\uDC47 AQU√ç DEBES ASEGURARTE DE TENER EL DRAWABLE 'check'\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.check),\r\n                    contentDescription = \"Selected\",\r\n                    tint = MaterialTheme.colorScheme.primary,\r\n                    modifier = Modifier.size(24.dp)\r\n                )\r\n            } else {\r\n                // C√≠rculo vac√≠o para simular radio button desmarcado\r\n                Box(\r\n                    modifier = Modifier\r\n                        .size(24.dp)\r\n                        .background(Color.Transparent, CircleShape)\r\n                        .border(2.dp, MaterialTheme.colorScheme.outline, CircleShape)\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/AjustesScreen.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/AjustesScreen.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/AjustesScreen.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/AjustesScreen.kt	(date 1764284262478)
@@ -133,12 +133,14 @@
     val currentFlag = when (languageCode) {
         "de" -> R.drawable.alemania
         "en" -> R.drawable.reinounido
+        "fr" -> R.drawable.francia
         else -> R.drawable.espanya
     }
 
     val currentName = when (languageCode) {
         "de" -> stringResource(R.string.lang_de)
         "en" -> stringResource(R.string.lang_en)
+        "fr" -> stringResource(R.string.lang_fr)
         else -> stringResource(R.string.lang_es)
     }
 
@@ -180,6 +182,7 @@
             LanguageItem(activity, "es", stringResource(R.string.lang_es), R.drawable.espanya) { expanded = false }
             LanguageItem(activity, "en", stringResource(R.string.lang_en), R.drawable.reinounido) { expanded = false }
             LanguageItem(activity, "de", stringResource(R.string.lang_de), R.drawable.alemania) { expanded = false }
+            LanguageItem(activity, "fr", stringResource(R.string.lang_fr), R.drawable.francia) { expanded = false }
         }
     }
 }
Index: app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesModoNi√±o.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport androidx.compose.foundation.Image\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.rememberScrollState\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.foundation.verticalScroll\r\nimport androidx.compose.material3.Button\r\nimport androidx.compose.material3.ButtonDefaults\r\nimport androidx.compose.material3.Icon\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.DisposableEffect\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.layout.ContentScale\r\nimport androidx.compose.ui.platform.LocalConfiguration\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport androidx.compose.ui.tooling.preview.Preview\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.unit.sp\r\nimport androidx.constraintlayout.compose.ConstraintLayout\r\nimport androidx.constraintlayout.compose.Dimension\r\nimport androidx.navigation.NavController\r\nimport androidx.navigation.compose.rememberNavController\r\nimport com.nextapp.monasterio.AppRoutes\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.ui.theme.MonasteryBlue\r\nimport com.nextapp.monasterio.ui.theme.MonasteryOrange\r\n\r\n\r\n@Composable\r\nfun OpcionesModoNi√±o(navController:NavController,modifier: Modifier = Modifier) {\r\n    val context = LocalContext.current\r\n\r\n    val activity = (context as? Activity)\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n\r\n        onDispose {\r\n\r\n        }\r\n    }\r\n\r\n    ConstraintLayout(modifier = modifier.fillMaxSize().background(Color.White).verticalScroll(rememberScrollState())) {\r\n        val (btnVideo,btnJuego) = createRefs()\r\n        val centerGuide = createGuidelineFromTop(0.5f)\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.VIDEO_NINYOS)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryOrange),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .constrainAs(btnVideo) {\r\n                    bottom.linkTo(centerGuide, margin = 24.dp)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            )  {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.youtube),\r\n                    contentDescription = null,\r\n                    modifier = Modifier\r\n                        .padding(end = 18.dp)\r\n                        .size(48.dp)\r\n                )\r\n                Text(\r\n                    stringResource(id = R.string.video_child),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.JUEGO_NINYOS)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .constrainAs(btnJuego) {\r\n                    top.linkTo(centerGuide, margin = 24.dp)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.console),\r\n                    contentDescription = null,\r\n                    modifier = Modifier\r\n                        .padding(end = 16.dp)\r\n                        .size(48.dp)\r\n\r\n                )\r\n                Text(\r\n                    stringResource(id = R.string.game_child),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesModoNi√±o.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesModoNi√±o.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesModoNi√±o.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/OpcionesModoNi√±o.kt	(date 1764284638616)
@@ -12,6 +12,7 @@
 import androidx.compose.material3.ButtonDefaults
 import androidx.compose.material3.Icon
 import androidx.compose.material3.Text
+import androidx.compose.material3.TextFieldDefaults.indicatorLine
 import androidx.compose.runtime.Composable
 import androidx.compose.runtime.DisposableEffect
 import androidx.compose.ui.Alignment
@@ -50,9 +51,25 @@
         }
     }
 
-    ConstraintLayout(modifier = modifier.fillMaxSize().background(Color.White).verticalScroll(rememberScrollState())) {
-        val (btnVideo,btnJuego) = createRefs()
+    ConstraintLayout(modifier = modifier.fillMaxSize().verticalScroll(rememberScrollState())) {
+        val (btnVideo,btnJuego,background) = createRefs()
         val centerGuide = createGuidelineFromTop(0.5f)
+
+        Image(
+            painter = painterResource(R.drawable.fondo),
+            contentDescription = "Fondo",
+            contentScale = ContentScale.Crop,
+            modifier = Modifier
+                .constrainAs(background){
+                    top.linkTo(parent.top)
+                    bottom.linkTo(parent.bottom)
+                    start.linkTo(parent.start)
+                    end.linkTo(parent.end)
+                    width = Dimension.fillToConstraints
+                    height = Dimension.fillToConstraints
+                }
+        )
+
         Button(
             onClick = {
                 navController.navigate(AppRoutes.VIDEO_NINYOS)
Index: app/src/main/java/com/nextapp/monasterio/ui/screens/VideoNinyos.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.layout.fillMaxSize\r\nimport androidx.compose.foundation.rememberScrollState\r\nimport androidx.compose.foundation.verticalScroll\r\nimport androidx.compose.material3.CircularProgressIndicator\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.DisposableEffect\r\nimport androidx.compose.runtime.getValue\r\nimport androidx.compose.runtime.mutableStateOf\r\nimport androidx.compose.runtime.remember\r\nimport androidx.compose.runtime.setValue\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.platform.LocalConfiguration\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.viewinterop.AndroidView\r\nimport androidx.constraintlayout.compose.ConstraintLayout\r\nimport androidx.constraintlayout.compose.Dimension\r\nimport androidx.core.net.toUri\r\nimport androidx.media3.exoplayer.ExoPlayer\r\nimport androidx.media3.common.MediaItem\r\nimport androidx.media3.common.Player\r\nimport androidx.media3.ui.PlayerView\r\n\r\n\r\n@Composable\r\nfun VideoNinyosScreen(modifier: Modifier = Modifier) {\r\n    val context = LocalContext.current\r\n\r\n    val activity = (context as? Activity)\r\n\r\n    val videoEspanyol = \"https://res.cloudinary.com/drx7mujrv/video/upload/f_auto,q_auto:low,w_auto:1000/v1763317610/videoespa%C3%B1ol_agayqb.mp4\"\r\n    val videoIngles = \"https://res.cloudinary.com/drx7mujrv/video/upload/f_auto,q_auto:low,w_auto:1000/v1763317613/videoingles_h8ejvc.mp4\"\r\n    val videoAleman = \"https://res.cloudinary.com/drx7mujrv/video/upload/f_auto,q_auto:low,w_auto:1000/v1763317621/videoaleman_x5he9w.mp4\"\r\n\r\n    var isLoading by remember { mutableStateOf(true) }\r\n\r\n    val configuration = LocalConfiguration.current\r\n    val language = configuration.locales[0].language\r\n\r\n    val exoPlayer = remember {\r\n        ExoPlayer.Builder(context).build().apply {\r\n           addListener(object : Player.Listener{\r\n               override fun onPlaybackStateChanged(playbackState: Int) {\r\n                   isLoading = when(playbackState){\r\n                        Player.STATE_BUFFERING -> true\r\n                        Player.STATE_READY -> false\r\n                        else -> false\r\n                   }\r\n               }\r\n           })\r\n            when(language){\r\n                \"es\" -> {\r\n                    setMediaItem(MediaItem.fromUri(videoEspanyol))\r\n                    prepare()\r\n                    playWhenReady = true\r\n                }\r\n                \"de\" -> {\r\n                    setMediaItem(MediaItem.fromUri(videoAleman))\r\n                    prepare()\r\n                    playWhenReady = true\r\n                }\r\n                else -> {\r\n                    setMediaItem(MediaItem.fromUri(videoIngles))\r\n                    prepare()\r\n                    playWhenReady = true\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n\r\n        onDispose {\r\n            exoPlayer.release()\r\n            activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n        }\r\n    }\r\n\r\n    ConstraintLayout(modifier = modifier.fillMaxSize().background(Color.Black)) {\r\n        val(videoPlayer,loadingSpinner) = createRefs()\r\n\r\n        AndroidView(\r\n            factory = {\r\n                PlayerView(context).apply {\r\n                    player = exoPlayer\r\n                    useController = true\r\n                }\r\n            },\r\n            modifier = Modifier\r\n                .constrainAs(videoPlayer){\r\n                    top.linkTo(parent.top)\r\n                    bottom.linkTo(parent.bottom)\r\n                    start.linkTo(parent.start)\r\n                    end.linkTo(parent.end)\r\n                    width = Dimension.fillToConstraints\r\n                    height = Dimension.fillToConstraints\r\n                }\r\n        )\r\n\r\n        if (isLoading) {\r\n            CircularProgressIndicator(\r\n                modifier = Modifier.constrainAs(loadingSpinner) {\r\n                    // Lo centramos encima del reproductor\r\n                    top.linkTo(videoPlayer.top)\r\n                    bottom.linkTo(videoPlayer.bottom)\r\n                    start.linkTo(videoPlayer.start)\r\n                    end.linkTo(videoPlayer.end)\r\n                }\r\n            )\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/VideoNinyos.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/VideoNinyos.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/VideoNinyos.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/VideoNinyos.kt	(date 1764284128990)
@@ -37,6 +37,7 @@
     val videoEspanyol = "https://res.cloudinary.com/drx7mujrv/video/upload/f_auto,q_auto:low,w_auto:1000/v1763317610/videoespa%C3%B1ol_agayqb.mp4"
     val videoIngles = "https://res.cloudinary.com/drx7mujrv/video/upload/f_auto,q_auto:low,w_auto:1000/v1763317613/videoingles_h8ejvc.mp4"
     val videoAleman = "https://res.cloudinary.com/drx7mujrv/video/upload/f_auto,q_auto:low,w_auto:1000/v1763317621/videoaleman_x5he9w.mp4"
+    val videoFrances = "https://res.cloudinary.com/drx7mujrv/video/upload/f_auto,q_auto:low,w_auto:1000/v1764283280/videofrances_rszxyk.mp4"
 
     var isLoading by remember { mutableStateOf(true) }
 
@@ -64,6 +65,11 @@
                     setMediaItem(MediaItem.fromUri(videoAleman))
                     prepare()
                     playWhenReady = true
+                }
+                "fr" -> {
+                    setMediaItem(MediaItem.fromUri(videoFrances))
+                    prepare()
+                    playWhenReady = true
                 }
                 else -> {
                     setMediaItem(MediaItem.fromUri(videoIngles))
Index: app/src/main/java/com/nextapp/monasterio/ui/screens/pinEdition/EdicionFondoInicio.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.screens.pinEdition\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport android.net.Uri\r\nimport android.widget.Toast\r\nimport androidx.activity.compose.rememberLauncherForActivityResult\r\nimport androidx.activity.result.contract.ActivityResultContracts\r\nimport androidx.compose.animation.AnimatedVisibility\r\nimport androidx.compose.animation.fadeIn\r\nimport androidx.compose.animation.fadeOut\r\nimport androidx.compose.foundation.Image\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.rememberScrollState\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.foundation.verticalScroll\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.layout.ContentScale\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.unit.sp\r\nimport androidx.compose.ui.zIndex\r\nimport androidx.constraintlayout.compose.ConstraintLayout\r\nimport androidx.constraintlayout.compose.Dimension\r\nimport androidx.navigation.NavController\r\nimport coil.compose.AsyncImage\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.data.ImagenRepository\r\nimport com.nextapp.monasterio.services.CloudinaryService\r\nimport com.nextapp.monasterio.ui.theme.MonasteryBlue\r\nimport com.nextapp.monasterio.ui.theme.MonasteryOrange\r\nimport kotlinx.coroutines.launch\r\n\r\n// COLORES\r\nval EditModePurple = Color(0xFF9C27B0)\r\nval RedTopBar = Color(0xFFC00000)\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun EdicionFondoTopBar() {\r\n    // \uD83D\uDCA1 PASO 1: Usamos CenterAlignedTopAppBar para centrar el t√≠tulo y mantener la altura est√°ndar (56.dp)\r\n    CenterAlignedTopAppBar(\r\n        title = {\r\n            // \uD83D\uDCA1 PASO 2: Quitamos el Box con fillMaxWidth() y Alignment.Center, ya que CenterAlignedTopAppBar se encarga de esto.\r\n            Text(\r\n                text = stringResource(id = R.string.title_inicio),\r\n                color = Color.White\r\n            )\r\n        },\r\n        colors = TopAppBarDefaults.topAppBarColors(\r\n            containerColor = RedTopBar,\r\n            scrolledContainerColor = RedTopBar,\r\n            titleContentColor = Color.White,\r\n            actionIconContentColor = Color.White,\r\n            navigationIconContentColor = Color.White\r\n        ),\r\n        navigationIcon = {\r\n            IconButton(onClick = { /* No hace nada */ }) {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.ic_menu_24),\r\n                    contentDescription = \"Menu\",\r\n                    tint = Color.White\r\n                )\r\n            }\r\n        },\r\n        actions = {\r\n            IconButton(onClick = { /* No hace nada */ }) {\r\n                Image(\r\n                    painter = painterResource(id = R.drawable.espanya),\r\n                    contentDescription = \"Cambiar Idioma\",\r\n                    modifier = Modifier.size(24.dp)\r\n                )\r\n            }\r\n        }\r\n    )\r\n}\r\n\r\n@Composable\r\nfun EdicionFondoInicio(navController: NavController) {\r\n    val context = LocalContext.current\r\n    val activity = (context as? Activity)\r\n    val repo = ImagenRepository()\r\n    val coroutineScope = rememberCoroutineScope()\r\n\r\n    // \uD83D\uDCA1 SOLUCI√ìN: Declaramos todos los estados al inicio de la funci√≥n.\r\n    var imagenFondoInicio by remember { mutableStateOf<String?>(null) }\r\n    var selectedImageUri by remember { mutableStateOf<Uri?>(null) }\r\n    var currentSavedImageUrl by remember { mutableStateOf<String?>(null) } // AHORA DISPONIBLE\r\n    var isUploading by remember { mutableStateOf(false)}\r\n    var showConfirmationToast by remember { mutableStateOf(false) }\r\n\r\n\r\n    LaunchedEffect(Unit) {\r\n        val data = repo.getImagenFondoInicio()\r\n        // Ahora podemos asignar el valor sin error\r\n        imagenFondoInicio = data?.url\r\n        currentSavedImageUrl = data?.url\r\n    }\r\n\r\n    // El LaunchedEffect para el Toast tambi√©n funciona aqu√≠\r\n    LaunchedEffect(showConfirmationToast) {\r\n        if (showConfirmationToast) {\r\n            Toast.makeText(context, \"Imagen de fondo actualizada\", Toast.LENGTH_LONG).show()\r\n            showConfirmationToast = false\r\n        }\r\n    }\r\n\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT\r\n        onDispose { }\r\n    }\r\n\r\n    Scaffold(\r\n        topBar = { EdicionFondoTopBar() },\r\n        modifier = Modifier.fillMaxSize()\r\n    ) { paddingValues ->\r\n\r\n        // Indicador de carga lineal (como acordamos)\r\n        if (isUploading) {\r\n            LinearProgressIndicator(\r\n                modifier = Modifier\r\n                    .fillMaxWidth()\r\n                    .offset(y = paddingValues.calculateTopPadding())\r\n                    .zIndex(1f),\r\n                color = MonasteryBlue\r\n            )\r\n        }\r\n\r\n\r\n        ConstraintLayout(\r\n            modifier = Modifier\r\n                .fillMaxSize()\r\n                .padding(top = paddingValues.calculateTopPadding())\r\n                .verticalScroll(rememberScrollState())\r\n        ) {\r\n            val (background, crest, btnsContainer, actionControls) = createRefs()\r\n\r\n            val backgroundModifier = Modifier.constrainAs(background) {\r\n                top.linkTo(parent.top)\r\n                bottom.linkTo(parent.bottom)\r\n                start.linkTo(parent.start)\r\n                end.linkTo(parent.end)\r\n                width = Dimension.fillToConstraints\r\n                height = Dimension.fillToConstraints\r\n            }\r\n\r\n            // ‚ùå Eliminado el bloque ESTADO redundante que causaba la confusi√≥n\r\n            // Las variables de estado ahora vienen de la parte superior de la funci√≥n.\r\n\r\n            val backgroundUriToDisplay = selectedImageUri\r\n                ?: currentSavedImageUrl?.let { Uri.parse(it) }\r\n                ?: imagenFondoInicio?.let { Uri.parse(it) }\r\n\r\n\r\n            val imagePickerLauncher = rememberLauncherForActivityResult(\r\n                contract = ActivityResultContracts.GetContent()\r\n            ) { uri: Uri? ->\r\n                selectedImageUri = uri\r\n            }\r\n\r\n            // Mostrar fondo\r\n            when (backgroundUriToDisplay) {\r\n                is Uri -> {\r\n                    AsyncImage(\r\n                        model = backgroundUriToDisplay,\r\n                        contentDescription = \"Fondo personalizado\",\r\n                        contentScale = ContentScale.Crop,\r\n                        modifier = backgroundModifier\r\n                    )\r\n                }\r\n\r\n                else -> {\r\n                    // fallback si no hay URI seleccionada ni guardada\r\n                    Image(\r\n                        painter = painterResource(id = R.drawable.monastery_background),\r\n                        contentDescription = null,\r\n                        contentScale = ContentScale.Crop,\r\n                        modifier = backgroundModifier\r\n                    )\r\n                }\r\n            }\r\n\r\n            // LOGO SUPERIOR\r\n            Image(\r\n                painter = painterResource(id = R.drawable.huelgas_inicio),\r\n                contentDescription = \"Escudo\",\r\n                contentScale = ContentScale.FillWidth,\r\n                modifier = Modifier.constrainAs(crest) {\r\n                    top.linkTo(parent.top, margin = 24.dp)\r\n                    start.linkTo(parent.start)\r\n                    end.linkTo(parent.end)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n            )\r\n\r\n            // SOLO EL BOT√ìN MORADO \"Cambiar fondo\"\r\n            if (selectedImageUri == null) Column(\r\n                modifier = Modifier.constrainAs(btnsContainer) {\r\n                    bottom.linkTo(parent.bottom, margin = 160.dp)\r\n                    start.linkTo(parent.start, margin = 20.dp)\r\n                    end.linkTo(parent.end, margin = 20.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n                ,\r\n                verticalArrangement = Arrangement.spacedBy(32.dp)\r\n            ) {\r\n                Button(\r\n                    onClick = {\r\n                        if (selectedImageUri == null) {\r\n                            imagePickerLauncher.launch(\"image/*\")\r\n                        } else {\r\n                            selectedImageUri = null\r\n                        }\r\n                    },\r\n                    colors = ButtonDefaults.buttonColors(containerColor = EditModePurple),\r\n                    shape = RoundedCornerShape(20.dp),\r\n                    modifier = Modifier.fillMaxWidth()\r\n                ) {\r\n                    Row(\r\n                        modifier = Modifier.fillMaxWidth(),\r\n                        verticalAlignment = Alignment.CenterVertically,\r\n                        horizontalArrangement = Arrangement.Start\r\n                    ) {\r\n                        Icon(\r\n                            painter = painterResource(id = R.drawable.lapiz),\r\n                            contentDescription = null,\r\n                            modifier = Modifier.padding(end = 16.dp).size(48.dp)\r\n                        )\r\n\r\n                        Spacer(modifier = Modifier.weight(1f))\r\n\r\n                        Text(\r\n                            \"Cambiar fondo\",\r\n                            fontSize = 22.sp,\r\n                            textAlign = TextAlign.Center\r\n                        )\r\n\r\n                        Spacer(modifier = Modifier.width(64.dp).weight(1f))\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (selectedImageUri != null) Column(\r\n                modifier = Modifier.constrainAs(btnsContainer) {\r\n                    bottom.linkTo(parent.bottom, margin = 160.dp)\r\n                    start.linkTo(parent.start, margin = 20.dp)\r\n                    end.linkTo(parent.end, margin = 20.dp)\r\n                    width = Dimension.fillToConstraints\r\n                },\r\n                verticalArrangement = Arrangement.spacedBy(32.dp)\r\n            ) {\r\n\r\n                // \uD83D\uDD36 VISITA VIRTUAL\r\n                Button(\r\n                    onClick = { /* inactivo */ },\r\n                    colors = ButtonDefaults.buttonColors(containerColor = MonasteryOrange),\r\n                    shape = RoundedCornerShape(20.dp),\r\n                    modifier = Modifier.fillMaxWidth()\r\n                ) {\r\n                    Row(\r\n                        modifier=Modifier.fillMaxWidth(),\r\n                        verticalAlignment = Alignment.CenterVertically,\r\n                        horizontalArrangement = Arrangement.Start\r\n                    )  {\r\n                        Icon(\r\n                            painter = painterResource(id = R.drawable.ic_map_24),\r\n                            contentDescription = null,\r\n                            modifier = Modifier\r\n                                .padding(end = 16.dp)\r\n                                .size(48.dp)\r\n                        )\r\n                        Spacer(modifier = Modifier.weight(1f))\r\n                        Text(\r\n                            stringResource(id = R.string.virtual_visit),\r\n                            fontSize = 22.sp,\r\n                            textAlign = TextAlign.Center\r\n                        )\r\n                        Spacer(modifier = Modifier.width(64.dp).weight(1f))\r\n                    }\r\n                }\r\n\r\n                // \uD83D\uDFE9 MODO NI√ëOS\r\n                Button(\r\n                    onClick = { /* inactivo */ },\r\n                    colors = ButtonDefaults.buttonColors(containerColor = Color(0xFF6EB017)),\r\n                    shape = RoundedCornerShape(20.dp),\r\n                    modifier = Modifier.fillMaxWidth()\r\n                ) {\r\n                    Row(\r\n                        modifier=Modifier.fillMaxWidth(),\r\n                        verticalAlignment = Alignment.CenterVertically,\r\n                        horizontalArrangement = Arrangement.Start\r\n                    )  {\r\n                        Icon(\r\n                            painter = painterResource(id = R.drawable.outline_account_child_invert_24),\r\n                            contentDescription = null,\r\n                            modifier = Modifier\r\n                                .padding(end = 16.dp)\r\n                                .size(48.dp)\r\n                        )\r\n                        Spacer(modifier = Modifier.weight(1f))\r\n                        Text(\r\n                            stringResource(id = R.string.child_mode),\r\n                            fontSize = 22.sp,\r\n                            textAlign = TextAlign.Center\r\n                        )\r\n                        Spacer(modifier = Modifier.width(64.dp).weight(1f))\r\n                    }\r\n                }\r\n\r\n                // \uD83D\uDD35 RESERVA\r\n                Button(\r\n                    onClick = { /* inactivo */ },\r\n                    colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n                    shape = RoundedCornerShape(20.dp),\r\n                    modifier = Modifier.fillMaxWidth()\r\n                ) {\r\n                    Row(\r\n                        modifier=Modifier.fillMaxWidth(),\r\n                        verticalAlignment = Alignment.CenterVertically,\r\n                        horizontalArrangement = Arrangement.Start\r\n                    ) {\r\n                        Icon(\r\n                            painter = painterResource(id = R.drawable.ic_time_24),\r\n                            contentDescription = null,\r\n                            modifier = Modifier\r\n                                .padding(end = 16.dp)\r\n                                .size(48.dp)\r\n\r\n                        )\r\n                        Spacer(modifier = Modifier.weight(1f))\r\n                        Text(\r\n                            stringResource(id = R.string.book_appointment),\r\n                            fontSize = 22.sp,\r\n                            textAlign = TextAlign.Center,\r\n                        )\r\n                        Spacer(modifier = Modifier.width(64.dp).weight(1f))\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            // BARRA DE ACCI√ìN INFERIOR (Confirmar / Cancelar)\r\n            AnimatedVisibility(\r\n                visible = selectedImageUri != null && !isUploading,\r\n                enter = fadeIn(),\r\n                exit = fadeOut(),\r\n                modifier = Modifier.constrainAs(actionControls) {\r\n                    bottom.linkTo(parent.bottom)\r\n                    start.linkTo(parent.start)\r\n                    end.linkTo(parent.end)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n            ) {\r\n                ActionControlBar(\r\n                    onConfirm = {\r\n                        coroutineScope.launch {\r\n                            isUploading = true\r\n                            val result = CloudinaryService.uploadImage(selectedImageUri!!, context)\r\n\r\n                            result.onSuccess { url ->\r\n                                repo.updateImagenFondoInicio(url)\r\n                                currentSavedImageUrl = url\r\n                                selectedImageUri = null\r\n                                showConfirmationToast = true // \uD83D\uDFE2 Mostrar Toast de √©xito\r\n                            }\r\n\r\n                            result.onFailure {\r\n                                Toast.makeText(context, \"Error subiendo la imagen\", Toast.LENGTH_LONG).show()\r\n                            }\r\n\r\n                            isUploading = false // \uD83D\uDD34 FINALIZA LA CARGA\r\n                        }\r\n                    }\r\n                    ,\r\n                    onCancel = {\r\n                        selectedImageUri = null\r\n                    }\r\n                )\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// BOTONES INFERIORES RED / GREEN\r\n@Composable\r\nfun ActionControlBar(\r\n    onConfirm: () -> Unit,\r\n    onCancel: () -> Unit,\r\n) {\r\n    Row(\r\n        modifier = Modifier\r\n            .fillMaxWidth()\r\n            .background(Color.Black.copy(alpha = 0.8f))\r\n            .padding(16.dp),\r\n        horizontalArrangement = Arrangement.SpaceAround,\r\n        verticalAlignment = Alignment.CenterVertically\r\n    ) {\r\n        // \uD83D\uDD34 CANCELAR\r\n        Button(\r\n            onClick = onCancel,\r\n            colors = ButtonDefaults.buttonColors(containerColor = Color.Red.copy(alpha = 0.8f)),\r\n            shape = RoundedCornerShape(50),\r\n            modifier = Modifier.weight(1f).padding(horizontal = 8.dp)\r\n        ) {\r\n\r\n            Spacer(Modifier.width(4.dp))\r\n            Text(\"Cancelar\", color = Color.White)\r\n        }\r\n\r\n        // \uD83D\uDFE2 CONFIRMAR (MISMO TAMA√ëO)\r\n        Button(\r\n            onClick = onConfirm,\r\n            colors = ButtonDefaults.buttonColors(containerColor = Color.Green.copy(alpha = 0.8f)),\r\n            shape = RoundedCornerShape(50),\r\n            modifier = Modifier.weight(1f).padding(horizontal = 8.dp)\r\n        ) {\r\n\r\n            Spacer(Modifier.width(4.dp))\r\n            Text(\"Confirmar\", color = Color.White)\r\n        }\r\n    }\r\n}\r\n\r\n// ‚ùå Se elimina la funci√≥n FullScreenLoadingDialog()
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/pinEdition/EdicionFondoInicio.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/pinEdition/EdicionFondoInicio.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/pinEdition/EdicionFondoInicio.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/pinEdition/EdicionFondoInicio.kt	(date 1764286859517)
@@ -38,51 +38,13 @@
 import com.nextapp.monasterio.ui.theme.MonasteryBlue
 import com.nextapp.monasterio.ui.theme.MonasteryOrange
 import kotlinx.coroutines.launch
+import com.nextapp.monasterio.ui.screens.pinEdition.components.AppStatus
 
 // COLORES
 val EditModePurple = Color(0xFF9C27B0)
 val RedTopBar = Color(0xFFC00000)
 
 @OptIn(ExperimentalMaterial3Api::class)
-@Composable
-fun EdicionFondoTopBar() {
-    // üí° PASO 1: Usamos CenterAlignedTopAppBar para centrar el t√≠tulo y mantener la altura est√°ndar (56.dp)
-    CenterAlignedTopAppBar(
-        title = {
-            // üí° PASO 2: Quitamos el Box con fillMaxWidth() y Alignment.Center, ya que CenterAlignedTopAppBar se encarga de esto.
-            Text(
-                text = stringResource(id = R.string.title_inicio),
-                color = Color.White
-            )
-        },
-        colors = TopAppBarDefaults.topAppBarColors(
-            containerColor = RedTopBar,
-            scrolledContainerColor = RedTopBar,
-            titleContentColor = Color.White,
-            actionIconContentColor = Color.White,
-            navigationIconContentColor = Color.White
-        ),
-        navigationIcon = {
-            IconButton(onClick = { /* No hace nada */ }) {
-                Icon(
-                    painter = painterResource(id = R.drawable.ic_menu_24),
-                    contentDescription = "Menu",
-                    tint = Color.White
-                )
-            }
-        },
-        actions = {
-            IconButton(onClick = { /* No hace nada */ }) {
-                Image(
-                    painter = painterResource(id = R.drawable.espanya),
-                    contentDescription = "Cambiar Idioma",
-                    modifier = Modifier.size(24.dp)
-                )
-            }
-        }
-    )
-}
-
 @Composable
 fun EdicionFondoInicio(navController: NavController) {
     val context = LocalContext.current
@@ -94,7 +56,7 @@
     var imagenFondoInicio by remember { mutableStateOf<String?>(null) }
     var selectedImageUri by remember { mutableStateOf<Uri?>(null) }
     var currentSavedImageUrl by remember { mutableStateOf<String?>(null) } // AHORA DISPONIBLE
-    var isUploading by remember { mutableStateOf(false)}
+    val isUploading by AppStatus.isUploading.collectAsState()
     var showConfirmationToast by remember { mutableStateOf(false) }
 
 
@@ -118,275 +80,255 @@
         activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT
         onDispose { }
     }
-
-    Scaffold(
-        topBar = { EdicionFondoTopBar() },
-        modifier = Modifier.fillMaxSize()
-    ) { paddingValues ->
-
-        // Indicador de carga lineal (como acordamos)
-        if (isUploading) {
-            LinearProgressIndicator(
-                modifier = Modifier
-                    .fillMaxWidth()
-                    .offset(y = paddingValues.calculateTopPadding())
-                    .zIndex(1f),
-                color = MonasteryBlue
-            )
-        }
-
-
-        ConstraintLayout(
-            modifier = Modifier
-                .fillMaxSize()
-                .padding(top = paddingValues.calculateTopPadding())
-                .verticalScroll(rememberScrollState())
-        ) {
-            val (background, crest, btnsContainer, actionControls) = createRefs()
+    ConstraintLayout(
+        modifier = Modifier
+            .fillMaxSize()
+            .verticalScroll(rememberScrollState())
+    ) {
+        val (background, crest, btnsContainer, actionControls) = createRefs()
 
-            val backgroundModifier = Modifier.constrainAs(background) {
-                top.linkTo(parent.top)
-                bottom.linkTo(parent.bottom)
-                start.linkTo(parent.start)
-                end.linkTo(parent.end)
-                width = Dimension.fillToConstraints
-                height = Dimension.fillToConstraints
-            }
+        val backgroundModifier = Modifier.constrainAs(background) {
+            top.linkTo(parent.top)
+            bottom.linkTo(parent.bottom)
+            start.linkTo(parent.start)
+            end.linkTo(parent.end)
+            width = Dimension.fillToConstraints
+            height = Dimension.fillToConstraints
+        }
 
-            // ‚ùå Eliminado el bloque ESTADO redundante que causaba la confusi√≥n
-            // Las variables de estado ahora vienen de la parte superior de la funci√≥n.
+        // ‚ùå Eliminado el bloque ESTADO redundante que causaba la confusi√≥n
+        // Las variables de estado ahora vienen de la parte superior de la funci√≥n.
 
-            val backgroundUriToDisplay = selectedImageUri
-                ?: currentSavedImageUrl?.let { Uri.parse(it) }
-                ?: imagenFondoInicio?.let { Uri.parse(it) }
+        val backgroundUriToDisplay = selectedImageUri
+            ?: currentSavedImageUrl?.let { Uri.parse(it) }
+            ?: imagenFondoInicio?.let { Uri.parse(it) }
 
 
-            val imagePickerLauncher = rememberLauncherForActivityResult(
-                contract = ActivityResultContracts.GetContent()
-            ) { uri: Uri? ->
-                selectedImageUri = uri
-            }
+        val imagePickerLauncher = rememberLauncherForActivityResult(
+            contract = ActivityResultContracts.GetContent()
+        ) { uri: Uri? ->
+            selectedImageUri = uri
+        }
 
-            // Mostrar fondo
-            when (backgroundUriToDisplay) {
-                is Uri -> {
-                    AsyncImage(
-                        model = backgroundUriToDisplay,
-                        contentDescription = "Fondo personalizado",
-                        contentScale = ContentScale.Crop,
-                        modifier = backgroundModifier
-                    )
-                }
+        // Mostrar fondo
+        when (backgroundUriToDisplay) {
+            is Uri -> {
+                AsyncImage(
+                    model = backgroundUriToDisplay,
+                    contentDescription = "Fondo personalizado",
+                    contentScale = ContentScale.Crop,
+                    modifier = backgroundModifier
+                )
+            }
 
-                else -> {
-                    // fallback si no hay URI seleccionada ni guardada
-                    Image(
-                        painter = painterResource(id = R.drawable.monastery_background),
-                        contentDescription = null,
-                        contentScale = ContentScale.Crop,
-                        modifier = backgroundModifier
-                    )
-                }
-            }
+            else -> {
+                // fallback si no hay URI seleccionada ni guardada
+                Image(
+                    painter = painterResource(id = R.drawable.monastery_background),
+                    contentDescription = null,
+                    contentScale = ContentScale.Crop,
+                    modifier = backgroundModifier
+                )
+            }
+        }
 
-            // LOGO SUPERIOR
-            Image(
-                painter = painterResource(id = R.drawable.huelgas_inicio),
-                contentDescription = "Escudo",
-                contentScale = ContentScale.FillWidth,
-                modifier = Modifier.constrainAs(crest) {
-                    top.linkTo(parent.top, margin = 24.dp)
-                    start.linkTo(parent.start)
-                    end.linkTo(parent.end)
-                    width = Dimension.fillToConstraints
-                }
-            )
+        // LOGO SUPERIOR
+        Image(
+            painter = painterResource(id = R.drawable.huelgas_inicio),
+            contentDescription = "Escudo",
+            contentScale = ContentScale.FillWidth,
+            modifier = Modifier.constrainAs(crest) {
+                top.linkTo(parent.top, margin = 24.dp)
+                start.linkTo(parent.start)
+                end.linkTo(parent.end)
+                width = Dimension.fillToConstraints
+            }
+        )
 
-            // SOLO EL BOT√ìN MORADO "Cambiar fondo"
-            if (selectedImageUri == null) Column(
-                modifier = Modifier.constrainAs(btnsContainer) {
-                    bottom.linkTo(parent.bottom, margin = 160.dp)
-                    start.linkTo(parent.start, margin = 20.dp)
-                    end.linkTo(parent.end, margin = 20.dp)
-                    width = Dimension.fillToConstraints
-                }
-                ,
-                verticalArrangement = Arrangement.spacedBy(32.dp)
-            ) {
-                Button(
-                    onClick = {
-                        if (selectedImageUri == null) {
-                            imagePickerLauncher.launch("image/*")
-                        } else {
-                            selectedImageUri = null
-                        }
-                    },
-                    colors = ButtonDefaults.buttonColors(containerColor = EditModePurple),
-                    shape = RoundedCornerShape(20.dp),
-                    modifier = Modifier.fillMaxWidth()
-                ) {
-                    Row(
-                        modifier = Modifier.fillMaxWidth(),
-                        verticalAlignment = Alignment.CenterVertically,
-                        horizontalArrangement = Arrangement.Start
-                    ) {
-                        Icon(
-                            painter = painterResource(id = R.drawable.lapiz),
-                            contentDescription = null,
-                            modifier = Modifier.padding(end = 16.dp).size(48.dp)
-                        )
+        // SOLO EL BOT√ìN MORADO "Cambiar fondo"
+        if (selectedImageUri == null) Column(
+            modifier = Modifier.constrainAs(btnsContainer) {
+                bottom.linkTo(parent.bottom, margin = 160.dp)
+                start.linkTo(parent.start, margin = 20.dp)
+                end.linkTo(parent.end, margin = 20.dp)
+                width = Dimension.fillToConstraints
+            }
+            ,
+            verticalArrangement = Arrangement.spacedBy(32.dp)
+        ) {
+            Button(
+                onClick = {
+                    if (selectedImageUri == null) {
+                        imagePickerLauncher.launch("image/*")
+                    } else {
+                        selectedImageUri = null
+                    }
+                },
+                colors = ButtonDefaults.buttonColors(containerColor = EditModePurple),
+                shape = RoundedCornerShape(20.dp),
+                modifier = Modifier.fillMaxWidth()
+            ) {
+                Row(
+                    modifier = Modifier.fillMaxWidth(),
+                    verticalAlignment = Alignment.CenterVertically,
+                    horizontalArrangement = Arrangement.Start
+                ) {
+                    Icon(
+                        painter = painterResource(id = R.drawable.lapiz),
+                        contentDescription = null,
+                        modifier = Modifier.padding(end = 16.dp).size(48.dp)
+                    )
 
-                        Spacer(modifier = Modifier.weight(1f))
+                    Spacer(modifier = Modifier.weight(1f))
 
-                        Text(
-                            "Cambiar fondo",
-                            fontSize = 22.sp,
-                            textAlign = TextAlign.Center
-                        )
+                    Text(
+                        "Cambiar fondo",
+                        fontSize = 22.sp,
+                        textAlign = TextAlign.Center
+                    )
 
-                        Spacer(modifier = Modifier.width(64.dp).weight(1f))
-                    }
-                }
-            }
+                    Spacer(modifier = Modifier.width(64.dp).weight(1f))
+                }
+            }
+        }
 
-            if (selectedImageUri != null) Column(
-                modifier = Modifier.constrainAs(btnsContainer) {
-                    bottom.linkTo(parent.bottom, margin = 160.dp)
-                    start.linkTo(parent.start, margin = 20.dp)
-                    end.linkTo(parent.end, margin = 20.dp)
-                    width = Dimension.fillToConstraints
-                },
-                verticalArrangement = Arrangement.spacedBy(32.dp)
-            ) {
+        if (selectedImageUri != null) Column(
+            modifier = Modifier.constrainAs(btnsContainer) {
+                bottom.linkTo(parent.bottom, margin = 160.dp)
+                start.linkTo(parent.start, margin = 20.dp)
+                end.linkTo(parent.end, margin = 20.dp)
+                width = Dimension.fillToConstraints
+            },
+            verticalArrangement = Arrangement.spacedBy(32.dp)
+        ) {
 
-                // üî∂ VISITA VIRTUAL
-                Button(
-                    onClick = { /* inactivo */ },
-                    colors = ButtonDefaults.buttonColors(containerColor = MonasteryOrange),
-                    shape = RoundedCornerShape(20.dp),
-                    modifier = Modifier.fillMaxWidth()
-                ) {
-                    Row(
-                        modifier=Modifier.fillMaxWidth(),
-                        verticalAlignment = Alignment.CenterVertically,
-                        horizontalArrangement = Arrangement.Start
-                    )  {
-                        Icon(
-                            painter = painterResource(id = R.drawable.ic_map_24),
-                            contentDescription = null,
-                            modifier = Modifier
-                                .padding(end = 16.dp)
-                                .size(48.dp)
-                        )
-                        Spacer(modifier = Modifier.weight(1f))
-                        Text(
-                            stringResource(id = R.string.virtual_visit),
-                            fontSize = 22.sp,
-                            textAlign = TextAlign.Center
-                        )
-                        Spacer(modifier = Modifier.width(64.dp).weight(1f))
-                    }
-                }
+            // üî∂ VISITA VIRTUAL
+            Button(
+                onClick = { /* inactivo */ },
+                colors = ButtonDefaults.buttonColors(containerColor = MonasteryOrange),
+                shape = RoundedCornerShape(20.dp),
+                modifier = Modifier.fillMaxWidth()
+            ) {
+                Row(
+                    modifier=Modifier.fillMaxWidth(),
+                    verticalAlignment = Alignment.CenterVertically,
+                    horizontalArrangement = Arrangement.Start
+                )  {
+                    Icon(
+                        painter = painterResource(id = R.drawable.ic_map_24),
+                        contentDescription = null,
+                        modifier = Modifier
+                            .padding(end = 16.dp)
+                            .size(48.dp)
+                    )
+                    Spacer(modifier = Modifier.weight(1f))
+                    Text(
+                        stringResource(id = R.string.virtual_visit),
+                        fontSize = 22.sp,
+                        textAlign = TextAlign.Center
+                    )
+                    Spacer(modifier = Modifier.width(64.dp).weight(1f))
+                }
+            }
 
-                // üü© MODO NI√ëOS
-                Button(
-                    onClick = { /* inactivo */ },
-                    colors = ButtonDefaults.buttonColors(containerColor = Color(0xFF6EB017)),
-                    shape = RoundedCornerShape(20.dp),
-                    modifier = Modifier.fillMaxWidth()
-                ) {
-                    Row(
-                        modifier=Modifier.fillMaxWidth(),
-                        verticalAlignment = Alignment.CenterVertically,
-                        horizontalArrangement = Arrangement.Start
-                    )  {
-                        Icon(
-                            painter = painterResource(id = R.drawable.outline_account_child_invert_24),
-                            contentDescription = null,
-                            modifier = Modifier
-                                .padding(end = 16.dp)
-                                .size(48.dp)
-                        )
-                        Spacer(modifier = Modifier.weight(1f))
-                        Text(
-                            stringResource(id = R.string.child_mode),
-                            fontSize = 22.sp,
-                            textAlign = TextAlign.Center
-                        )
-                        Spacer(modifier = Modifier.width(64.dp).weight(1f))
-                    }
-                }
+            // üü© MODO NI√ëOS
+            Button(
+                onClick = { /* inactivo */ },
+                colors = ButtonDefaults.buttonColors(containerColor = Color(0xFF6EB017)),
+                shape = RoundedCornerShape(20.dp),
+                modifier = Modifier.fillMaxWidth()
+            ) {
+                Row(
+                    modifier=Modifier.fillMaxWidth(),
+                    verticalAlignment = Alignment.CenterVertically,
+                    horizontalArrangement = Arrangement.Start
+                )  {
+                    Icon(
+                        painter = painterResource(id = R.drawable.outline_account_child_invert_24),
+                        contentDescription = null,
+                        modifier = Modifier
+                            .padding(end = 16.dp)
+                            .size(48.dp)
+                    )
+                    Spacer(modifier = Modifier.weight(1f))
+                    Text(
+                        stringResource(id = R.string.child_mode),
+                        fontSize = 22.sp,
+                        textAlign = TextAlign.Center
+                    )
+                    Spacer(modifier = Modifier.width(64.dp).weight(1f))
+                }
+            }
 
-                // üîµ RESERVA
-                Button(
-                    onClick = { /* inactivo */ },
-                    colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),
-                    shape = RoundedCornerShape(20.dp),
-                    modifier = Modifier.fillMaxWidth()
-                ) {
-                    Row(
-                        modifier=Modifier.fillMaxWidth(),
-                        verticalAlignment = Alignment.CenterVertically,
-                        horizontalArrangement = Arrangement.Start
-                    ) {
-                        Icon(
-                            painter = painterResource(id = R.drawable.ic_time_24),
-                            contentDescription = null,
-                            modifier = Modifier
-                                .padding(end = 16.dp)
-                                .size(48.dp)
+            // üîµ RESERVA
+            Button(
+                onClick = { /* inactivo */ },
+                colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),
+                shape = RoundedCornerShape(20.dp),
+                modifier = Modifier.fillMaxWidth()
+            ) {
+                Row(
+                    modifier=Modifier.fillMaxWidth(),
+                    verticalAlignment = Alignment.CenterVertically,
+                    horizontalArrangement = Arrangement.Start
+                ) {
+                    Icon(
+                        painter = painterResource(id = R.drawable.ic_time_24),
+                        contentDescription = null,
+                        modifier = Modifier
+                            .padding(end = 16.dp)
+                            .size(48.dp)
 
-                        )
-                        Spacer(modifier = Modifier.weight(1f))
-                        Text(
-                            stringResource(id = R.string.book_appointment),
-                            fontSize = 22.sp,
-                            textAlign = TextAlign.Center,
-                        )
-                        Spacer(modifier = Modifier.width(64.dp).weight(1f))
-                    }
-                }
-            }
+                    )
+                    Spacer(modifier = Modifier.weight(1f))
+                    Text(
+                        stringResource(id = R.string.book_appointment),
+                        fontSize = 22.sp,
+                        textAlign = TextAlign.Center,
+                    )
+                    Spacer(modifier = Modifier.width(64.dp).weight(1f))
+                }
+            }
+        }
 
 
-            // BARRA DE ACCI√ìN INFERIOR (Confirmar / Cancelar)
-            AnimatedVisibility(
-                visible = selectedImageUri != null && !isUploading,
-                enter = fadeIn(),
-                exit = fadeOut(),
-                modifier = Modifier.constrainAs(actionControls) {
-                    bottom.linkTo(parent.bottom)
-                    start.linkTo(parent.start)
-                    end.linkTo(parent.end)
-                    width = Dimension.fillToConstraints
-                }
-            ) {
-                ActionControlBar(
-                    onConfirm = {
-                        coroutineScope.launch {
-                            isUploading = true
-                            val result = CloudinaryService.uploadImage(selectedImageUri!!, context)
+        // BARRA DE ACCI√ìN INFERIOR (Confirmar / Cancelar)
+        AnimatedVisibility(
+            visible = selectedImageUri != null && !isUploading,
+            enter = fadeIn(),
+            exit = fadeOut(),
+            modifier = Modifier.constrainAs(actionControls) {
+                bottom.linkTo(parent.bottom)
+                start.linkTo(parent.start)
+                end.linkTo(parent.end)
+                width = Dimension.fillToConstraints
+            }
+        ) {
+            ActionControlBar(
+                onConfirm = {
+                    coroutineScope.launch {
+                        AppStatus.startUpload()
+                        val result = CloudinaryService.uploadImage(selectedImageUri!!, context)
 
-                            result.onSuccess { url ->
-                                repo.updateImagenFondoInicio(url)
-                                currentSavedImageUrl = url
-                                selectedImageUri = null
-                                showConfirmationToast = true // üü¢ Mostrar Toast de √©xito
-                            }
+                        result.onSuccess { url ->
+                            repo.updateImagenFondoInicio(url)
+                            currentSavedImageUrl = url
+                            selectedImageUri = null
+                            showConfirmationToast = true // üü¢ Mostrar Toast de √©xito
+                        }
 
-                            result.onFailure {
-                                Toast.makeText(context, "Error subiendo la imagen", Toast.LENGTH_LONG).show()
-                            }
+                        result.onFailure {
+                            Toast.makeText(context, "Error subiendo la imagen", Toast.LENGTH_LONG).show()
+                        }
 
-                            isUploading = false // üî¥ FINALIZA LA CARGA
-                        }
-                    }
-                    ,
-                    onCancel = {
-                        selectedImageUri = null
-                    }
-                )
-            }
+                        AppStatus.finishUpload() // üî¥ FINALIZA LA CARGA
+                    }
+                }
+                ,
+                onCancel = {
+                    selectedImageUri = null
+                }
+            )
         }
     }
 }
Index: app/src/main/java/com/nextapp/monasterio/ui/screens/JuegoParejasScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.rememberScrollState\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.foundation.verticalScroll\r\nimport androidx.compose.material3.Button\r\nimport androidx.compose.material3.ButtonDefaults\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.DisposableEffect\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.unit.sp\r\nimport androidx.constraintlayout.compose.ChainStyle\r\nimport androidx.constraintlayout.compose.ConstraintLayout\r\nimport androidx.constraintlayout.compose.Dimension\r\nimport androidx.navigation.NavController\r\nimport com.nextapp.monasterio.AppRoutes\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.ui.theme.MonasteryBlue\r\n\r\n\r\n\r\n@Composable\r\nfun JuegoParejasScreen(navController:NavController,modifier: Modifier = Modifier) {\r\n    val context = LocalContext.current\r\n\r\n    val activity = (context as? Activity)\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n\r\n        onDispose {\r\n\r\n        }\r\n    }\r\n\r\n    ConstraintLayout(modifier = modifier.fillMaxSize().background(Color.White).verticalScroll(rememberScrollState())) {\r\n        val (btn4,btn9,btn16,btn25) = createRefs()\r\n        createVerticalChain(btn4,btn9,btn16,btn25, chainStyle = ChainStyle.Packed)\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.PAREJASNIVEL1)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .padding(bottom = 40.dp)\r\n                .constrainAs(btn4) {\r\n                    top.linkTo(parent.top)\r\n                    bottom.linkTo(btn9.top, margin = 40.dp)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            )  {\r\n                Text(\r\n                    stringResource(id = R.string.three_pairs),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.PAREJASNIVEL2)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .padding(bottom = 40.dp)\r\n                .constrainAs(btn9) {\r\n                    top.linkTo(btn4.bottom, margin = 40.dp)\r\n                    bottom.linkTo(btn16.top,margin=40.dp)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Text(\r\n                    stringResource(id = R.string.four_pairs),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.PAREJASNIVEL3)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .padding(bottom = 40.dp)\r\n                .constrainAs(btn16) {\r\n                    top.linkTo(btn9.bottom, margin = 40.dp)\r\n                    bottom.linkTo(btn25.top,margin=40.dp)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Text(\r\n                    stringResource(id = R.string.five_pairs),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n        Button(\r\n            onClick = {\r\n                navController.navigate(AppRoutes.PAREJASNIVEL4)\r\n            },\r\n            colors = ButtonDefaults.buttonColors(containerColor = MonasteryBlue),\r\n            shape = RoundedCornerShape(20.dp),\r\n            modifier = Modifier\r\n                .padding(bottom = 40.dp)\r\n                .constrainAs(btn25) {\r\n                    top.linkTo(btn16.bottom, margin = 40.dp)\r\n                    bottom.linkTo(parent.bottom)\r\n                    start.linkTo(parent.start, margin = 40.dp)\r\n                    end.linkTo(parent.end, margin = 40.dp)\r\n                    width = Dimension.fillToConstraints\r\n                }\r\n        ) {\r\n            Row(\r\n                modifier=Modifier\r\n                    .padding(horizontal = 20.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Text(\r\n                    stringResource(id = R.string.six_pairs),\r\n                    fontSize = 22.sp,\r\n                    textAlign = TextAlign.Center\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/JuegoParejasScreen.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/JuegoParejasScreen.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/JuegoParejasScreen.kt	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/JuegoParejasScreen.kt	(date 1764284826387)
@@ -2,6 +2,7 @@
 
 import android.app.Activity
 import android.content.pm.ActivityInfo
+import androidx.compose.foundation.Image
 import androidx.compose.foundation.background
 import androidx.compose.foundation.layout.*
 import androidx.compose.foundation.rememberScrollState
@@ -15,7 +16,9 @@
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.graphics.Color
+import androidx.compose.ui.layout.ContentScale
 import androidx.compose.ui.platform.LocalContext
+import androidx.compose.ui.res.painterResource
 import androidx.compose.ui.res.stringResource
 import androidx.compose.ui.text.style.TextAlign
 import androidx.compose.ui.unit.dp
@@ -44,9 +47,25 @@
         }
     }
 
-    ConstraintLayout(modifier = modifier.fillMaxSize().background(Color.White).verticalScroll(rememberScrollState())) {
-        val (btn4,btn9,btn16,btn25) = createRefs()
+    ConstraintLayout(modifier = modifier.fillMaxSize().verticalScroll(rememberScrollState())) {
+        val (btn4,btn9,btn16,btn25,background) = createRefs()
         createVerticalChain(btn4,btn9,btn16,btn25, chainStyle = ChainStyle.Packed)
+
+        Image(
+            painter = painterResource(R.drawable.fondo),
+            contentDescription = "Fondo",
+            contentScale = ContentScale.Crop,
+            modifier = Modifier
+                .constrainAs(background){
+                    top.linkTo(parent.top)
+                    bottom.linkTo(parent.bottom)
+                    start.linkTo(parent.start)
+                    end.linkTo(parent.end)
+                    width = Dimension.fillToConstraints
+                    height = Dimension.fillToConstraints
+                }
+        )
+
         Button(
             onClick = {
                 navController.navigate(AppRoutes.PAREJASNIVEL1)
Index: app/src/main/res/values-en/strings.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<resources>\r\n    <string name=\"app_name\">Museum360</string>\r\n    <string name=\"title_inicio\">Home</string>\r\n    <string name=\"virtual_visit\">VIRTUAL VISIT</string>\r\n    <string name=\"book_appointment\">BOOK APPOINTMENT</string>\r\n    <string name=\"monastery_name\">Santa Mar√≠a\\nla Real de Huelgas</string>\r\n    <string name=\"edit_mode_activate_icon\">Editor mode</string>\r\n    <string name=\"edit_mode_deactivate_icon\">Exit from editor mode</string>\r\n    <string name=\"edit_mode_activate_message\">Editor mode activated</string>\r\n    <string name=\"edit_mode_deactivate_message\">Editor mode deactivated</string>\r\n    <string name=\"edit_save_changes\">Save changes</string>\r\n    <string name=\"profile_login\">Login</string>\r\n    <string name=\"profile_logout\">Logout</string>\r\n    <string name=\"profile_email\">Email</string>\r\n    <string name=\"profile_password\">Password</string>\r\n    <string name=\"navigation_drawer_open\">Open menu</string>\r\n    <string name=\"navigation_drawer_close\">Close menu</string>\r\n    <string name=\"menu_info\">Monastery information</string>\r\n    <string name=\"menu_history\">History</string>\r\n    <string name=\"menu_gallery\">Gallery</string>\r\n    <string name=\"menu_profile\">Profile</string>\r\n    <string name=\"menu_settings\">Settings</string>\r\n    <string name=\"title_info_general\">General Information</string>\r\n    <string name=\"title_history\">History</string>\r\n    <string name=\"title_gallery\">Gallery</string>\r\n    <string name=\"title_profile\">Profile</string>\r\n    <string name=\"title_settings\">Settings</string>\r\n\r\n    <string name=\"info_location\">Street: ‚Ä¶</string>\r\n    <string name=\"history_1328\">1328 \uD83D\uDD25 Fire and Reconstruction</string>\r\n    <string name=\"history_1328_body\">During a fire in Valladolid caused by the troops of Alfonso XI, the monastery in the Palaces of La Magdalena was severely damaged. The nuns began its reconstruction thanks to the financial support of √Ålvaro Nu√±o P√©rez de Monroy.</string>\r\n\r\n    <string name=\"history_1579\">1579 \uD83C\uDFF0 Reconstruction of the Church and the Cloister</string>\r\n    <string name=\"history_579_body\">The nuns built the church following the design of the Italian master Pietro Palladio. The altarpiece was the work of Gregorio Fern√°ndez, and the new cloister was built by Francisco de Praves. All this was made possible thanks to donations from the abbesses Ana and Isabel de Mendoza.</string>\r\n\r\n    <string name=\"history_1869\">1869 \uD83C\uDF93 The Monastery School Is Founded</string>\r\n    <string name=\"history_1869_body\">The community of Las Huelgas Reales opened its own school, welcoming young noble girls from Valladolid as semi-boarders.</string>\r\n\r\n    <string name=\"history_XX\">20th‚Äì21st Centuries ‚ú® Restoration and Modern Life</string>\r\n    <string name=\"history_XX_body\">The monastery was fully restored. The decline in vocations encouraged the creation of the Lay Cistercian Brotherhood, which keeps alive the spirit of the Rule of Saint Benedict.</string>\r\n\r\n    <string name=\"history_2007\">2007 Onwards \uD83D\uDC69\u200D\uD83E\uDDB3 Leadership and Female Congregation</string>\r\n    <string name=\"history_2007_body\">The monastery is part of the Castile Congregation of the Cistercian Order, active as a female congregation since 2007. The first abbess president was Mar√≠a del Mar Mart√≠nez; after her death in 2013, Sister Isabel Vall√©s Gallego took over the position. Currently, Sister Mar√≠a leads the monastery and the school.</string>\r\n    <string name=\"info_hours\">Hours: XX:XX - YY:YY</string>\r\n    <string name=\"general_info\">General information:</string>\r\n    <string name=\"title_appointment\">Book Appointment</string>\r\n    <string name=\"option_phone_appointment\">Book by phone</string>\r\n    <string name=\"option_online_appointment\">Book online</string>\r\n    <string name=\"name_appointment\">Name</string>\r\n    <string name=\"email_appointment\">Email</string>\r\n    <string name=\"date_appointment\">Date</string>\r\n    <string name=\"hour_appointment\">Time</string>\r\n    <string name=\"placeholdername_appointment\">Enter your full name</string>\r\n    <string name=\"placeholderemail_appointment\">Enter your email address</string>\r\n    <string name=\"placeholderdate_appointment\">Select a date</string>\r\n    <string name=\"placeholderhour_appointment\">Select a time</string>\r\n    <string name=\"compulsory_name\">Name is required</string>\r\n    <string name=\"valid_name\">The name contains an invalid symbol</string>\r\n    <string name=\"compulsory_email\">Email is required</string>\r\n    <string name=\"valid_email\">The email format is invalid</string>\r\n    <string name=\"date_no_selected\">A date must be selected</string>\r\n    <string name=\"hour_no_selected\">A time must be selected</string>\r\n    <string name=\"datepicker_ok\">Ok</string>\r\n    <string name=\"datepicker_cancel\">Cancel</string>\r\n    <string name=\"confirm_button\">CONFIRM</string>\r\n    <string name=\"contentimage_confirmation\">Confirmed</string>\r\n    <string name=\"confirmation_appointment\">ALMOST READY!!</string>\r\n    <string name=\"details_appointment\">Your booking request is ready. Please click \\'send\\' in the email application that just opened to finalize your request. We will reply to that email to confirm availability..</string>\r\n    <string name=\"email_subject\">View Reservation Request - %1$s</string>\r\n    <string name=\"email_message\">Hello,\\n\\nI would like to request a reservation for a visit to the monastery with the following details:\\n\\n* Name: %1$s\\n* Email: %2$s\\n* Date of visit: %3$s\\n* Time of visit: %4$s\\n\\nI look forward to your kind confirmation.\\n\\nThank you very much,\\nSincerely,\\n\\n%1$s</string>\r\n    <string name=\"email_error\">No email app was found</string>\r\n    <string name=\"history_content_placeholder\">Mauris vel nisi id metus vestibulum vehicula nec ac orci. Curabitur massa diam, fermentum sit amet augue sit, volutpat efficitur enim. Phasellus a cursus orci, id laoreet dolor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</string>\r\n    <string name=\"language_select\">Select language</string>\r\n    <string name=\"font_size_select\">Select the font size</string>\r\n    <string name=\"font_extrabig\">Extra Big</string>\r\n    <string name=\"font_normal\">Medium</string>\r\n    <string name=\"font_big\">Big</string>\r\n    <string name=\"title_monasterio\">Monastery</string>\r\n    <string name=\"title_entrada\">Monastery Entrance</string>\r\n    <string name=\"spanish_language\">Spanish</string>\r\n    <string name=\"german_language\">German</string>\r\n    <string name=\"english_language\">English</string>\r\n    <string name=\"navegation_button\">Hide navigation buttons</string>\r\n    <string name=\"close\">Close</string>\r\n    <string name=\"go_back\">Go Back</string>\r\n    <string name=\"see_360\">View 360¬∫</string>\r\n    <string name=\"contentdescription_image_pin\">Pin image (click to enlarge)</string>\r\n    <string name=\"readjust\">Readjust</string>\r\n    <string name=\"decrease\">Decrease</string>\r\n    <string name=\"increase\">Increase</string>\r\n    <string name=\"out_interactive_area\">Outside the interactive area</string>\r\n    <string name=\"notdefined_destiny\">Undefined destination</string>\r\n    <string name=\"notdefined_destinyplane\">Destination plane not defined</string>\r\n    <string name=\"plane_loading\">Loading plane...</string>\r\n    <string name=\"error_loading_plane\">Error loading plan data</string>\r\n    <string name=\"child_mode\">KIDS MODE</string>\r\n    <string name=\"child_mode_view\">Kids Mode</string>\r\n    <string name=\"video_view\">Video</string>\r\n    <string name=\"game_view\">Games</string>\r\n    <string name=\"video_child\">VIDEO</string>\r\n    <string name=\"game_child\">GAMES</string>\r\n    <string name=\"edit_mode\">EDIT MODE</string>\r\n    <string name=\"edit_home_background\">Edit home background</string>\r\n    <string name=\"edit_pins\">Edit pins</string>\r\n    <string name=\"location_error\">No app was found to open the location.</string>\r\n    <string name=\"contact_data\">Contact Information</string>\r\n    <string name=\"location_data\">Location</string>\r\n    <string name=\"email_data\">Email</string>\r\n    <string name=\"phone_data\">Phone</string>\r\n    <string name=\"visit_schedule\">Opening Hours</string>\r\n    <string name=\"monday_to_friday\">Monday to Friday:</string>\r\n    <string name=\"four_pieces\">4 pieces</string>\r\n    <string name=\"nine_pieces\">9 pieces</string>\r\n    <string name=\"sixteen_pieces\">16 pieces</string>\r\n    <string name=\"twentyfive_pieces\">25 pieces</string>\r\n    <string name=\"three_pairs\">3 Pairs</string>\r\n    <string name=\"four_pairs\">4 Pairs</string>\r\n    <string name=\"five_pairs\">5 Pairs</string>\r\n    <string name=\"six_pairs\">6 Pairs</string>\r\n    <string name=\"confirm_save_title\">Save changes?</string>\r\n    <string name=\"confirm_save_message\">Are you sure you want to save the changes?</string>\r\n    <string name=\"confirm_save_button\">Save</string>\r\n    <string name=\"confirm_cancel_button\">Cancel</string>\r\n    <string name=\"edit_cancel_changes\">Cancel</string>\r\n    <string name=\"profile_name\">Name</string>\r\n    <string name=\"image_add\">Add image</string>\r\n    <string name=\"image_delete\">Delete</string>\r\n    <string name=\"image_delete_confirm_title\">Delete image?</string>\r\n    <string name=\"image_delete_confirm_message\">Are you sure you want to delete this image?</string>\r\n    <string name=\"image_uploading\">Uploading image...</string>\r\n    <string name=\"image_upload_success\">Image uploaded successfully</string>\r\n    <string name=\"image_upload_error\">Error uploading image</string>\r\n    <string name=\"image_select_error\">Error selecting image</string>\r\n    <string name=\"image_gallery_title\">Images</string>\r\n    <string name=\"congratulations\">Congratulations!</string>\r\n    <string name=\"message_game_completed\">You\\'ve solved the game! Ready for the next challenge?</string>\r\n    <string name=\"original_image\">View image</string>\r\n    <string name=\"ready\">Ready</string>\r\n    <string name=\"lang_de\">Deutsch</string>\r\n    <string name=\"font_small\">Small</string>\r\n    <string name=\"font_medium\">Medium</string>\r\n    <string name=\"font_large\">Large</string>\r\n    <string name=\"dont_show_again\">Don\\'t show again</string>\r\n    <string name=\"understand\">Got it</string>\r\n    <string name=\"map_tutorial_body\">This is the tutorial body</string>\r\n    <string name=\"map_tutorial_title\">This is the tutorial title</string>\r\n    <string name=\"map_tutorial_body2\">This is the map tutorial body 2</string>\r\n    <string name=\"map_tutorial_title2\">This is the map tutorial title 2</string>\r\n    <string name=\"pin_tutorial_body\">This is the pin tutorial body</string>\r\n    <string name=\"pin_tutorial_title\">This is the pin tutorial title</string>\r\n    <string name=\"next\">Next</string>\r\n\r\n    <string name=\"map_tutorial_body1\">The (‚Üê) symbol in the top left allows you to return to the start.</string>\r\n    <string name=\"map_tutorial_body1_2\">Tap the colored zones on the map to enter the different viewable areas.</string>\r\n    <string name=\"map_tutorial_body1_3\">Additionally, the buttons on the right allow you to zoom in, zoom out, or reset the map to its original size.</string>\r\n\r\n    <string name=\"submapa_1\">Tap the (‚Üê) symbol to return to the main map.</string>\r\n    <string name=\"submapa_2\">Tap the different pins to access the points of interest.</string>\r\n\r\n    <string name=\"pin_1\">Tap the (‚Üê) symbol to return to the map.</string>\r\n    <string name=\"pin_2\">Swipe through the images or tap them to enlarge.</string>\r\n    <string name=\"pin_3\">Tap here to listen to the audio narration.</string>\r\n    <string name=\"pin_4\">Tap this button to access the 360¬∞ view.</string>\r\n    <string name=\"visible\">Visible</string>\r\n    <string name=\"hidden\">Hidden</string>\r\n    <string name=\"lang_en\">English</string>\r\n    <string name=\"lang_es\">Espa√±ol</string>\r\n    <string name=\"sample_text\">Ejemplo</string>\r\n    <string name=\"puzzle_screen\">Puzzle</string>\r\n    <string name=\"puzzle_option\">PUZZLE</string>\r\n    <string name=\"memory_screen\">Memory</string>\r\n    <string name=\"memory_option\">MEMORY</string>\r\n    <string name=\"back_piece\">Back of the piece</string>\r\n    <string name=\"left_pairs\">Remaining couples: %1$s</string>\r\n    <string name=\"left_pieces\">Remaining pieces: %1$s</string>\r\n    <!-- Gallery Types -->\r\n    <string name=\"gallery_type_all\">All</string>\r\n    <string name=\"gallery_type_painting\">Paintings</string>\r\n    <string name=\"gallery_type_sculpture\">Sculptures</string>\r\n    <string name=\"gallery_type_architecture\">Architecture</string>\r\n    <string name=\"gallery_type_other\">Others</string>\r\n</resources>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/values-en/strings.xml b/app/src/main/res/values-en/strings.xml
--- a/app/src/main/res/values-en/strings.xml	(revision 6350e85983a0f2c0104869479ef735cb4036315a)
+++ b/app/src/main/res/values-en/strings.xml	(date 1764287640079)
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <resources>
-    <string name="app_name">Museum360</string>
+    <string name="app_name">Santa Mar√≠a la Real de Huelgas</string>
     <string name="title_inicio">Home</string>
     <string name="virtual_visit">VIRTUAL VISIT</string>
     <string name="book_appointment">BOOK APPOINTMENT</string>
@@ -166,6 +166,7 @@
     <string name="hidden">Hidden</string>
     <string name="lang_en">English</string>
     <string name="lang_es">Espa√±ol</string>
+    <string name="lang_fr">Fran√ßais</string>
     <string name="sample_text">Ejemplo</string>
     <string name="puzzle_screen">Puzzle</string>
     <string name="puzzle_option">PUZZLE</string>
@@ -174,6 +175,8 @@
     <string name="back_piece">Back of the piece</string>
     <string name="left_pairs">Remaining couples: %1$s</string>
     <string name="left_pieces">Remaining pieces: %1$s</string>
+    <string name="background_edit_screen">EDIT BACKGROUND</string>
+    <string name="pin_edit_screen">EDIT PIN</string>
     <!-- Gallery Types -->
     <string name="gallery_type_all">All</string>
     <string name="gallery_type_painting">Paintings</string>
