Index: app/src/main/res/drawable/sound.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/sound.xml b/app/src/main/res/drawable/sound.xml
new file mode 100644
--- /dev/null	(date 1764844626439)
+++ b/app/src/main/res/drawable/sound.xml	(date 1764844626439)
@@ -0,0 +1,11 @@
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="24dp"
+    android:height="24dp"
+    android:viewportWidth="960"
+    android:viewportHeight="960"
+    android:tint="?attr/colorControlNormal"
+    android:autoMirrored="true">
+  <path
+      android:fillColor="@android:color/white"
+      android:pathData="M560,829L560,747Q650,721 705,647Q760,573 760,479Q760,385 705,311Q650,237 560,211L560,129Q684,157 762,254.5Q840,352 840,479Q840,606 762,703.5Q684,801 560,829ZM120,600L120,360L280,360L480,160L480,800L280,600L120,600ZM560,640L560,318Q607,340 633.5,384Q660,428 660,480Q660,531 633.5,574.5Q607,618 560,640ZM400,354L314,440L200,440L200,520L314,520L400,606L400,354ZM300,480L300,480L300,480L300,480L300,480L300,480Z"/>
+</vector>
Index: app/src/main/res/drawable/pin3.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><vector xmlns:android=\"http://schemas.android.com/apk/res/android\" android:height=\"50dp\" android:viewportHeight=\"102\" android:viewportWidth=\"102\" android:width=\"50dp\">\r\n      \r\n    <group>\r\n            \r\n        <clip-path android:pathData=\"M0,0h102v102h-102z\"/>\r\n            \r\n        <path android:fillColor=\"#00000000\" android:pathData=\"M89.25,42.5C89.25,72.25 51,97.75 51,97.75C51,97.75 12.75,72.25 12.75,42.5C12.75,32.36 16.78,22.63 23.95,15.45C31.13,8.28 40.86,4.25 51,4.25C61.14,4.25 70.87,8.28 78.05,15.45C85.22,22.63 89.25,32.36 89.25,42.5Z\" android:strokeColor=\"#CF1031\" android:strokeLineCap=\"round\" android:strokeLineJoin=\"round\" android:strokeWidth=\"8.5\"/>\r\n            \r\n        <path android:fillColor=\"#00000000\" android:pathData=\"M51,55.25C58.04,55.25 63.75,49.54 63.75,42.5C63.75,35.46 58.04,29.75 51,29.75C43.96,29.75 38.25,35.46 38.25,42.5C38.25,49.54 43.96,55.25 51,55.25Z\" android:strokeColor=\"#CF1031\" android:strokeLineCap=\"round\" android:strokeLineJoin=\"round\" android:strokeWidth=\"8.5\"/>\r\n          \r\n    </group>\r\n    \r\n</vector>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/pin3.xml b/app/src/main/res/drawable/pin3.xml
--- a/app/src/main/res/drawable/pin3.xml	(revision 4dc941802a18f35e71ad5d92fcda0b6ea87da3e5)
+++ b/app/src/main/res/drawable/pin3.xml	(date 1764872382171)
@@ -1,13 +1,10 @@
-<vector xmlns:android="http://schemas.android.com/apk/res/android" android:height="50dp" android:viewportHeight="102" android:viewportWidth="102" android:width="50dp">
-      
-    <group>
-            
-        <clip-path android:pathData="M0,0h102v102h-102z"/>
-            
-        <path android:fillColor="#00000000" android:pathData="M89.25,42.5C89.25,72.25 51,97.75 51,97.75C51,97.75 12.75,72.25 12.75,42.5C12.75,32.36 16.78,22.63 23.95,15.45C31.13,8.28 40.86,4.25 51,4.25C61.14,4.25 70.87,8.28 78.05,15.45C85.22,22.63 89.25,32.36 89.25,42.5Z" android:strokeColor="#CF1031" android:strokeLineCap="round" android:strokeLineJoin="round" android:strokeWidth="8.5"/>
-            
-        <path android:fillColor="#00000000" android:pathData="M51,55.25C58.04,55.25 63.75,49.54 63.75,42.5C63.75,35.46 58.04,29.75 51,29.75C43.96,29.75 38.25,35.46 38.25,42.5C38.25,49.54 43.96,55.25 51,55.25Z" android:strokeColor="#CF1031" android:strokeLineCap="round" android:strokeLineJoin="round" android:strokeWidth="8.5"/>
-          
-    </group>
-    
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="24dp"
+    android:height="24dp"
+    android:viewportWidth="960"
+    android:viewportHeight="960"
+    android:tint="?attr/colorControlNormal">
+  <path
+      android:fillColor="@android:color/white"
+      android:pathData="M480,880Q374,880 307,846.5Q240,813 240,760Q240,736 254.5,715.5Q269,695 295,680L358,739Q349,743 338.5,748Q328,753 322,760Q335,776 382,788Q429,800 480,800Q531,800 578.5,788Q626,776 639,760Q632,752 621,747Q610,742 600,738L662,678Q690,694 705,714.5Q720,735 720,760Q720,813 653,846.5Q586,880 480,880ZM481,660Q580,587 630,513.5Q680,440 680,366Q680,264 615,212Q550,160 480,160Q410,160 345,212Q280,264 280,366Q280,433 329,505.5Q378,578 481,660ZM480,760Q339,656 269.5,558Q200,460 200,366Q200,295 225.5,241.5Q251,188 291,152Q331,116 381,98Q431,80 480,80Q529,80 579,98Q629,116 669,152Q709,188 734.5,241.5Q760,295 760,366Q760,460 690.5,558Q621,656 480,760ZM480,440Q513,440 536.5,416.5Q560,393 560,360Q560,327 536.5,303.5Q513,280 480,280Q447,280 423.5,303.5Q400,327 400,360Q400,393 423.5,416.5Q447,440 480,440ZM480,360Q480,360 480,360Q480,360 480,360Q480,360 480,360Q480,360 480,360Q480,360 480,360Q480,360 480,360Q480,360 480,360Q480,360 480,360Z"/>
 </vector>
Index: app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PlanoScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.nextapp.monasterio.ui.virtualvisit.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport android.os.Handler\r\nimport android.os.Looper\r\nimport android.widget.FrameLayout\r\nimport android.widget.Toast\r\nimport androidx.compose.animation.core.*\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.shape.CircleShape\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.geometry.Offset\r\nimport androidx.compose.ui.geometry.Size\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.graphics.toArgb\r\nimport androidx.compose.ui.layout.onGloballyPositioned\r\nimport androidx.compose.ui.layout.positionInRoot\r\nimport androidx.compose.ui.platform.LocalConfiguration\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.platform.LocalDensity\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.viewinterop.AndroidView\r\nimport androidx.navigation.NavController\r\nimport androidx.navigation.NavHostController\r\nimport android.graphics.Matrix\r\nimport android.graphics.Path\r\nimport android.util.Log\r\nimport androidx.compose.ui.text.font.FontWeight\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.AppRoutes\r\nimport com.nextapp.monasterio.models.*\r\nimport com.nextapp.monasterio.repository.*\r\nimport com.nextapp.monasterio.ui.virtualvisit.components.DebugPhotoView\r\nimport com.nextapp.monasterio.ui.virtualvisit.utils.isPointInPath\r\nimport com.nextapp.monasterio.ui.virtualvisit.utils.isPointInPinArea\r\nimport com.nextapp.monasterio.ui.screens.VirtualVisitRoutes\r\nimport com.nextapp.monasterio.viewModels.AjustesViewModel\r\nimport com.nextapp.monasterio.ui.virtualvisit.components.GenericTutorialOverlay\r\n\r\n// Clase auxiliar para definir los pasos del tutorial\r\nprivate data class TutorialStep(\r\n    val title: String? = null,\r\n    val description: String,\r\n    val focusCenter: Offset,\r\n    val focusRadius: Float = 0f,\r\n    val rectSize: Size? = null, // Añadido para soportar focos rectangulares (ej. Zoom)\r\n    val alignment: Alignment = Alignment.BottomCenter // Para controlar si el texto sale arriba o abajo\r\n)\r\n\r\n@Composable\r\nfun PlanoScreen(\r\n    viewModel: AjustesViewModel,\r\n    planoId: String,\r\n    navController: NavController,\r\n    rootNavController: NavHostController? = null\r\n) {\r\n    val context = LocalContext.current\r\n    val activity = (context as? Activity)\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n        onDispose {}\r\n    }\r\n\r\n\r\n\r\n    // -----------------------------------------------------------\r\n    // 1. CAPTURA DE COORDENADAS REALES (LAYOUT)\r\n    // -----------------------------------------------------------\r\n    val configuration = LocalConfiguration.current\r\n    val density = LocalDensity.current\r\n\r\n    // Calculamos el ancho y alto total en píxeles\r\n    val screenWidthPx = with(density) { configuration.screenWidthDp.dp.toPx() }\r\n    val screenHeightPx = with(density) { configuration.screenHeightDp.dp.toPx() }\r\n\r\n    // El centro de la pantalla siempre se puede calcular matemáticamente\r\n    val screenCenter = remember(configuration) {\r\n        with(density) {\r\n            Offset(\r\n                x = configuration.screenWidthDp.dp.toPx() / 2,\r\n                y = configuration.screenHeightDp.dp.toPx() / 2\r\n            )\r\n        }\r\n    }\r\n\r\n    // Variables de estado para guardar la posición real de los elementos flotantes\r\n    // Se rellenarán automáticamente gracias a .onGloballyPositioned\r\n    var backButtonLayout by remember { mutableStateOf<Pair<Offset, Size>?>(null) }\r\n    var zoomControlsLayout by remember { mutableStateOf<Pair<Offset, Size>?>(null) }\r\n\r\n    val scope = rememberCoroutineScope()\r\n\r\n    // --- Estados de Datos ---\r\n    var plano by remember { mutableStateOf<PlanoData?>(null) }\r\n    var figuras by remember { mutableStateOf<List<FiguraData>>(emptyList()) }\r\n    var pines by remember { mutableStateOf<List<PinData>>(emptyList()) }\r\n    var isLoading by remember { mutableStateOf(true) }\r\n\r\n    // --- Estados para carga del tutorial ---\r\n    var isError by remember { mutableStateOf(false) }\r\n    var retryTrigger by remember { mutableIntStateOf(0) }\r\n\r\n    // --- Estados Visuales ---\r\n    var activePath by remember { mutableStateOf<Path?>(null) }\r\n    var activeHighlight by remember { mutableStateOf<Color?>(null) }\r\n    var selectedPinId by remember { mutableStateOf<String?>(null) }\r\n\r\n    // --- LOGICA DE TUTORIAL ---\r\n    val isMainDismissed by viewModel.isMainMapDismissed.collectAsState()\r\n    val isSubDismissed by viewModel.isSubMapDismissed.collectAsState()\r\n    var showTutorialSession by remember { mutableStateOf(true) }\r\n\r\n    // Estado para saber en qué paso del tutorial estamos (0, 1, 2...)\r\n    var currentStepIndex by remember { mutableIntStateOf(0) }\r\n\r\n    val initialZoom = 1f\r\n    val planoBackgroundColor = Color(0xFFF5F5F5)\r\n    val botonesVisibles by viewModel.botonesVisibles.collectAsState()\r\n\r\n    // --- Efecto de parpadeo ---\r\n    val infiniteTransition = rememberInfiniteTransition(label = \"BlinkTransition\")\r\n    val blinkAlpha by infiniteTransition.animateFloat(\r\n        initialValue = 0f, targetValue = 1f,\r\n        animationSpec = infiniteRepeatable(tween(1500), RepeatMode.Reverse)\r\n    )\r\n\r\n    // --- Carga inicial ---\r\n    LaunchedEffect(planoId, retryTrigger) {\r\n        isLoading = true\r\n        isError = false\r\n        showTutorialSession = true\r\n        currentStepIndex = 0 // Reiniciamos los pasos al cambiar de plano\r\n        try {\r\n            plano = PlanoRepository.getPlanoById(planoId)\r\n            if (plano != null) {\r\n                Log.d(\"PlanoUniversal\", \"✅ Plano cargado: ${plano!!.nombre}\")\r\n                Log.d(\"DEBUG_PLANO\", \"plano.figuras RAW: ${plano!!.figuras}\")\r\n\r\n                val figuraRefs = plano!!.figuras.map { it.substringAfterLast(\"/\") }\r\n\r\n                Log.d(\"DEBUG_PLANO\", \"IDs de figuras a buscar: $figuraRefs\")\r\n                figuras = FiguraRepository.getAllFiguras().filter { figuraRefs.contains(it.id) }\r\n\r\n                Log.d(\"DEBUG_PLANO\", \"Figuras finales dibujadas: ${figuras.size}\")\r\n                if (figuras.isEmpty()) {\r\n                    Log.e(\"DEBUG_PLANO\", \"\uD83D\uDEA8 ¡La lista de figuras es CERO! Revisar mapeo de ID en FiguraRepository o referencias en PlanoData.\")\r\n                }\r\n\r\n                val pinRefs = plano!!.pines.map { it.substringAfterLast(\"/\") }\r\n                pines = PinRepository.getAllPins().filter { pinRefs.contains(it.id) }\r\n            } else {\r\n                Log.e(\"PlanoUniversal\", \"⚠\uFE0F Plano no encontrado con id=$planoId\")\r\n                isError = true\r\n            }\r\n        } catch (e: Exception) {\r\n            Log.e(\"PlanoUniversal\", \"❌ Error cargando plano\", e)\r\n            Toast.makeText(\r\n                context,\r\n                context.getString(R.string.error_loading_plane),\r\n                Toast.LENGTH_SHORT\r\n            ).show()\r\n            isError = true\r\n        } finally {\r\n            isLoading = false\r\n        }\r\n    }\r\n\r\n    // --- UI Principal ---\r\n    Box(\r\n        modifier = Modifier\r\n            .fillMaxSize()\r\n            .background(planoBackgroundColor)\r\n    ) {\r\n        if (isLoading) {\r\n            Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {\r\n                Text(stringResource(R.string.plane_loading))\r\n            }\r\n            return@Box\r\n        }\r\n\r\n        if (isError) {\r\n            ConnectionErrorView(\r\n                onRetry = { retryTrigger++ },\r\n                onBack = { if (!navController.popBackStack()) rootNavController?.popBackStack() }\r\n            )\r\n            return@Box\r\n        }\r\n\r\n        var photoViewRef by remember { mutableStateOf<DebugPhotoView?>(null) }\r\n\r\n        // 1. Capa del Mapa Interactivo\r\n        AndroidView(\r\n            modifier = Modifier.fillMaxSize(),\r\n            factory = { ctx ->\r\n                DebugPhotoView(ctx).apply {\r\n                    layoutParams = FrameLayout.LayoutParams(\r\n                        FrameLayout.LayoutParams.MATCH_PARENT,\r\n                        FrameLayout.LayoutParams.MATCH_PARENT\r\n                    )\r\n                    plano?.let { p -> setImageFromUrl(p.plano) }\r\n                    post { setScale(initialZoom, true) }\r\n                    this.pins = emptyList()\r\n                }\r\n            },\r\n            update = { photoView ->\r\n                photoView.staticZones = figuras.map {\r\n                    DebugPhotoView.StaticZoneData(\r\n                        createPathFromFirebase(it),\r\n                        it.colorResaltado.toUInt().toInt()\r\n                    )\r\n                }\r\n\r\n                photoView.pins = pines.map { pin ->\r\n                    // Calcular el color base, usando el color del modelo (si existe) o Rojo por defecto (Android Color)\r\n\r\n                    DebugPhotoView.PinData(\r\n                        x = pin.x,\r\n                        y = pin.y,\r\n                        iconId = R.drawable.pin3,\r\n                        isPressed = pin.id == selectedPinId, // ⭐ CAMBIO: Compara el ID\r\n                        isMoving = false,\r\n                        pinColor = android.graphics.Color.RED\r\n                    )\r\n                }\r\n\r\n                photoView.blinkingAlpha = blinkAlpha\r\n                photoView.interactivePath = activePath\r\n                photoView.highlightColor = activeHighlight?.toArgb() ?: Color.Transparent.toArgb()\r\n                photoView.invalidate()\r\n\r\n                photoView.setOnPhotoTapListener { _, x, y ->\r\n                    val figura = figuras.find { isPointInPath(x, y, createPathFromFirebase(it)) }\r\n                    val pin = pines.find { isPointInPinArea(x, y, it.x, it.y, it.tapRadius) }\r\n                    when {\r\n                        figura != null -> {\r\n                            activePath = createPathFromFirebase(figura)\r\n                            activeHighlight = Color(figura.colorResaltado.toUInt().toInt())\r\n                            Handler(Looper.getMainLooper()).postDelayed({\r\n                                activeHighlight = null\r\n                                when (figura.tipoDestino) {\r\n                                    \"detalle\" -> navController.navigate(\"${VirtualVisitRoutes.DETALLE_GENERICO}/${figura.id}\")\r\n                                    \"plano\" -> {\r\n                                        val destinoId = figura.valorDestino\r\n                                        if (destinoId.isNotBlank()) navController.navigate(\"${VirtualVisitRoutes.PLANO}/$destinoId\")\r\n                                        else Toast.makeText(\r\n                                            context,\r\n                                            context.getString(R.string.notdefined_destinyplane),\r\n                                            Toast.LENGTH_SHORT\r\n                                        ).show()\r\n                                    }\r\n                                    else -> Toast.makeText(\r\n                                        context,\r\n                                        context.getString(R.string.notdefined_destiny),\r\n                                        Toast.LENGTH_SHORT\r\n                                    ).show()\r\n                                }\r\n                            }, 200)\r\n                        }\r\n\r\n                        pin != null -> {\r\n                            selectedPinId = pin.id // ⭐ CAMBIO: Almacena el ID del pin tocado\r\n                            Handler(Looper.getMainLooper()).postDelayed({\r\n                                selectedPinId = null // ⭐ CAMBIO: Restaura a nulo después del delay (deselección)\r\n                                when (pin.tipoDestino?.lowercase()) {\r\n                                    \"ruta\" -> if (pin.valorDestino != null) rootNavController?.navigate(\r\n                                        \"${AppRoutes.PIN_ENTRADA_MONASTERIO}/${pin.id}\"\r\n                                    )\r\n                                    \"detalle\" -> navController.navigate(AppRoutes.PIN_DETALLE + \"/${pin.id}\")\r\n                                }\r\n                            }, 200)\r\n                        }\r\n\r\n                        else -> { // ⭐ CAMBIO: Abrimos un bloque para añadir la lógica de deselección\r\n                            selectedPinId = null // ⭐ ADICIÓN: Deseleccionar cualquier pin activo\r\n                            Toast.makeText(\r\n                                context,\r\n                                context.getString(R.string.out_interactive_area),\r\n                                Toast.LENGTH_SHORT\r\n                            ).show()\r\n                        }\r\n\r\n                    }\r\n                }\r\n                photoViewRef = photoView\r\n            }\r\n        )\r\n\r\n        // 2. Controles de Zoom\r\n        Column(\r\n            modifier = Modifier\r\n                .align(Alignment.CenterEnd)\r\n                .padding(end = 16.dp, bottom = 80.dp)\r\n                // \uD83D\uDC47 CAPTURAR POSICIÓN REAL (Para que el tutorial no se descuadre)\r\n                .onGloballyPositioned { coordinates ->\r\n                    val position = coordinates.positionInRoot()\r\n                    val size = coordinates.size\r\n                    zoomControlsLayout = position to Size(size.width.toFloat(), size.height.toFloat())\r\n                },\r\n            verticalArrangement = Arrangement.spacedBy(12.dp)\r\n        ) {\r\n            if (botonesVisibles) {\r\n                FloatingActionButton(onClick = {\r\n                    photoViewRef?.let {\r\n                        it.setScale(\r\n                            (it.scale + 0.2f).coerceAtMost(\r\n                                it.maximumScale\r\n                            ), true\r\n                        )\r\n                    }\r\n                }) {\r\n                    Box(\r\n                        modifier = Modifier.size(48.dp)\r\n                            .background(Color.White.copy(alpha = 0.7f), CircleShape),\r\n                        contentAlignment = Alignment.Center\r\n                    ) {\r\n                        Icon(\r\n                            painter = painterResource(id = R.drawable.aumentar_zoom),\r\n                            contentDescription = stringResource(R.string.increase),\r\n                            tint = Color.Unspecified\r\n                        )\r\n                    }\r\n                }\r\n                FloatingActionButton(onClick = {\r\n                    photoViewRef?.let {\r\n                        it.setScale(\r\n                            (it.scale - 0.2f).coerceAtLeast(\r\n                                it.minimumScale\r\n                            ), true\r\n                        )\r\n                    }\r\n                }) {\r\n                    Box(\r\n                        modifier = Modifier.size(48.dp)\r\n                            .background(Color.White.copy(alpha = 0.7f), CircleShape),\r\n                        contentAlignment = Alignment.Center\r\n                    ) {\r\n                        Icon(\r\n                            painter = painterResource(id = R.drawable.disminuir_zoom),\r\n                            contentDescription = stringResource(R.string.decrease),\r\n                            tint = Color.Unspecified\r\n                        )\r\n                    }\r\n                }\r\n                FloatingActionButton(onClick = {\r\n                    photoViewRef?.apply {\r\n                        setScale(\r\n                            initialZoom,\r\n                            true\r\n                        ); setTranslationX(0f); setTranslationY(0f)\r\n                    }\r\n                }) {\r\n                    Box(\r\n                        modifier = Modifier.size(48.dp)\r\n                            .background(Color.White.copy(alpha = 0.7f), CircleShape),\r\n                        contentAlignment = Alignment.Center\r\n                    ) {\r\n                        Icon(\r\n                            painter = painterResource(id = R.drawable.reajustar),\r\n                            contentDescription = stringResource(R.string.readjust),\r\n                            tint = Color.Unspecified\r\n                        )\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // 3. Botón Atrás\r\n        IconButton(\r\n            onClick = {\r\n                if (!navController.popBackStack()) {\r\n                    if (planoId == \"monasterio_exterior\") {\r\n                        rootNavController?.popBackStack()\r\n                    } else {\r\n                        navController.navigate(\"${VirtualVisitRoutes.PLANO}/monasterio_exterior\") {\r\n                            popUpTo(\"${VirtualVisitRoutes.PLANO}/monasterio_exterior\") {\r\n                                inclusive = false\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            modifier = Modifier\r\n                .align(Alignment.TopStart)\r\n                .statusBarsPadding()\r\n                .padding(16.dp)\r\n                .background(Color.Black.copy(alpha = 0.5f), shape = RoundedCornerShape(12.dp))\r\n                // \uD83D\uDC47 CAPTURAR POSICIÓN REAL (Para que el tutorial no se descuadre)\r\n                .onGloballyPositioned { coordinates ->\r\n                    val position = coordinates.positionInRoot()\r\n                    val size = coordinates.size\r\n                    backButtonLayout = position to Size(size.width.toFloat(), size.height.toFloat())\r\n                }\r\n        ) {\r\n            Icon(\r\n                painter = painterResource(id = R.drawable.arrow_back),\r\n                contentDescription = stringResource(R.string.go_back),\r\n                tint = Color.White\r\n            )\r\n        }\r\n\r\n        // 4. TUTORIALES (Lógica Step-by-Step Dinámica)\r\n        val isMainMap = (planoId == \"monasterio_exterior\")\r\n\r\n        // Solo mostrar si tenemos las coordenadas capturadas\r\n        val isLayoutReady = backButtonLayout != null && !isLoading && !isError\r\n\r\n        if (showTutorialSession && isLayoutReady) {\r\n            if (isMainMap && !isMainDismissed) {\r\n\r\n                // --- TUTORIAL MAPA PRINCIPAL (3 Pasos) ---\r\n                val steps = remember(backButtonLayout, zoomControlsLayout) {\r\n                    val list = mutableListOf<TutorialStep>()\r\n\r\n                    // Paso 0: Bienvenida (Foco Botón Atrás)\r\n                    if (backButtonLayout != null) {\r\n                        val (pos, size) = backButtonLayout!!\r\n                        list.add(\r\n                            TutorialStep(\r\n                                description = context.getString(R.string.map_tutorial_body1),\r\n                                focusCenter = Offset(pos.x + size.width / 2, pos.y + size.height / 2),\r\n                                focusRadius = 100f,\r\n                                alignment = Alignment.BottomCenter\r\n                            )\r\n                        )\r\n                    }\r\n\r\n                    // Paso 1: Zoom (Foco Mapa Centro)\r\n                    list.add(\r\n                        TutorialStep(\r\n                            description = context.getString(R.string.map_tutorial_body1_2),\r\n                            focusCenter = Offset(screenWidthPx * 0.3f, screenHeightPx * 0.45f),\r\n                            focusRadius = 250f,\r\n                            alignment = Alignment.BottomCenter\r\n                        )\r\n                    )\r\n\r\n                    // Paso 2: Zoom Controls (Foco Rectangular en controles)\r\n                    if (zoomControlsLayout != null) {\r\n                        val (pos, size) = zoomControlsLayout!!\r\n                        list.add(\r\n                            TutorialStep(\r\n                                description = context.getString(R.string.map_tutorial_body1_3),\r\n                                focusCenter = Offset(pos.x + size.width / 2, pos.y + size.height / 2),\r\n                                rectSize = size, // Usamos foco cuadrado para los botones\r\n                                focusRadius = 0f, // No usamos radio\r\n                                alignment = Alignment.BottomCenter // Diálogo arriba para no tapar botones\r\n                            )\r\n                        )\r\n                    }\r\n                    list\r\n                }\r\n\r\n                if (steps.isNotEmpty() && currentStepIndex < steps.size) {\r\n                    val step = steps[currentStepIndex]\r\n                    val isLastStep = currentStepIndex == steps.size - 1\r\n                    val btnText =\r\n                        if (isLastStep) stringResource(R.string.understand) else stringResource(R.string.next)\r\n\r\n                    GenericTutorialOverlay(\r\n                        title = step.title,\r\n                        description = step.description,\r\n                        highlightCenter = step.focusCenter,\r\n                        highlightRadius = step.focusRadius,\r\n                        highlightRectSize = step.rectSize,\r\n                        dialogAlignment = step.alignment,\r\n                        buttonText = btnText,\r\n                        onCloseClicked = { permanent ->\r\n                            if (isLastStep) {\r\n                                showTutorialSession = false\r\n                                if (permanent) viewModel.dismissMainMap()\r\n                            } else {\r\n                                currentStepIndex++\r\n                                if (permanent) viewModel.dismissMainMap()\r\n                            }\r\n                        }\r\n                    )\r\n                }\r\n\r\n            } else if (!isMainMap && !isSubDismissed) {\r\n\r\n                val subSteps = remember(backButtonLayout) {\r\n                    val list = mutableListOf<TutorialStep>()\r\n\r\n                    if (backButtonLayout != null) {\r\n                        val (pos, size) = backButtonLayout!!\r\n                        list.add(\r\n                            TutorialStep(\r\n                                description = context.getString(R.string.submapa_1),\r\n                                focusCenter = Offset(pos.x + size.width / 2, pos.y + size.height / 2),\r\n                                focusRadius = 100f,\r\n                                alignment = Alignment.BottomCenter\r\n                            )\r\n                        )\r\n                    }\r\n\r\n                    val (pos, size) = backButtonLayout!!\r\n                    list.add(\r\n                        TutorialStep(\r\n                            description = context.getString(R.string.submapa_2),\r\n                            focusCenter = Offset(screenWidthPx * 0.5f, screenHeightPx * 0.2f),\r\n                            focusRadius = 300f,\r\n                            alignment = Alignment.BottomCenter\r\n                        )\r\n                    )\r\n\r\n                    list\r\n                }\r\n\r\n                if (subSteps.isNotEmpty() && currentStepIndex < subSteps.size) {\r\n                    val step = subSteps[currentStepIndex]\r\n                    val isLastStep = currentStepIndex == subSteps.size - 1\r\n                    val btnText =\r\n                        if (isLastStep) stringResource(R.string.understand) else stringResource(R.string.next)\r\n\r\n                    GenericTutorialOverlay(\r\n                        description = step.description,\r\n                        highlightCenter = step.focusCenter,\r\n                        highlightRadius = step.focusRadius,\r\n                        highlightRectSize = step.rectSize,\r\n                        buttonText = btnText,\r\n                        dialogAlignment = step.alignment,\r\n                        onCloseClicked = { permanent ->\r\n                            if (isLastStep) {\r\n                                showTutorialSession = false\r\n                                if (permanent) viewModel.dismissSubMap()\r\n                            } else {\r\n                                currentStepIndex++\r\n                                if (permanent) viewModel.dismissSubMap()\r\n                            }\r\n                        }\r\n                    )\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// --- Helper para crear Paths (Fuera del composable) ---\r\nprivate fun createPathFromFirebase(figura: FiguraData): Path {\r\n    val path = Path()\r\n    if (figura.path.isEmpty()) return path\r\n    path.moveTo(figura.path[0].x, figura.path[0].y)\r\n    for (i in 1 until figura.path.size) {\r\n        path.lineTo(figura.path[i].x, figura.path[i].y)\r\n    }\r\n    path.close()\r\n    val matrix = Matrix().apply {\r\n        setScale(figura.scale, figura.scale)\r\n        postTranslate(figura.offsetX, figura.offsetY)\r\n    }\r\n    path.transform(matrix)\r\n    return path\r\n}\r\n\r\n@Composable\r\nfun ConnectionErrorView(onRetry: () -> Unit, onBack: () -> Unit) {\r\n    // 1. Definimos la secuencia de imágenes para la animación\r\n    // (Asegúrate de que los nombres coinciden con tus archivos en res/drawable)\r\n    val wifiIcons = listOf(\r\n        R.drawable.wifi_1_bar,\r\n        R.drawable.wifi_2_bar,\r\n        R.drawable.wifi\r\n    )\r\n\r\n    // 2. Estado para controlar qué imagen se muestra\r\n    var currentIconIndex by remember { mutableIntStateOf(0) }\r\n\r\n    // 3. El bucle de animación\r\n    LaunchedEffect(Unit) {\r\n        while (true) {\r\n            kotlinx.coroutines.delay(500) // Cambia de imagen cada 0.5 segundos\r\n            currentIconIndex = (currentIconIndex + 1) % wifiIcons.size\r\n        }\r\n    }\r\n\r\n    Box(\r\n        modifier = Modifier\r\n            .fillMaxSize()\r\n            .background(Color(0xFFF5F5F5)),\r\n        contentAlignment = Alignment.Center\r\n    ) {\r\n        Column(\r\n            horizontalAlignment = Alignment.CenterHorizontally,\r\n            verticalArrangement = Arrangement.Center,\r\n            modifier = Modifier.padding(32.dp)\r\n        ) {\r\n            // 4. Icono animado (Cambia según el índice)\r\n            Icon(\r\n                painter = painterResource(id = wifiIcons[currentIconIndex]),\r\n                contentDescription = null,\r\n                tint = MaterialTheme.colorScheme.error, // Color rojo de error\r\n                modifier = Modifier.size(80.dp)\r\n            )\r\n\r\n            Spacer(Modifier.height(16.dp))\r\n\r\n            Text(\r\n                text = stringResource(R.string.error_connection_title),\r\n                style = MaterialTheme.typography.headlineSmall,\r\n                color = Color.Black,\r\n                fontWeight = FontWeight.Bold,\r\n                textAlign = TextAlign.Center\r\n            )\r\n\r\n            Spacer(Modifier.height(8.dp))\r\n\r\n            Text(\r\n                text = stringResource(R.string.error_connection_desc),\r\n                style = MaterialTheme.typography.bodyMedium,\r\n                color = Color.Gray,\r\n                textAlign = TextAlign.Center\r\n            )\r\n\r\n            Spacer(Modifier.height(32.dp))\r\n\r\n            Button(\r\n                onClick = onRetry,\r\n                modifier = Modifier.fillMaxWidth(0.7f),\r\n                shape = RoundedCornerShape(12.dp)\r\n            ) {\r\n                Text(stringResource(R.string.retry))\r\n            }\r\n        }\r\n\r\n        IconButton(\r\n            onClick = onBack,\r\n            modifier = Modifier\r\n                .align(Alignment.TopStart)\r\n                .statusBarsPadding()\r\n                .padding(16.dp)\r\n                .background(Color.White.copy(alpha = 0.8f), CircleShape)\r\n        ) {\r\n            Icon(\r\n                painter = painterResource(id = R.drawable.arrow_back),\r\n                contentDescription = stringResource(R.string.go_back),\r\n                tint = Color.Black\r\n            )\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PlanoScreen.kt b/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PlanoScreen.kt
--- a/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PlanoScreen.kt	(revision 4dc941802a18f35e71ad5d92fcda0b6ea87da3e5)
+++ b/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PlanoScreen.kt	(date 1764884392705)
@@ -33,6 +33,8 @@
 import android.graphics.Matrix
 import android.graphics.Path
 import android.util.Log
+import androidx.compose.foundation.border
+import androidx.compose.material3.FloatingActionButtonDefaults.elevation
 import androidx.compose.ui.text.font.FontWeight
 import androidx.compose.ui.text.style.TextAlign
 import com.nextapp.monasterio.R
@@ -309,65 +311,56 @@
             verticalArrangement = Arrangement.spacedBy(12.dp)
         ) {
             if (botonesVisibles) {
-                FloatingActionButton(onClick = {
-                    photoViewRef?.let {
-                        it.setScale(
-                            (it.scale + 0.2f).coerceAtMost(
-                                it.maximumScale
-                            ), true
-                        )
-                    }
-                }) {
-                    Box(
-                        modifier = Modifier.size(48.dp)
-                            .background(Color.White.copy(alpha = 0.7f), CircleShape),
-                        contentAlignment = Alignment.Center
-                    ) {
+                // --- BOTÓN AUMENTAR ---
+                FloatingActionButton(
+                    onClick = { photoViewRef?.let { it.setScale((it.scale + 0.2f).coerceAtMost(it.maximumScale), true) } },
+                    containerColor = Color.White,
+                    elevation = FloatingActionButtonDefaults.elevation(0.dp)
+                ) {
+                    Box(modifier = Modifier.size(48.dp).background(Color.White.copy(alpha = 0.7f), CircleShape).border(1.dp, Color.Black, CircleShape), contentAlignment = Alignment.Center) {
                         Icon(
                             painter = painterResource(id = R.drawable.aumentar_zoom),
                             contentDescription = stringResource(R.string.increase),
-                            tint = Color.Unspecified
+                            tint = Color.Unspecified,
+                            modifier = Modifier.size(32.dp)
                         )
                     }
                 }
-                FloatingActionButton(onClick = {
-                    photoViewRef?.let {
-                        it.setScale(
-                            (it.scale - 0.2f).coerceAtLeast(
-                                it.minimumScale
-                            ), true
-                        )
-                    }
-                }) {
-                    Box(
-                        modifier = Modifier.size(48.dp)
-                            .background(Color.White.copy(alpha = 0.7f), CircleShape),
-                        contentAlignment = Alignment.Center
-                    ) {
+
+                // --- BOTÓN DISMINUIR ---
+                FloatingActionButton(
+                    onClick = { photoViewRef?.let { it.setScale((it.scale - 0.2f).coerceAtLeast(it.minimumScale), true) } },
+                    containerColor = Color.White,
+                    elevation = FloatingActionButtonDefaults.elevation(0.dp)
+                ) {
+                    Box(modifier = Modifier.size(48.dp).background(Color.White.copy(alpha = 0.7f), CircleShape).border(1.dp, Color.Black, CircleShape), contentAlignment = Alignment.Center) {
                         Icon(
                             painter = painterResource(id = R.drawable.disminuir_zoom),
                             contentDescription = stringResource(R.string.decrease),
-                            tint = Color.Unspecified
+                            tint = Color.Unspecified,
+                            modifier = Modifier.size(32.dp)
                         )
                     }
                 }
-                FloatingActionButton(onClick = {
-                    photoViewRef?.apply {
-                        setScale(
-                            initialZoom,
-                            true
-                        ); setTranslationX(0f); setTranslationY(0f)
-                    }
-                }) {
+
+                // --- BOTÓN REAJUSTAR (CON BORDE NEGRO) ---
+                FloatingActionButton(
+                    onClick = { photoViewRef?.apply { setScale(initialZoom, true); setTranslationX(0f); setTranslationY(0f) } },
+                    containerColor = Color.White,
+                    elevation = FloatingActionButtonDefaults.elevation(0.dp)
+                ) {
                     Box(
-                        modifier = Modifier.size(48.dp)
-                            .background(Color.White.copy(alpha = 0.7f), CircleShape),
+                        modifier = Modifier
+                            .size(48.dp)
+                            .background(Color.White.copy(alpha = 0.7f), CircleShape)
+                            .border(1.dp, Color.Black, CircleShape),
                         contentAlignment = Alignment.Center
                     ) {
                         Icon(
                             painter = painterResource(id = R.drawable.reajustar),
                             contentDescription = stringResource(R.string.readjust),
-                            tint = Color.Unspecified
+                            tint = Color.Unspecified,
+                            modifier = Modifier.size(36.dp)
                         )
                     }
                 }
Index: .idea/shelf/Uncommitted_changes_before_Update_at_03_12_2025_23_00__Changes_.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_03_12_2025_23_00__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_03_12_2025_23_00__Changes_.xml
new file mode 100644
--- /dev/null	(date 1764799247344)
+++ b/.idea/shelf/Uncommitted_changes_before_Update_at_03_12_2025_23_00__Changes_.xml	(date 1764799247344)
@@ -0,0 +1,103 @@
+<changelist name="Uncommitted_changes_before_Update_at_03_12_2025_23_00_[Changes]" date="1764799215960" recycled="true" deleted="true">
+  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_03_12_2025_23_00_[Changes]/shelved.patch" />
+  <option name="DESCRIPTION" value="Uncommitted changes before Update at 03/12/2025 23:00 [Changes]" />
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_27.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_4.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_11.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_15.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_5.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_10.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_9.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_1.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_19.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/entrada_4.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/entrada_2.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/entrada.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_22.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_7.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_16.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_20.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_29.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_2.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_13.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_24.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_25.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_18.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_14.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_28.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_21.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_17.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_6.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_8.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_23.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_26.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_3.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/entrada_3.jpg" />
+  </binary>
+  <binary>
+    <option name="BEFORE_PATH" value="app/src/main/res/raw/monastery_12.jpg" />
+  </binary>
+</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_04_12_2025_19_03__Changes_.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_04_12_2025_19_03__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_04_12_2025_19_03__Changes_.xml
new file mode 100644
--- /dev/null	(date 1764871422890)
+++ b/.idea/shelf/Uncommitted_changes_before_Update_at_04_12_2025_19_03__Changes_.xml	(date 1764871422890)
@@ -0,0 +1,4 @@
+<changelist name="Uncommitted_changes_before_Update_at_04_12_2025_19_03_[Changes]" date="1764871411140" recycled="true" deleted="true">
+  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_04_12_2025_19_03_[Changes]/shelved.patch" />
+  <option name="DESCRIPTION" value="Uncommitted changes before Update at 04/12/2025 19:03 [Changes]" />
+</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_03_12_2025_23_00_[Changes]/shelved.patch
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_03_12_2025_23_00_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_03_12_2025_23_00_[Changes]/shelved.patch
new file mode 100644
--- /dev/null	(date 1764799211105)
+++ b/.idea/shelf/Uncommitted_changes_before_Update_at_03_12_2025_23_00_[Changes]/shelved.patch	(date 1764799211105)
@@ -0,0 +1,209 @@
+Index: app/src/main/java/com/nextapp/monasterio/data/MonasteryMap.kt
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.nextapp.monasterio.data\r\n\r\nimport com.nextapp.monasterio.R\r\n\r\n/**\r\n * Define la estructura de un Hotspot (una flecha de navegación).\r\n */\r\ndata class Hotspot(\r\n    val id: String,         // ID único para esta flecha (ej: \"claustro_a_capilla\")\r\n    val pitch: Float,       // Ángulo vertical (arriba/abajo) donde aparece\r\n    val yaw: Float,         // Ángulo horizontal (izq/der) donde aparece\r\n    val targetVistaId: String // El ID de la vista a la que navega (ej: \"capilla_mayor\")\r\n)\r\n\r\n/**\r\n * Define la estructura de una Vista Panorámica individual.\r\n */\r\ndata class PanoramaVista(\r\n    val id: String,                 // ID único (ej: \"monastery_1\")\r\n    val nombre: String,             // Nombre para el botón (ej: \"Entrada Principal\")\r\n    val imagenResId: Int,           // El recurso en R.raw (ej: R.raw.monastery_1)\r\n    val hotspots: List<Hotspot>     // Lista de flechas/hotspots en esta vista\r\n)\r\n\r\n/**\r\n * Repositorio central que contiene el \"mapa\" de todas las vistas del monasterio.\r\n *\r\n * ¡IMPORTANTE!\r\n * Todas las imágenes (monastery_1.jpg, entrada.jpg, etc.) deben estar copiadas\r\n * en tu carpeta `app/src/main/res/raw`\r\n */\r\nobject MonasterioMapRepository {\r\n\r\n    // Lista completa de las 32 vistas panorámicas\r\n    private val vistas = listOf(\r\n        PanoramaVista(\r\n            id = \"monastery_1\",\r\n            nombre = \"Monastery 1\", // <-- Cambia este nombre por el real\r\n            imagenResId = R.raw.monastery_1,\r\n            hotspots = emptyList() // <-- Añadiremos los hotspots después\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_2\",\r\n            nombre = \"Monastery 2\",\r\n            imagenResId = R.raw.monastery_2,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_3\",\r\n            nombre = \"Monastery 3\",\r\n            imagenResId = R.raw.monastery_3,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_4\",\r\n            nombre = \"Monastery 4\",\r\n            imagenResId = R.raw.monastery_4,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_5\",\r\n            nombre = \"Monastery 5\",\r\n            imagenResId = R.raw.monastery_5,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_6\",\r\n            nombre = \"Monastery 6\",\r\n            imagenResId = R.raw.monastery_6,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_7\",\r\n            nombre = \"Monastery 7\",\r\n            imagenResId = R.raw.monastery_7,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_8\",\r\n            nombre = \"Monastery 8\",\r\n            imagenResId = R.raw.monastery_8,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_9\",\r\n            nombre = \"Monastery 9\",\r\n            imagenResId = R.raw.monastery_9,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_10\",\r\n            nombre = \"Monastery 10\",\r\n            imagenResId = R.raw.monastery_10,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_11\",\r\n            nombre = \"Monastery 11\",\r\n            imagenResId = R.raw.monastery_11,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_12\",\r\n            nombre = \"Monastery 12\",\r\n            imagenResId = R.raw.monastery_12,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_13\",\r\n            nombre = \"Monastery 13\",\r\n            imagenResId = R.raw.monastery_13,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_14\",\r\n            nombre = \"Monastery 14\",\r\n            imagenResId = R.raw.monastery_14,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_15\",\r\n            nombre = \"Monastery 15\",\r\n            imagenResId = R.raw.monastery_15,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_16\",\r\n            nombre = \"Monastery 16\",\r\n            imagenResId = R.raw.monastery_16,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_17\",\r\n            nombre = \"Monastery 17\",\r\n            imagenResId = R.raw.monastery_17,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_18\",\r\n            nombre = \"Monastery 18\",\r\n            imagenResId = R.raw.monastery_18,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_19\",\r\n            nombre = \"Monastery 19\",\r\n            imagenResId = R.raw.monastery_19,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_20\",\r\n            nombre = \"Monastery 20\",\r\n            imagenResId = R.raw.monastery_20,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_21\",\r\n            nombre = \"Monastery 21\",\r\n            imagenResId = R.raw.monastery_21,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_22\",\r\n            nombre = \"Monastery 22\",\r\n            imagenResId = R.raw.monastery_22,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_23\",\r\n            nombre = \"Monastery 23\",\r\n            imagenResId = R.raw.monastery_23,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_24\",\r\n            nombre = \"Monastery 24\",\r\n            imagenResId = R.raw.monastery_24,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_25\",\r\n            nombre = \"Monastery 25\",\r\n            imagenResId = R.raw.monastery_25,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_26\",\r\n            nombre = \"Monastery 26\",\r\n            imagenResId = R.raw.monastery_26,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_27\",\r\n            nombre = \"Monastery 27\",\r\n            imagenResId = R.raw.monastery_27,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_28\",\r\n            nombre = \"Monastery 28\",\r\n            imagenResId = R.raw.monastery_28,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"monastery_29\",\r\n            nombre = \"Monastery 29\",\r\n            imagenResId = R.raw.monastery_29,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"entrada\",\r\n            nombre = \"Entrada\",\r\n            imagenResId = R.raw.entrada,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"entrada_2\",\r\n            nombre = \"Entrada 2\",\r\n            imagenResId = R.raw.entrada_2,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"entrada_3\",\r\n            nombre = \"Entrada 3\",\r\n            imagenResId = R.raw.entrada_3,\r\n            hotspots = emptyList()\r\n        ),\r\n        PanoramaVista(\r\n            id = \"entrada_4\",\r\n            nombre = \"Entrada 4\",\r\n            imagenResId = R.raw.entrada_4,\r\n            hotspots = emptyList()\r\n        )\r\n    )\r\n\r\n    /**\r\n     * Devuelve la lista completa de todas las vistas.\r\n     * (Lo usará GaleriaScreen para mostrar todos los botones).\r\n     */\r\n    fun getVistas(): List<PanoramaVista> = vistas\r\n\r\n    /**\r\n     * Busca y devuelve una vista específica por su ID.\r\n     * (Lo usará PanoramaScreen para saber qué cargar).\r\n     */\r\n    fun getVistaPorId(id: String): PanoramaVista? = vistas.find { it.id == id }\r\n}
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/nextapp/monasterio/data/MonasteryMap.kt b/app/src/main/java/com/nextapp/monasterio/data/MonasteryMap.kt
+--- a/app/src/main/java/com/nextapp/monasterio/data/MonasteryMap.kt	(revision 570f853e0a8794a5c77d81e58b9320cee907e307)
++++ b/app/src/main/java/com/nextapp/monasterio/data/MonasteryMap.kt	(date 1764786895983)
+@@ -33,198 +33,6 @@
+ 
+     // Lista completa de las 32 vistas panorámicas
+     private val vistas = listOf(
+-        PanoramaVista(
+-            id = "monastery_1",
+-            nombre = "Monastery 1", // <-- Cambia este nombre por el real
+-            imagenResId = R.raw.monastery_1,
+-            hotspots = emptyList() // <-- Añadiremos los hotspots después
+-        ),
+-        PanoramaVista(
+-            id = "monastery_2",
+-            nombre = "Monastery 2",
+-            imagenResId = R.raw.monastery_2,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_3",
+-            nombre = "Monastery 3",
+-            imagenResId = R.raw.monastery_3,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_4",
+-            nombre = "Monastery 4",
+-            imagenResId = R.raw.monastery_4,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_5",
+-            nombre = "Monastery 5",
+-            imagenResId = R.raw.monastery_5,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_6",
+-            nombre = "Monastery 6",
+-            imagenResId = R.raw.monastery_6,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_7",
+-            nombre = "Monastery 7",
+-            imagenResId = R.raw.monastery_7,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_8",
+-            nombre = "Monastery 8",
+-            imagenResId = R.raw.monastery_8,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_9",
+-            nombre = "Monastery 9",
+-            imagenResId = R.raw.monastery_9,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_10",
+-            nombre = "Monastery 10",
+-            imagenResId = R.raw.monastery_10,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_11",
+-            nombre = "Monastery 11",
+-            imagenResId = R.raw.monastery_11,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_12",
+-            nombre = "Monastery 12",
+-            imagenResId = R.raw.monastery_12,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_13",
+-            nombre = "Monastery 13",
+-            imagenResId = R.raw.monastery_13,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_14",
+-            nombre = "Monastery 14",
+-            imagenResId = R.raw.monastery_14,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_15",
+-            nombre = "Monastery 15",
+-            imagenResId = R.raw.monastery_15,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_16",
+-            nombre = "Monastery 16",
+-            imagenResId = R.raw.monastery_16,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_17",
+-            nombre = "Monastery 17",
+-            imagenResId = R.raw.monastery_17,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_18",
+-            nombre = "Monastery 18",
+-            imagenResId = R.raw.monastery_18,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_19",
+-            nombre = "Monastery 19",
+-            imagenResId = R.raw.monastery_19,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_20",
+-            nombre = "Monastery 20",
+-            imagenResId = R.raw.monastery_20,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_21",
+-            nombre = "Monastery 21",
+-            imagenResId = R.raw.monastery_21,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_22",
+-            nombre = "Monastery 22",
+-            imagenResId = R.raw.monastery_22,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_23",
+-            nombre = "Monastery 23",
+-            imagenResId = R.raw.monastery_23,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_24",
+-            nombre = "Monastery 24",
+-            imagenResId = R.raw.monastery_24,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_25",
+-            nombre = "Monastery 25",
+-            imagenResId = R.raw.monastery_25,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_26",
+-            nombre = "Monastery 26",
+-            imagenResId = R.raw.monastery_26,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_27",
+-            nombre = "Monastery 27",
+-            imagenResId = R.raw.monastery_27,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_28",
+-            nombre = "Monastery 28",
+-            imagenResId = R.raw.monastery_28,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "monastery_29",
+-            nombre = "Monastery 29",
+-            imagenResId = R.raw.monastery_29,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "entrada",
+-            nombre = "Entrada",
+-            imagenResId = R.raw.entrada,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "entrada_2",
+-            nombre = "Entrada 2",
+-            imagenResId = R.raw.entrada_2,
+-            hotspots = emptyList()
+-        ),
+-        PanoramaVista(
+-            id = "entrada_3",
+-            nombre = "Entrada 3",
+-            imagenResId = R.raw.entrada_3,
+-            hotspots = emptyList()
+-        ),
+         PanoramaVista(
+             id = "entrada_4",
+             nombre = "Entrada 4",
Index: .idea/shelf/Uncommitted_changes_before_Update_at_04_12_2025_19_03_[Changes]/shelved.patch
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_04_12_2025_19_03_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_04_12_2025_19_03_[Changes]/shelved.patch
new file mode 100644
--- /dev/null	(date 1764871406860)
+++ b/.idea/shelf/Uncommitted_changes_before_Update_at_04_12_2025_19_03_[Changes]/shelved.patch	(date 1764871406860)
@@ -0,0 +1,2779 @@
+Index: app/src/main/java/com/nextapp/monasterio/ui/screens/VirtualVisitScreen.kt
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.DisposableEffect\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.navigation.NavHostController\r\nimport androidx.navigation.NavType\r\nimport androidx.navigation.navArgument\r\nimport androidx.navigation.compose.NavHost\r\nimport androidx.navigation.compose.composable\r\nimport androidx.navigation.compose.rememberNavController\r\nimport com.nextapp.monasterio.AppRoutes\r\nimport com.nextapp.monasterio.ui.virtualvisit.screens.*\r\nimport com.nextapp.monasterio.viewModels.AjustesViewModel\r\n\r\nobject VirtualVisitRoutes {\r\n    const val PLANO = \"plano\"\r\n    const val DETALLE_GENERICO = \"detalle_generico\"\r\n}\r\n\r\n@Composable\r\nfun VirtualVisitScreen(navController: NavHostController? = null, viewModel: AjustesViewModel) {\r\n    val localNavController = rememberNavController()\r\n\r\n    val context = LocalContext.current\r\n    val activity = (context as? Activity)\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n        onDispose {}\r\n    }\r\n\r\n    // \uD83D\uDD39 ID inicial del plano por defecto (exterior)\r\n    val initialPlanoId = \"monasterio_exterior\"\r\n\r\n    NavHost(\r\n        navController = localNavController,\r\n        // \uD83D\uDC47 Empieza directamente en el plano exterior\r\n        startDestination = \"${VirtualVisitRoutes.PLANO}/$initialPlanoId\"\r\n    ) {\r\n        // --- \uD83D\uDD39 Ruta base sin argumento (por si alguien navega a \"plano\" directamente)\r\n        composable(VirtualVisitRoutes.PLANO) {\r\n            PlanoScreen(\r\n                viewModel = viewModel,\r\n                planoId = initialPlanoId,\r\n                navController = localNavController,\r\n                rootNavController = navController\r\n            )\r\n        }\r\n\r\n        // --- \uD83D\uDD39 Ruta con parámetro (para navegación entre planos)\r\n        composable(\r\n            route = \"${VirtualVisitRoutes.PLANO}/{planoId}\",\r\n            arguments = listOf(navArgument(\"planoId\") { type = NavType.StringType })\r\n        ) { backStackEntry ->\r\n            val planoId = backStackEntry.arguments?.getString(\"planoId\") ?: initialPlanoId\r\n            PlanoScreen(\r\n                viewModel = viewModel,\r\n                planoId = planoId,\r\n                navController = localNavController,\r\n                rootNavController = navController\r\n            )\r\n        }\r\n\r\n        // --- \uD83D\uDD39 Pantalla de detalle de Pin\r\n        composable(\r\n            route = AppRoutes.PIN_DETALLE + \"/{pinId}\",\r\n            arguments = listOf(navArgument(\"pinId\") { type = NavType.StringType })\r\n        ) { backStackEntry ->\r\n            val pinId = backStackEntry.arguments?.getString(\"pinId\") ?: \"\"\r\n\r\n            PinDetalleFirestoreScreen(\r\n                viewModel = viewModel,\r\n                pinId = pinId,\r\n                navController = localNavController,\r\n                rootNavController = navController\r\n            )\r\n        }\r\n\r\n        // --- \uD83D\uDD39 Pantalla genérica de detalle de Figura\r\n        composable(\r\n            route = \"${VirtualVisitRoutes.DETALLE_GENERICO}/{figuraId}\",\r\n            arguments = listOf(navArgument(\"figuraId\") { type = NavType.StringType })\r\n        ) { backStackEntry ->\r\n            val figuraId = backStackEntry.arguments?.getString(\"figuraId\") ?: \"\"\r\n            DetalleFiguraScreen(\r\n                navController = localNavController,\r\n                figuraId = figuraId\r\n            )\r\n        }\r\n    }\r\n}
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/VirtualVisitScreen.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/VirtualVisitScreen.kt
+--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/VirtualVisitScreen.kt	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
++++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/VirtualVisitScreen.kt	(date 1764870823438)
+@@ -81,13 +81,16 @@
+ 
+         // --- 🔹 Pantalla genérica de detalle de Figura
+         composable(
+-            route = "${VirtualVisitRoutes.DETALLE_GENERICO}/{figuraId}",
+-            arguments = listOf(navArgument("figuraId") { type = NavType.StringType })
++            route = "${VirtualVisitRoutes.DETALLE_GENERICO}/{nombre}",
++            arguments = listOf(navArgument("nombre") { type = NavType.StringType })
+         ) { backStackEntry ->
+-            val figuraId = backStackEntry.arguments?.getString("figuraId") ?: ""
++            val nombreArg = backStackEntry.arguments?.getString("nombre") ?: ""
++
+             DetalleFiguraScreen(
+                 navController = localNavController,
+-                figuraId = figuraId
++                // 👇 PÁSALE EL NAV CONTROLLER RAÍZ AQUÍ
++                rootNavController = navController, // (navController de la función VirtualVisitScreen es el raíz)
++                nombre = nombreArg
+             )
+         }
+     }
+Index: app/src/main/java/com/nextapp/monasterio/ui/screens/Pin360Screen.kt
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.content.Context\r\nimport android.graphics.Bitmap\r\nimport android.graphics.drawable.BitmapDrawable\r\nimport android.util.Log\r\nimport android.view.MotionEvent\r\nimport android.view.View\r\nimport android.widget.FrameLayout\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.ExperimentalComposeUiApi\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.input.pointer.pointerInteropFilter\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.viewinterop.AndroidView\r\nimport androidx.navigation.NavController\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.models.PinData\r\nimport com.nextapp.monasterio.repository.PinRepository\r\nimport com.panoramagl.PLImage\r\nimport com.panoramagl.PLSphericalPanorama\r\nimport com.panoramagl.PLManager\r\nimport coil.ImageLoader\r\nimport coil.request.CachePolicy\r\nimport coil.request.ImageRequest\r\nimport coil.size.Precision\r\nimport coil.size.Scale\r\nimport okhttp3.OkHttpClient\r\nimport java.util.concurrent.TimeUnit\r\n\r\n@OptIn(ExperimentalComposeUiApi::class)\r\n@Composable\r\nfun Pin360Screen(\r\n    pinId: String,\r\n    navController: NavController\r\n) {\r\n    val context = LocalContext.current\r\n\r\n    // Estados\r\n    var pin by remember { mutableStateOf<PinData?>(null) }\r\n    var isLoading by remember { mutableStateOf(true) }\r\n    var errorMessage by remember { mutableStateOf<String?>(null) }\r\n    var bitmap by remember { mutableStateOf<Bitmap?>(null) }\r\n\r\n    // 1. Cargar datos del Pin\r\n    LaunchedEffect(pinId) {\r\n        isLoading = true\r\n        try {\r\n            val loadedPin = PinRepository.getPinById(pinId)\r\n            if (loadedPin?.vista360Url.isNullOrBlank()) {\r\n                errorMessage = \"Pin no encontrado o no tiene URL 360\"\r\n                isLoading = false\r\n            } else {\r\n                pin = loadedPin\r\n            }\r\n        } catch (e: Exception) {\r\n            errorMessage = \"Error al cargar pin: ${e.message}\"\r\n            isLoading = false\r\n        }\r\n    }\r\n\r\n    // 2. Descargar imagen (Con timeout largo)\r\n    LaunchedEffect(pin) {\r\n        if (pin != null) {\r\n            val url = pin!!.vista360Url\r\n            Log.d(\"Pin360\", \"Iniciando descarga de: $url\")\r\n\r\n            val customOkHttpClient = OkHttpClient.Builder()\r\n                .connectTimeout(30, TimeUnit.SECONDS)\r\n                .readTimeout(60, TimeUnit.SECONDS)\r\n                .build()\r\n\r\n            val customImageLoader = ImageLoader.Builder(context)\r\n                .okHttpClient(customOkHttpClient)\r\n                .diskCachePolicy(CachePolicy.ENABLED)\r\n                .networkCachePolicy(CachePolicy.ENABLED)\r\n                .build()\r\n\r\n            val request = ImageRequest.Builder(context)\r\n                .data(url)\r\n                .allowHardware(false)\r\n                .listener(\r\n                    onSuccess = { _, _ -> Log.d(\"Pin360\", \"✅ Imagen descargada correctamente\") },\r\n                    onError = { _, result ->\r\n                        Log.e(\"Pin360\", \"❌ Error descarga: ${result.throwable.message}\")\r\n                        errorMessage = \"Error de carga\"\r\n                        isLoading = false\r\n                    }\r\n                )\r\n                .target { drawable ->\r\n                    bitmap = (drawable as BitmapDrawable).bitmap\r\n                    isLoading = false\r\n                }\r\n                .build()\r\n\r\n            customImageLoader.execute(request)\r\n        }\r\n    }\r\n\r\n    // --- UI ---\r\n    Box(\r\n        modifier = Modifier\r\n            .fillMaxSize()\r\n            .background(Color.Black)\r\n    ) {\r\n        // 3. VISTA PERSONALIZADA CON \"WATCHDOG\" (REINTENTOS)\r\n        if (bitmap != null && errorMessage == null) {\r\n            AndroidView(\r\n                factory = { ctx ->\r\n                    PanoramaView(ctx).apply {\r\n                        setBitmap(bitmap!!)\r\n                    }\r\n                },\r\n                modifier = Modifier\r\n                    .fillMaxSize()\r\n                    // Importante: Dejamos que la vista maneje sus toques\r\n                    .pointerInteropFilter { false }\r\n            )\r\n        }\r\n\r\n        when {\r\n            isLoading -> {\r\n                Column(\r\n                    modifier = Modifier.align(Alignment.Center),\r\n                    horizontalAlignment = Alignment.CenterHorizontally\r\n                ) {\r\n                    CircularProgressIndicator(color = Color.White)\r\n                    Spacer(modifier = Modifier.height(16.dp))\r\n                    Text(\"Cargando experiencia 360...\", color = Color.White)\r\n                }\r\n            }\r\n            errorMessage != null -> {\r\n                Text(\r\n                    text = errorMessage!!,\r\n                    color = MaterialTheme.colorScheme.error,\r\n                    modifier = Modifier.align(Alignment.Center).padding(16.dp)\r\n                )\r\n            }\r\n        }\r\n\r\n        IconButton(\r\n            onClick = { navController.popBackStack() },\r\n            modifier = Modifier\r\n                .align(Alignment.TopStart)\r\n                .statusBarsPadding()\r\n                .padding(16.dp)\r\n                .background(Color.Black.copy(alpha = 0.5f), RoundedCornerShape(12.dp))\r\n        ) {\r\n            Icon(\r\n                painter = painterResource(id = R.drawable.arrow_back),\r\n                contentDescription = \"Volver\",\r\n                tint = Color.White\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\n// ======================================================================\r\n// CLASE PERSONALIZADA INTELIGENTE (PANORAMA VIEW)\r\n// ======================================================================\r\nclass PanoramaView(context: Context) : FrameLayout(context) {\r\n    private val plManager: PLManager = PLManager(context)\r\n    private var isInit = false\r\n    private var currentBitmap: Bitmap? = null\r\n\r\n    // Variables para el sistema de reintentos (Watchdog)\r\n    private val watchdogHandler = android.os.Handler(android.os.Looper.getMainLooper())\r\n    private var retryCount = 0\r\n    private val maxRetries = 5\r\n\r\n    init {\r\n        plManager.setContentView(this)\r\n        plManager.onCreate()\r\n        plManager.setInertiaEnabled(false)\r\n        plManager.isAcceleratedTouchScrollingEnabled = false\r\n    }\r\n\r\n    fun setBitmap(bitmap: Bitmap) {\r\n        if (isInit) return\r\n        this.currentBitmap = bitmap\r\n\r\n        try {\r\n            loadPanoramaImage()\r\n            isInit = true\r\n            startRenderWatchdog()\r\n        } catch (e: Throwable) {\r\n            Log.e(\"PanoramaView\", \"Error inicial setBitmap\", e)\r\n        }\r\n    }\r\n\r\n    private fun loadPanoramaImage() {\r\n        currentBitmap?.let { bmp ->\r\n            val panorama = PLSphericalPanorama()\r\n            panorama.camera.lookAt(0.0f, 0.0f)\r\n            panorama.setImage(PLImage(bmp, false))\r\n            plManager.panorama = panorama\r\n        }\r\n    }\r\n\r\n    private val renderRunnable = object : Runnable {\r\n        override fun run() {\r\n            if (retryCount < maxRetries && isAttachedToWindow) {\r\n                Log.d(\"PanoramaView\", \"\uD83D\uDD04 Watchdog: Forzando onResume (Intento ${retryCount + 1})\")\r\n                plManager.onResume()\r\n                invalidate()\r\n                requestLayout()\r\n                retryCount++\r\n                watchdogHandler.postDelayed(this, 500)\r\n            } else {\r\n                Log.d(\"PanoramaView\", \"✅ Watchdog finalizado.\")\r\n            }\r\n        }\r\n    }\r\n\r\n    private fun startRenderWatchdog() {\r\n        retryCount = 0\r\n        watchdogHandler.removeCallbacks(renderRunnable)\r\n        watchdogHandler.post(renderRunnable)\r\n    }\r\n\r\n    override fun onAttachedToWindow() {\r\n        super.onAttachedToWindow()\r\n        Log.d(\"PanoramaView\", \"onAttachedToWindow -> Reiniciando Watchdog\")\r\n        plManager.onResume()\r\n        startRenderWatchdog()\r\n    }\r\n\r\n    override fun onDetachedFromWindow() {\r\n        super.onDetachedFromWindow()\r\n        Log.d(\"PanoramaView\", \"onDetachedFromWindow -> Limpiando\")\r\n        watchdogHandler.removeCallbacks(renderRunnable)\r\n        plManager.onPause()\r\n        plManager.onDestroy()\r\n    }\r\n\r\n    // \uD83D\uDC47\uD83D\uDC47 AQUÍ ESTÁ LA CORRECCIÓN: Quitamos el '?' de MotionEvent \uD83D\uDC47\uD83D\uDC47\r\n    override fun onTouchEvent(event: MotionEvent): Boolean {\r\n        return try {\r\n            plManager.onTouchEvent(event)\r\n        } catch (e: Exception) {\r\n            Log.w(\"PanoramaView\", \"Ignorando crash táctil interno: ${e.message}\")\r\n            true\r\n        }\r\n    }\r\n}
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/Pin360Screen.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/Pin360Screen.kt
+--- a/app/src/main/java/com/nextapp/monasterio/ui/screens/Pin360Screen.kt	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
++++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/Pin360Screen.kt	(date 1764870110148)
+@@ -9,6 +9,7 @@
+ import android.widget.FrameLayout
+ import androidx.compose.foundation.background
+ import androidx.compose.foundation.layout.*
++import androidx.compose.foundation.shape.CircleShape
+ import androidx.compose.foundation.shape.RoundedCornerShape
+ import androidx.compose.material3.*
+ import androidx.compose.runtime.*
+@@ -35,6 +36,10 @@
+ import coil.size.Scale
+ import okhttp3.OkHttpClient
+ import java.util.concurrent.TimeUnit
++import com.nextapp.monasterio.utils.AudioPlayerManager
++import androidx.compose.ui.platform.LocalConfiguration
++import com.nextapp.monasterio.repository.FiguraRepository
++import java.util.Locale
+ 
+ @OptIn(ExperimentalComposeUiApi::class)
+ @Composable
+@@ -50,19 +55,78 @@
+     var errorMessage by remember { mutableStateOf<String?>(null) }
+     var bitmap by remember { mutableStateOf<Bitmap?>(null) }
+ 
++    // 1. OBTENER IDIOMA Y URL DE AUDIO
++    val configuration = LocalConfiguration.current
++    val language = configuration.locales[0].language
++
++    // Calculamos la URL del audio igual que en la pantalla anterior
++    val audioUrl = remember(pin, language) {
++        pin?.let { p ->
++            val selectedUrl = when (language) {
++                "es" -> p.audioUrl_es
++                "en" -> p.audioUrl_en
++                "de" -> p.audioUrl_de
++                "fr" -> p.audioUrl_fr
++                else -> p.audioUrl_es
++            }
++            selectedUrl.takeIf { !it.isNullOrBlank() } ?: p.audioUrl_en
++        }
++    }
++
++    // 2. CONECTAR CON EL GESTOR DE AUDIO GLOBAL
++    // Esto nos dice si está sonando ahora mismo para poner el icono de Pausa o Play
++    val isAudioPlaying by AudioPlayerManager.isPlaying.collectAsState()
++    var hasUserInteracted by remember { mutableStateOf(false) }
++    DisposableEffect(Unit) {
++        onDispose {
++            // Al salir de la pantalla (Back o Destroy), pausamos el audio global
++            AudioPlayerManager.pause()
++        }
++    }
+     // 1. Cargar datos del Pin
++    // 1. Cargar datos (Buscando en Pines Y en Figuras)
+     LaunchedEffect(pinId) {
+         isLoading = true
+         try {
+-            val loadedPin = PinRepository.getPinById(pinId)
+-            if (loadedPin?.vista360Url.isNullOrBlank()) {
+-                errorMessage = "Pin no encontrado o no tiene URL 360"
+-                isLoading = false
++            // INTENTO 1: Buscar como Pin normal
++            val loadedData = PinRepository.getPinById(pinId)
++
++            if (loadedData != null) {
++                // Es un Pin real
++                pin = loadedData
+             } else {
+-                pin = loadedPin
++                // INTENTO 2: Buscar como Figura (Arco, Iglesia...)
++                val figura = FiguraRepository.getFiguraById(pinId)
++                if (figura != null) {
++                    // ¡Truco! Creamos un PinData temporal.
++                    // Rellenamos los datos obligatorios que faltaban con valores vacíos o ceros.
++                    pin = PinData(
++                        id = figura.id,
++                        titulo = figura.nombre,
++                        // 👇 RELLENAMOS LO QUE FALTABA PARA CORREGIR EL ERROR 👇
++                        tituloIngles = "",
++                        tituloAleman = "",
++                        tituloFrances = "",
++                        x = 0f,
++                        y = 0f,
++                        // -------------------------------------------------------
++                        descripcion = figura.descripcion,
++                        vista360Url = figura.vista360Url,
++                        // Mapeamos los audios
++                        audioUrl_es = figura.audioUrl_es,
++                        audioUrl_en = figura.audioUrl_en,
++                        audioUrl_de = figura.audioUrl_de,
++                        audioUrl_fr = figura.audioUrl_fr
++                    )
++                }
++            }
++
++            if (pin?.vista360Url.isNullOrBlank()) {
++                errorMessage = "No se encontró imagen 360 para este elemento."
++                isLoading = false
+             }
+         } catch (e: Exception) {
+-            errorMessage = "Error al cargar pin: ${e.message}"
++            errorMessage = "Error de carga: ${e.message}"
+             isLoading = false
+         }
+     }
+@@ -160,6 +224,32 @@
+                 tint = Color.White
+             )
+         }
++        if (!audioUrl.isNullOrBlank()) {
++            val iconRes = when {
++                isAudioPlaying -> R.drawable.pause
++                !hasUserInteracted -> R.drawable.sound
++                else -> R.drawable.play_arrow
++            }
++            IconButton(
++                onClick = {
++                    hasUserInteracted = true
++                    AudioPlayerManager.initialize(context)
++                    AudioPlayerManager.playOrPause(audioUrl!!)
++                },
++                modifier = Modifier
++                    .align(Alignment.TopEnd) // 👈 Esquina Superior Derecha
++                    .statusBarsPadding()
++                    .padding(16.dp)
++                    .background(Color.Black.copy(alpha = 0.5f), CircleShape)
++            ) {
++                Icon(
++                    painter = painterResource(id = iconRes),
++                    contentDescription = "Audio",
++                    tint = Color.White,
++                    modifier = Modifier.size(24.dp)
++                )
++            }
++        }
+     }
+ }
+ 
+Index: app/src/main/java/com/nextapp/monasterio/models/FiguraData.kt
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.nextapp.monasterio.models\r\n\r\nimport com.google.firebase.firestore.DocumentReference\r\n\r\ndata class FiguraData(\r\n    var id: String = \"\",\r\n    var nombre: String = \"\",\r\n    var offsetX: Float = 0f,\r\n    var offsetY: Float = 0f,\r\n    var scale: Float = 1f,\r\n    var colorResaltado: Long = 0,\r\n    var tipoDestino: String = \"\",\r\n    var valorDestino: String = \"\",\r\n    var path: List<Point> = emptyList(), //Nuevos campos para DetalleFiguraScreen\r\n    var info_es: String = \"\",\r\n    var info_en: String = \"\",\r\n    var info_de: String = \"\",\r\n    var info_fr: String = \"\",\r\n    var imagenes: List<DocumentReference> = emptyList() // Array de referencias a documentos en la colección 'imagenes'\r\n\r\n) {\r\n    data class Point(\r\n        val x: Float = 0f,\r\n        val y: Float = 0f\r\n    )\r\n}
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/nextapp/monasterio/models/FiguraData.kt b/app/src/main/java/com/nextapp/monasterio/models/FiguraData.kt
+--- a/app/src/main/java/com/nextapp/monasterio/models/FiguraData.kt	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
++++ b/app/src/main/java/com/nextapp/monasterio/models/FiguraData.kt	(date 1764868956974)
+@@ -1,26 +1,41 @@
+ package com.nextapp.monasterio.models
+ 
+-import com.google.firebase.firestore.DocumentReference
+-
+ data class FiguraData(
+-    var id: String = "",
+-    var nombre: String = "",
+-    var offsetX: Float = 0f,
+-    var offsetY: Float = 0f,
+-    var scale: Float = 1f,
+-    var colorResaltado: Long = 0,
+-    var tipoDestino: String = "",
+-    var valorDestino: String = "",
+-    var path: List<Point> = emptyList(), //Nuevos campos para DetalleFiguraScreen
+-    var info_es: String = "",
+-    var info_en: String = "",
+-    var info_de: String = "",
+-    var info_fr: String = "",
+-    var imagenes: List<DocumentReference> = emptyList() // Array de referencias a documentos en la colección 'imagenes'
++    val id: String = "",
++    val nombre: String = "",
++    val descripcion: String = "",
++    // Cambiamos a List<String> para guardar solo los IDs
++    val imagenes: List<String> = emptyList(),
++
++    // Textos multilenguaje
++    val info_es: String = "",
++    val info_en: String = "",
++    val info_de: String = "",
++    val info_fr: String = "",
+ 
+-) {
+-    data class Point(
+-        val x: Float = 0f,
+-        val y: Float = 0f
+-    )
+-}
+\ No newline at end of file
++    // Geometría
++    val path: List<Punto> = emptyList(),
++    val escala: Float = 1f,
++    val colorResaltado: Long = 0xFFFFFFFF,
++    val offsetX: Float = 0f,
++    val offsetY: Float = 0f,
++    val scale: Float = 1f,
++
++    // Navegación
++    val tipoDestino: String = "",
++    val valorDestino: String = "",
++
++    // Audio
++    val audioUrl_es: String? = null,
++    val audioUrl_en: String? = null,
++    val audioUrl_de: String? = null,
++    val audioUrl_fr: String? = null,
++
++    // 👇👇 AÑADE ESTO PARA ARREGLAR EL ERROR "Unresolved reference" 👇👇
++    val vista360Url: String? = null
++)
++
++data class Punto(
++    val x: Float = 0f,
++    val y: Float = 0f
++)
+\ No newline at end of file
+Index: app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.nextapp.monasterio.ui.navigation\r\n\r\nimport androidx.compose.foundation.clickable\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.rememberScrollState\r\nimport androidx.compose.foundation.verticalScroll\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.lifecycle.viewmodel.compose.viewModel\r\nimport androidx.navigation.NavGraph.Companion.findStartDestination\r\nimport androidx.navigation.NavHostController\r\nimport androidx.navigation.NavType\r\nimport androidx.navigation.navArgument\r\nimport androidx.navigation.compose.NavHost\r\nimport androidx.navigation.compose.composable\r\nimport com.nextapp.monasterio.AppRoutes\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.models.ParejasData\r\nimport com.nextapp.monasterio.models.ParejasSize\r\n/*import com.nextapp.monasterio.models.ParejasData*/\r\nimport com.nextapp.monasterio.models.PuzzleSize\r\nimport com.nextapp.monasterio.ui.screens.* // Asegúrate de importar PanoramaScreen y GaleriaScreen\r\nimport com.nextapp.monasterio.ui.screens.pinEdition.EdicionFondoInicio\r\nimport com.nextapp.monasterio.ui.screens.pinEdition.EdicionPines\r\nimport com.nextapp.monasterio.ui.screens.pinEdition.EdicionPinesHost\r\nimport com.nextapp.monasterio.ui.theme.MonasteryRed\r\nimport com.nextapp.monasterio.ui.theme.White\r\nimport com.nextapp.monasterio.ui.virtualvisit.screens.DetalleFiguraScreen\r\nimport com.nextapp.monasterio.ui.virtualvisit.screens.EntradaMonasterioFirestoreScreen\r\nimport com.nextapp.monasterio.ui.virtualvisit.screens.PinDetalleScreen\r\nimport com.nextapp.monasterio.viewModels.AjustesViewModel\r\nimport com.nextapp.monasterio.viewModels.InfoViewModel\r\nimport com.nextapp.monasterio.viewModels.HistoriaViewModel\r\nimport com.nextapp.monasterio.viewModels.AuthViewModel\r\nimport kotlinx.coroutines.CoroutineScope\r\nimport kotlinx.coroutines.launch\r\n\r\n@Composable\r\nfun AppNavigationHost(\r\n    modifier: Modifier = Modifier,\r\n    authViewModel: AuthViewModel = viewModel(),\r\n    historiaViewModel: HistoriaViewModel = viewModel(),\r\n    ajustesViewModel: AjustesViewModel = viewModel(),\r\n    infoViewModel: InfoViewModel = viewModel(),\r\n    navController: NavHostController,\r\n    isEditing: Boolean = false,\r\n    scaffoldPadding: PaddingValues = PaddingValues(0.dp)\r\n) {\r\n    NavHost(\r\n        navController = navController,\r\n        startDestination = AppRoutes.INICIO,\r\n        modifier = modifier\r\n    ) {\r\n        composable(AppRoutes.INICIO)   { HomeScreenContent(navController = navController, topPadding = scaffoldPadding, authViewModel = authViewModel) }\r\n        composable(AppRoutes.HISTORIA) { HistoriaScreen(isEditing = isEditing, viewModel = historiaViewModel,topPadding = scaffoldPadding) }\r\n        composable(AppRoutes.GALERIA)  { GaleriaScreen(navController = navController) }\r\n        composable(AppRoutes.MODO_NINYOS)   { OpcionesModoNiño(navController = navController, topPadding = scaffoldPadding) }\r\n        composable(AppRoutes.VIDEO_NINYOS)   { VideoNinyosScreen(topPadding = scaffoldPadding) }\r\n        composable(AppRoutes.PUZZLENIVEL1){PuzzleScreen(navController=navController,tamaño = PuzzleSize(2,2))}\r\n        composable(AppRoutes.PUZZLENIVEL2){PuzzleScreen(navController=navController,tamaño = PuzzleSize(3,3))}\r\n        composable(AppRoutes.PUZZLENIVEL3){PuzzleScreen(navController=navController,tamaño = PuzzleSize(4,4))}\r\n        composable(AppRoutes.PUZZLENIVEL4){PuzzleScreen(navController=navController,tamaño= PuzzleSize(5,5))}\r\n        composable(AppRoutes.JUEGO_NINYOS){OpcionesJuegoNinyos(navController=navController, topPadding = scaffoldPadding)}\r\n        composable(route=AppRoutes.MODO_EDICION) { OpcionesModoEdicion(navController = navController)}\r\n        composable(AppRoutes.EDICION_FONDO_INICIO) { EdicionFondoInicio(navController = navController) }\r\n        composable(AppRoutes.EDICION_PINES) { EdicionPines(navController) }\r\n        composable(AppRoutes.PERFIL)   { ProfileScreen(isEditing = isEditing, viewModel = authViewModel ) }\r\n        composable(AppRoutes.AJUSTES)  { AjustesScreen(viewModel = ajustesViewModel) }\r\n        composable (AppRoutes.JUEGO_PUZZLE) {JuegoPuzzleScreen(navController = navController, topPadding = scaffoldPadding)}\r\n        composable(AppRoutes.JUEGO_PAREJAS) {JuegoParejasScreen(navController = navController, topPadding = scaffoldPadding)}\r\n        composable(AppRoutes.PAREJASNIVEL1){ParejasScreen(navController=navController, size = ParejasSize(3,2),imagenes= ParejasData.IMAGENES_NIVEL1)}\r\n        composable(AppRoutes.PAREJASNIVEL2){ParejasScreen(navController=navController,size = ParejasSize(4,2),imagenes= ParejasData.IMAGENES_NIVEL2)}\r\n        composable(AppRoutes.PAREJASNIVEL3){ParejasScreen(navController=navController,size = ParejasSize(5,2),imagenes= ParejasData.IMAGENES_NIVEL3)}\r\n        composable(AppRoutes.PAREJASNIVEL4){ParejasScreen(navController=navController,size= ParejasSize(4,3),imagenes= ParejasData.IMAGENES_NIVEL4)}\r\n        composable(AppRoutes.JUEGO_DIFERENCIAS){DiferenciasScreen(navController=navController)}\r\n\r\n        // Ruta de Visita Virtual (Mapa)\r\n        composable(AppRoutes.VIRTUAL_VISIT) {\r\n            VirtualVisitScreen(navController = navController,viewModel = ajustesViewModel)\r\n        }\r\n\r\n        // Ruta al Edición Pines Host\r\n        composable(AppRoutes.EDICION_PINES) {\r\n            EdicionPinesHost(navController)\r\n        }\r\n\r\n\r\n        // --- ¡¡AQUÍ ESTÁ LA NUEVA RUTA!! ---\r\n        // Ruta inmersiva para el 360 de un Pin (desde Firebase URL)\r\n        composable(\r\n            route = AppRoutes.PIN_360 + \"/{pinId}\", // Recibe el ID del Pin\r\n            arguments = listOf(navArgument(\"pinId\") { type = NavType.StringType })\r\n        ) { backStackEntry ->\r\n            val pinId = backStackEntry.arguments?.getString(\"pinId\")\r\n            if (pinId != null) {\r\n                // Llama a la NUEVA pantalla 360\r\n                Pin360Screen(\r\n                    pinId = pinId,\r\n                    navController = navController\r\n                )\r\n            }\r\n        }\r\n\r\n        // --- Pantalla de Entrada del Monasterio (desde Firebase Pin)\r\n        composable(\r\n            route = AppRoutes.PIN_ENTRADA_MONASTERIO + \"/{pinId}\",\r\n            arguments = listOf(navArgument(\"pinId\") { type = NavType.StringType })\r\n        ) { backStackEntry ->\r\n            val pinId = backStackEntry.arguments?.getString(\"pinId\") ?: \"\"\r\n            EntradaMonasterioFirestoreScreen(\r\n                pinId = pinId,\r\n                navController = navController,\r\n                rootNavController = navController\r\n            )\r\n        }\r\n\r\n        // --- FIN DE LA MODIFICACIÓN ---\r\n\r\n        // (La ruta PIN_DETALLE se queda eliminada de aquí, ¡está bien!)\r\n\r\n        // --- RESTO DE TUS RUTAS ---\r\n        composable(AppRoutes.OPCIONES_RESERVA) { OpcionesReservaScreen(navController = navController, topPadding = scaffoldPadding) }\r\n        composable(AppRoutes.RESERVA) { ReservaScreen(navController = navController, topPadding = scaffoldPadding) }\r\n        composable(\r\n            route = AppRoutes.CONFIRMACION_RESERVA + \"/{nombre}/{email}/{fecha}/{hora}\",\r\n            arguments = listOf(\r\n                navArgument(\"nombre\") { type = NavType.StringType },\r\n                navArgument(\"email\") { type = NavType.StringType },\r\n                navArgument(\"fecha\") { type = NavType.StringType },\r\n                navArgument(\"hora\") { type = NavType.StringType }\r\n            )\r\n        ) { backStackEntry ->\r\n            val nombre = backStackEntry.arguments?.getString(\"nombre\") ?: \"\"\r\n            val email = backStackEntry.arguments?.getString(\"email\") ?: \"\"\r\n            val fecha = backStackEntry.arguments?.getString(\"fecha\") ?: \"\"\r\n            val hora = backStackEntry.arguments?.getString(\"hora\") ?: \"\"\r\n            ConfirmacionReservaScreen(\r\n                navController = navController,\r\n                nombre = nombre,\r\n                email = email,\r\n                fecha = fecha,\r\n                hora = hora\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\n//\r\n// --- EL RESTO DEL ARCHIVO (AppDrawerContent y DrawerMenuItem) SE QUEDA IGUAL ---\r\n//\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun AppDrawerContent(\r\n    navController: NavHostController,\r\n    scope: CoroutineScope,\r\n    drawerState: DrawerState\r\n) {\r\n    val navigateTo: (String) -> Unit = { route ->\r\n        navController.navigate(route) {\r\n            popUpTo(navController.graph.findStartDestination().id)\r\n            launchSingleTop = true\r\n        }\r\n        scope.launch { drawerState.close() }\r\n    }\r\n\r\n    ModalDrawerSheet(\r\n        modifier = Modifier.fillMaxHeight(),\r\n        drawerContainerColor = MonasteryRed,\r\n        drawerContentColor = White\r\n    ) {\r\n        Column(\r\n            modifier = Modifier\r\n                .fillMaxSize()\r\n                .verticalScroll(rememberScrollState())\r\n                .padding(16.dp)\r\n        ) {\r\n            IconButton(onClick = { scope.launch { drawerState.close() } }) {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.ic_menu_24),\r\n                    contentDescription = stringResource(id = R.string.navigation_drawer_close)\r\n                )\r\n            }\r\n            Spacer(modifier = Modifier.height(32.dp))\r\n\r\n            DrawerMenuItem(text = stringResource(id = R.string.title_inicio)) { navigateTo(AppRoutes.INICIO) }\r\n            DrawerMenuItem(text = stringResource(id = R.string.menu_info)) { navigateTo(AppRoutes.PIN_ENTRADA_MONASTERIO+\"/\" + \"pin_entrada\") }\r\n            DrawerMenuItem(text = stringResource(id = R.string.menu_history)) { navigateTo(AppRoutes.HISTORIA) }\r\n            DrawerMenuItem(text = stringResource(id = R.string.menu_gallery)) { navigateTo(AppRoutes.GALERIA) }\r\n            DrawerMenuItem(text = stringResource(id = R.string.menu_profile)) { navigateTo(AppRoutes.PERFIL) }\r\n            DrawerMenuItem(text = stringResource(id = R.string.menu_settings)) { navigateTo(AppRoutes.AJUSTES) }\r\n        }\r\n    }\r\n}\r\n\r\n@Composable\r\nfun DrawerMenuItem(text: String, onClick: () -> Unit) {\r\n    Row(\r\n        modifier = Modifier\r\n            .fillMaxWidth()\r\n            .clickable(onClick = onClick)\r\n            .padding(vertical = 12.dp),\r\n        verticalAlignment = Alignment.CenterVertically\r\n    ) {\r\n        Icon(\r\n            painter = painterResource(id = R.drawable.arrow_right),\r\n            contentDescription = null,\r\n            modifier = Modifier.size(20.dp)\r\n        )\r\n        Spacer(modifier = Modifier.width(16.dp))\r\n        Text(text = text, color = White, style = MaterialTheme.typography.bodyMedium)\r\n    }\r\n}
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt b/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt
+--- a/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
++++ b/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt	(date 1764870523974)
+@@ -93,12 +93,11 @@
+         // --- ¡¡AQUÍ ESTÁ LA NUEVA RUTA!! ---
+         // Ruta inmersiva para el 360 de un Pin (desde Firebase URL)
+         composable(
+-            route = AppRoutes.PIN_360 + "/{pinId}", // Recibe el ID del Pin
++            route = AppRoutes.PIN_360 + "/{pinId}",
+             arguments = listOf(navArgument("pinId") { type = NavType.StringType })
+         ) { backStackEntry ->
+             val pinId = backStackEntry.arguments?.getString("pinId")
+             if (pinId != null) {
+-                // Llama a la NUEVA pantalla 360
+                 Pin360Screen(
+                     pinId = pinId,
+                     navController = navController
+Index: app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PinDetalleScreen.kt
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.nextapp.monasterio.ui.virtualvisit.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport android.util.Log\r\nimport androidx.compose.foundation.*\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.pager.HorizontalPager\r\nimport androidx.compose.foundation.pager.rememberPagerState\r\nimport androidx.compose.foundation.shape.CircleShape\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.BiasAlignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.draw.clip\r\nimport androidx.compose.ui.geometry.Offset\r\nimport androidx.compose.ui.geometry.Size\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.layout.ContentScale\r\nimport androidx.compose.ui.layout.onGloballyPositioned\r\nimport androidx.compose.ui.layout.positionInRoot\r\nimport androidx.compose.ui.platform.LocalConfiguration\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.platform.LocalView\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.text.font.FontWeight\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.unit.sp\r\nimport androidx.compose.ui.viewinterop.AndroidView\r\nimport androidx.compose.ui.window.Dialog\r\nimport androidx.compose.ui.window.DialogProperties\r\nimport androidx.core.view.WindowCompat\r\nimport androidx.media3.common.MediaItem\r\nimport androidx.media3.common.Player\r\nimport androidx.media3.exoplayer.ExoPlayer\r\nimport coil.compose.AsyncImage\r\nimport coil.load\r\nimport com.github.chrisbanes.photoview.PhotoView\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.models.PinData\r\nimport com.nextapp.monasterio.models.Ubicacion\r\nimport com.nextapp.monasterio.ui.virtualvisit.components.GenericTutorialOverlay\r\nimport com.nextapp.monasterio.viewModels.AjustesViewModel\r\nimport java.util.Locale\r\n\r\n// Clase privada para definir los pasos del tutorial del Pin de forma dinámica\r\nprivate data class PinTutorialStep(\r\n    val description: String,\r\n    val focusCenter: Offset,\r\n    val focusRadius: Float = 0f,      // Para círculos\r\n    val rectSize: Size? = null,       // Para cuadrados/rectángulos\r\n    val alignment: Alignment = Alignment.BottomCenter // Dónde poner el cuadro de texto\r\n)\r\n\r\n@OptIn(ExperimentalFoundationApi::class)\r\n@Composable\r\nfun PinDetalleScreen(\r\n    viewModel: AjustesViewModel,\r\n    pin: PinData,\r\n    onBack: () -> Unit,\r\n    onVer360: (() -> Unit)? = null\r\n) {\r\n    // --- Configuración de Ventana y Orientación ---\r\n    val view = LocalView.current\r\n    LaunchedEffect(Unit) {\r\n        val window = (view.context as? Activity)?.window\r\n        window?.let { WindowCompat.setDecorFitsSystemWindows(it, false) }\r\n    }\r\n\r\n    val activity = view.context as? Activity\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT\r\n        onDispose {\r\n            activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED\r\n        }\r\n    }\r\n\r\n    // --- LÓGICA DE ESTADO DEL TUTORIAL ---\r\n    val isPinDismissed by viewModel.isPinDismissed.collectAsState()\r\n    var showTutorialSession by remember { mutableStateOf(true) }\r\n    var currentStepIndex by remember { mutableIntStateOf(0) }\r\n\r\n    // --- VARIABLES PARA CAPTURAR POSICIONES REALES (LAYOUT) ---\r\n    // Estas variables se llenarán cuando Android dibuje la pantalla\r\n    var backButtonLayout by remember { mutableStateOf<Pair<Offset, Size>?>(null) }\r\n    var imageLayout by remember { mutableStateOf<Pair<Offset, Size>?>(null) }\r\n    var audioButtonLayout by remember { mutableStateOf<Pair<Offset, Size>?>(null) }\r\n    var button360Layout by remember { mutableStateOf<Pair<Offset, Size>?>(null) }\r\n\r\n    // --- Datos del Pin ---\r\n    val imagenes = if (pin.imagenesDetalladas.isNotEmpty()) pin.imagenesDetalladas else emptyList()\r\n    val pagerState = rememberPagerState(pageCount = { imagenes.size })\r\n    var selectedImageUrl by remember { mutableStateOf<String?>(null) }\r\n    var selectedImageTitle by remember { mutableStateOf<String?>(null) }\r\n\r\n    val configuration = LocalConfiguration.current\r\n    val locale: Locale = configuration.locales[0]\r\n    val language = locale.language\r\n\r\n    // --- Textos Multilingües ---\r\n    val titulo_pin: String\r\n    val descripcion_pin: String?\r\n    val ubicacion_pin: Ubicacion?\r\n\r\n    when (language) {\r\n        \"es\" -> {\r\n            titulo_pin = pin.titulo\r\n            descripcion_pin = pin.descripcion\r\n            ubicacion_pin = pin.ubicacion\r\n        }\r\n        \"de\" -> {\r\n            titulo_pin = pin.tituloAleman\r\n            descripcion_pin = pin.descripcionAleman\r\n            ubicacion_pin = pin.ubicacionAleman\r\n        }\r\n        \"fr\" -> {\r\n            titulo_pin = pin.tituloFrances\r\n            descripcion_pin = pin.descripcionFrances\r\n            ubicacion_pin = pin.ubicacionFrances\r\n        }\r\n        else -> {\r\n            titulo_pin = pin.tituloIngles\r\n            descripcion_pin = pin.descripcionIngles\r\n            ubicacion_pin = pin.ubicacionIngles\r\n        }\r\n    }\r\n\r\n    // --- LÓGICA DE AUDIO ---\r\n    val context = LocalContext.current\r\n    val audioUrl = when (language) {\r\n        \"en\" -> pin.audioUrl_en\r\n        \"de\" -> pin.audioUrl_de\r\n        \"fr\" -> pin.audioUrl_fr\r\n        else -> pin.audioUrl_es\r\n    }\r\n\r\n    Log.d(\"AudioDebug\", \"Pin: '${pin.titulo}', Idioma: $language, URL Audio: [$audioUrl]\")\r\n\r\n    val exoPlayer = remember { ExoPlayer.Builder(context).build() }\r\n    var isPlaying by remember { mutableStateOf(false) }\r\n    var hasUserInteracted by remember { mutableStateOf(false) }\r\n\r\n    DisposableEffect(audioUrl) {\r\n        if (!audioUrl.isNullOrBlank()) {\r\n            val mediaItem = MediaItem.fromUri(audioUrl)\r\n            exoPlayer.setMediaItem(mediaItem)\r\n            exoPlayer.prepare()\r\n        }\r\n        onDispose { }\r\n    }\r\n\r\n    LaunchedEffect(exoPlayer) {\r\n        exoPlayer.addListener(object : Player.Listener {\r\n            override fun onIsPlayingChanged(isPlayingValue: Boolean) {\r\n                isPlaying = isPlayingValue\r\n            }\r\n            override fun onPlaybackStateChanged(state: Int) {\r\n                if (state == Player.STATE_ENDED) {\r\n                    isPlaying = false\r\n                    exoPlayer.seekTo(0)\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    DisposableEffect(Unit) {\r\n        onDispose { exoPlayer.release() }\r\n    }\r\n\r\n    // --- UI PRINCIPAL ---\r\n    Box(\r\n        modifier = Modifier\r\n            .fillMaxSize()\r\n            .background(Color.White)\r\n            .statusBarsPadding()\r\n    ) {\r\n        Column(\r\n            modifier = Modifier\r\n                .fillMaxSize()\r\n                .padding(horizontal = 16.dp)\r\n                .padding(bottom = 40.dp),\r\n            horizontalAlignment = Alignment.CenterHorizontally\r\n        ) {\r\n            // --- CABECERA UNIFICADA (Flecha + Título) ---\r\n            Box(\r\n                modifier = Modifier\r\n                    .fillMaxWidth()\r\n                    .padding(top = 16.dp) // Margen superior general\r\n            ) {\r\n                // 1. BOTÓN ATRÁS (Alineado a la Izquierda)\r\n                Box(\r\n                    modifier = Modifier\r\n                        .align(Alignment.CenterStart) // \uD83D\uDC48 Lo pegamos a la izquierda\r\n                        // \uD83D\uDC47 MANTENEMOS TU LÓGICA DE POSICIÓN PARA EL TUTORIAL\r\n                        .onGloballyPositioned { coordinates ->\r\n                            val position = coordinates.positionInRoot()\r\n                            val size = coordinates.size\r\n                            backButtonLayout = position to Size(size.width.toFloat(), size.height.toFloat())\r\n                        }\r\n                ) {\r\n                    Image(\r\n                        painter = painterResource(id = R.drawable.arrow_back),\r\n                        contentDescription = stringResource(R.string.go_back),\r\n                        modifier = Modifier\r\n                            .size(28.dp)\r\n                            .clickable { onBack() }\r\n                    )\r\n                }\r\n\r\n                // 2. TÍTULO (Alineado al Centro Absoluto)\r\n                Text(\r\n                    text = buildString {\r\n                        append(titulo_pin)\r\n                        ubicacion_pin?.let { append(\" (${it.displayName})\") }\r\n                    },\r\n                    // Bajamos un poco la fuente (de 26 a 22) para que quepa mejor junto a la flecha\r\n                    fontSize = 22.sp,\r\n                    fontWeight = FontWeight.Bold,\r\n                    color = Color.Black,\r\n                    textAlign = TextAlign.Center,\r\n                    lineHeight = 26.sp,\r\n                    modifier = Modifier\r\n                        .align(Alignment.Center) // \uD83D\uDC48 Lo centramos en la pantalla\r\n                        .padding(horizontal = 48.dp) // \uD83D\uDC48 Importante: Margen para no escribir encima de la flecha si el texto es largo\r\n                )\r\n            }\r\n\r\n            // Espacio antes de la imagen\r\n            Spacer(modifier = Modifier.height(16.dp))\r\n\r\n            // 2. CARRUSEL DE IMÁGENES\r\n            if (imagenes.isNotEmpty()) {\r\n                Box(\r\n                    modifier = Modifier\r\n                        .fillMaxWidth()\r\n                        .height(250.dp)\r\n                        .clip(RoundedCornerShape(16.dp))\r\n                        .border(3.dp, Color.Black, RoundedCornerShape(16.dp))\r\n                        // \uD83D\uDC47 CAPTURAMOS POSICIÓN REAL\r\n                        .onGloballyPositioned { coordinates ->\r\n                            val position = coordinates.positionInRoot()\r\n                            val size = coordinates.size\r\n                            imageLayout = position to Size(size.width.toFloat(), size.height.toFloat())\r\n                        }\r\n                ) {\r\n                    HorizontalPager(state = pagerState) { page ->\r\n                        val imagen = imagenes[page]\r\n                        Box(modifier = Modifier.fillMaxSize()) {\r\n\r\n                            val alignment = remember{\r\n                                BiasAlignment(horizontalBias = 0f, verticalBias = imagen.foco)\r\n                            }\r\n\r\n\r\n                            AsyncImage(\r\n                                model = imagen.url,\r\n                                contentDescription = imagen.etiqueta,\r\n                                contentScale = ContentScale.Crop,\r\n                                alignment = alignment,\r\n                                modifier = Modifier\r\n                                    .fillMaxSize()\r\n                                    .clickable {\r\n                                        selectedImageUrl = imagen.url\r\n                                        selectedImageTitle = when (language) {\r\n                                            \"es\" -> imagen.titulo\r\n                                            \"de\" -> imagen.tituloAleman\r\n                                            else -> imagen.tituloIngles\r\n                                        }\r\n                                    }\r\n                            )\r\n                            Text(\r\n                                text = imagen.etiqueta,\r\n                                color = Color.White,\r\n                                fontSize = 14.sp,\r\n                                modifier = Modifier\r\n                                    .align(Alignment.BottomStart)\r\n                                    .background(Color.Black.copy(alpha = 0.6f))\r\n                                    .padding(horizontal = 10.dp, vertical = 6.dp)\r\n                            )\r\n                        }\r\n                    }\r\n                    Row(\r\n                        Modifier\r\n                            .align(Alignment.BottomCenter)\r\n                            .padding(bottom = 6.dp)\r\n                    ) {\r\n                        repeat(imagenes.size) { index ->\r\n                            val selected = pagerState.currentPage == index\r\n                            Box(\r\n                                Modifier\r\n                                    .padding(3.dp)\r\n                                    .size(if (selected) 8.dp else 6.dp)\r\n                                    .background(\r\n                                        Color.White.copy(alpha = if (selected) 1f else 0.6f),\r\n                                        CircleShape\r\n                                    )\r\n                            )\r\n                        }\r\n                    }\r\n                }\r\n                Spacer(modifier = Modifier.height(12.dp))\r\n            }\r\n\r\n            // 3. BOTÓN DE AUDIO\r\n            Row(\r\n                modifier = Modifier.fillMaxWidth(),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                if (!audioUrl.isNullOrBlank()) {\r\n                    val iconRes = when {\r\n                        isPlaying -> R.drawable.pause\r\n                        !hasUserInteracted -> R.drawable.microphone\r\n                        else -> R.drawable.play_arrow\r\n                    }\r\n                    Row(\r\n                        modifier = Modifier\r\n                            .fillMaxWidth()\r\n                            .padding(top = 8.dp),\r\n                        horizontalArrangement = Arrangement.Start\r\n                    ) {\r\n                        IconButton(\r\n                            onClick = {\r\n                                hasUserInteracted = true\r\n                                if (isPlaying) exoPlayer.pause() else exoPlayer.play()\r\n                            },\r\n                            modifier = Modifier\r\n                                // \uD83D\uDC47 CAPTURAMOS POSICIÓN REAL\r\n                                .onGloballyPositioned { coordinates ->\r\n                                    val position = coordinates.positionInRoot()\r\n                                    val size = coordinates.size\r\n                                    audioButtonLayout = position to Size(size.width.toFloat(), size.height.toFloat())\r\n                                }\r\n                        ) {\r\n                            Box(\r\n                                modifier = Modifier\r\n                                    .size(48.dp)\r\n                                    .clip(CircleShape)\r\n                                    .background(Color.Gray.copy(alpha = 0.3f)),\r\n                                contentAlignment = Alignment.Center\r\n                            ) {\r\n                                Icon(\r\n                                    painter = painterResource(id = iconRes),\r\n                                    contentDescription = stringResource(R.string.play_audio),\r\n                                    tint = Color.Black,\r\n                                    modifier = Modifier.size(28.dp)\r\n                                )\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Descripción Deslizable\r\n            val descripcion = descripcion_pin ?: \"\"\r\n            if (descripcion.isNotBlank()) {\r\n                val textScrollState = rememberScrollState()\r\n                Box(\r\n                    modifier = Modifier\r\n                        .fillMaxWidth()\r\n                        .weight(1f)\r\n                        .border(1.dp, Color.LightGray.copy(alpha = 0.5f), RoundedCornerShape(8.dp))\r\n                        .clip(RoundedCornerShape(8.dp))\r\n                ) {\r\n                    Text(\r\n                        text = descripcion,\r\n                        fontSize = 16.sp,\r\n                        color = Color.DarkGray,\r\n                        lineHeight = 22.sp,\r\n                        modifier = Modifier\r\n                            .fillMaxSize()\r\n                            .padding(horizontal = 12.dp, vertical = 8.dp)\r\n                            .verticalScroll(textScrollState)\r\n                    )\r\n                }\r\n            }\r\n\r\n            Spacer(modifier = Modifier.height(24.dp))\r\n\r\n            // 4. BOTÓN 360\r\n            onVer360?.let {\r\n                Box(\r\n                    modifier = Modifier\r\n                        .background(Color.White)\r\n                        .navigationBarsPadding()\r\n                        .padding(horizontal = 16.dp, vertical = 2.dp)\r\n                        .onGloballyPositioned { coordinates ->\r\n                            val position = coordinates.positionInRoot()\r\n                            val size = coordinates.size\r\n                            button360Layout = position to Size(size.width.toFloat(), size.height.toFloat())\r\n                        }\r\n                ) {\r\n                    Button(\r\n                        onClick = it,\r\n                        modifier = Modifier\r\n                            .fillMaxWidth()\r\n                            .height(56.dp),\r\n                        colors = ButtonDefaults.buttonColors(containerColor = Color.Black),\r\n                        shape = RoundedCornerShape(12.dp)\r\n                    ) {\r\n                        Text(\r\n                            text = stringResource(R.string.see_360),\r\n                            color = Color.White,\r\n                            fontSize = 18.sp,\r\n                            fontWeight = FontWeight.Bold,\r\n                        )\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // ====================================================================\r\n        // LOGICA VISUAL DEL TUTORIAL (CON COORDENADAS REALES)\r\n        // ====================================================================\r\n\r\n        // Verificar que tenemos al menos las coordenadas básicas (Botón atrás es lo mínimo)\r\n        val isLayoutReady = backButtonLayout != null\r\n\r\n        if (!isPinDismissed && showTutorialSession && isLayoutReady) {\r\n\r\n            // Construimos la lista de pasos usando las coordenadas CAPTURADAS\r\n            val steps = remember(backButtonLayout, imageLayout, audioButtonLayout, button360Layout, audioUrl, onVer360) {\r\n                val list = mutableListOf<PinTutorialStep>()\r\n\r\n                // PASO 1: Volver (Usamos las coordenadas reales del botón atrás)\r\n                backButtonLayout?.let { (pos, size) ->\r\n                    list.add(\r\n                        PinTutorialStep(\r\n                            description = activity?.getString(R.string.pin_1) ?: \"Volver\",\r\n                            // Calculamos el centro geométrico\r\n                            focusCenter = Offset(pos.x + size.width / 2, pos.y + size.height / 2),\r\n                            // Radio un poco más grande que el botón\r\n                            focusRadius = (size.width),\r\n                            alignment = Alignment.BottomCenter\r\n                        )\r\n                    )\r\n                }\r\n\r\n                // PASO 2: Imágenes (Usamos coordenadas reales del carrusel)\r\n                imageLayout?.let { (pos, size) ->\r\n                    list.add(\r\n                        PinTutorialStep(\r\n                            description = activity?.getString(R.string.pin_2) ?: \"Imágenes\",\r\n                            focusCenter = Offset(pos.x + size.width / 2, pos.y + size.height / 2),\r\n                            rectSize = size, // Usamos el tamaño exacto\r\n                            alignment = Alignment.BottomCenter\r\n                        )\r\n                    )\r\n                }\r\n\r\n                // PASO 3: Audio (Solo si existe y se ha medido)\r\n                if (!audioUrl.isNullOrBlank() && audioButtonLayout != null) {\r\n                    audioButtonLayout?.let { (pos, size) ->\r\n                        list.add(\r\n                            PinTutorialStep(\r\n                                description = activity?.getString(R.string.pin_3) ?: \"Audio\",\r\n                                focusCenter = Offset(pos.x + size.width / 2, pos.y + size.height / 2),\r\n                                focusRadius = (size.width / 2) + 20f,\r\n                                alignment = Alignment.TopCenter\r\n                            )\r\n                        )\r\n                    }\r\n                }\r\n\r\n                // PASO 4: Botón 360 (Solo si existe y se ha medido)\r\n                if (onVer360 != null && button360Layout != null) {\r\n                    button360Layout?.let { (pos, size) ->\r\n                        list.add(\r\n                            PinTutorialStep(\r\n                                description = activity?.getString(R.string.pin_4) ?: \"360\",\r\n                                focusCenter = Offset(pos.x + size.width / 2, pos.y + size.height / 2),\r\n                                rectSize = size,\r\n                                alignment = Alignment.TopCenter // Dialogo ARRIBA\r\n                            )\r\n                        )\r\n                    }\r\n                }\r\n                list\r\n            }\r\n\r\n            if (steps.isNotEmpty() && currentStepIndex < steps.size) {\r\n                val step = steps[currentStepIndex]\r\n                val isLastStep = currentStepIndex == steps.size - 1\r\n                val btnText = if (isLastStep) stringResource(R.string.understand) else stringResource(R.string.next)\r\n\r\n                GenericTutorialOverlay(\r\n                    description = step.description,\r\n                    highlightCenter = step.focusCenter,\r\n                    highlightRadius = step.focusRadius,\r\n                    highlightRectSize = step.rectSize,\r\n                    buttonText = btnText,\r\n                    dialogAlignment = step.alignment,\r\n\r\n                    onCloseClicked = { permanent ->\r\n                        if (isLastStep) {\r\n                            showTutorialSession = false\r\n                            if (permanent) viewModel.dismissPin()\r\n                        } else {\r\n                            currentStepIndex++\r\n                            if (permanent) viewModel.dismissPin()\r\n                        }\r\n                    }\r\n                )\r\n            }\r\n        }\r\n\r\n        // \uD83D\uDD0D Zoom Dialog\r\n        if (selectedImageUrl != null) {\r\n            ZoomableImageDialog(\r\n                imageUrl = selectedImageUrl!!,\r\n                label = selectedImageTitle ?: \"\",\r\n                onDismiss = {\r\n                    selectedImageUrl = null\r\n                    selectedImageTitle = null\r\n                }\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\n@Composable\r\nprivate fun ZoomableImageDialog(imageUrl: String, label: String, onDismiss: () -> Unit) {\r\n    val view = LocalView.current\r\n    val activity = view.context as? Activity\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_SENSOR\r\n        onDispose {\r\n            activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT\r\n        }\r\n    }\r\n\r\n    Dialog(\r\n        onDismissRequest = onDismiss,\r\n        properties = DialogProperties(usePlatformDefaultWidth = false, dismissOnClickOutside = true)\r\n    ) {\r\n        Box(\r\n            modifier = Modifier.fillMaxSize().background(Color.Black.copy(alpha = 0.95f))\r\n        ) {\r\n            AndroidView(\r\n                factory = { context ->\r\n                    PhotoView(context).apply {\r\n                        load(imageUrl) { crossfade(true) }\r\n                    }\r\n                },\r\n                modifier = Modifier.fillMaxSize()\r\n            )\r\n\r\n            Text(\r\n                text = label,\r\n                color = Color.White,\r\n                fontSize = 16.sp,\r\n                fontWeight = FontWeight.Medium,\r\n                modifier = Modifier\r\n                    .align(Alignment.BottomStart)\r\n                    .background(Color.Black.copy(alpha = 0.7f))\r\n                    .padding(horizontal = 12.dp, vertical = 8.dp)\r\n            )\r\n\r\n            IconButton(\r\n                onClick = onDismiss,\r\n                modifier = Modifier\r\n                    .align(Alignment.TopStart)\r\n                    .statusBarsPadding()\r\n                    .padding(16.dp)\r\n                    .background(Color.Black.copy(alpha = 0.5f), CircleShape)\r\n            ) {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.arrow_back),\r\n                    contentDescription = stringResource(R.string.close),\r\n                    tint = Color.White\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PinDetalleScreen.kt b/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PinDetalleScreen.kt
+--- a/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PinDetalleScreen.kt	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
++++ b/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/PinDetalleScreen.kt	(date 1764866663814)
+@@ -99,6 +99,10 @@
+     var selectedImageTitle by remember { mutableStateOf<String?>(null) }
+ 
+     val configuration = LocalConfiguration.current
++    val screenHeight = configuration.screenHeightDp.dp
++    val isTablet = configuration.screenWidthDp > 600
++    var carouselHeight = 0.dp
++    if(isTablet){carouselHeight = screenHeight*0.5f} else {carouselHeight = screenHeight*0.35f}
+     val locale: Locale = configuration.locales[0]
+     val language = locale.language
+ 
+@@ -238,7 +242,7 @@
+                 Box(
+                     modifier = Modifier
+                         .fillMaxWidth()
+-                        .height(250.dp)
++                        .height(carouselHeight)
+                         .clip(RoundedCornerShape(16.dp))
+                         .border(3.dp, Color.Black, RoundedCornerShape(16.dp))
+                         // 👇 CAPTURAMOS POSICIÓN REAL
+@@ -314,7 +318,7 @@
+                 if (!audioUrl.isNullOrBlank()) {
+                     val iconRes = when {
+                         isPlaying -> R.drawable.pause
+-                        !hasUserInteracted -> R.drawable.microphone
++                        !hasUserInteracted -> R.drawable.sound
+                         else -> R.drawable.play_arrow
+                     }
+                     Row(
+Index: app/src/main/java/com/nextapp/monasterio/repository/FiguraRepository.kt
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.nextapp.monasterio.repository\r\n\r\nimport android.util.Log\r\nimport com.google.firebase.firestore.FirebaseFirestore\r\nimport com.nextapp.monasterio.models.FiguraData\r\nimport kotlinx.coroutines.tasks.await\r\n\r\nobject FiguraRepository {\r\n\r\n    private const val TAG = \"FiguraRepository\"\r\n\r\n    suspend fun getAllFiguras(): List<FiguraData> {\r\n        val db = FirebaseFirestore.getInstance()\r\n\r\n        Log.d(TAG, \"Iniciando consulta a la colección 'figuras'...\")\r\n\r\n        try {\r\n            val snapshot = db.collection(\"figuras\").get().await()\r\n\r\n            if (snapshot.isEmpty) {\r\n                Log.d(TAG, \"Consulta exitosa, pero la colección 'figuras' está vacía.\")\r\n                return emptyList()\r\n            }\r\n\r\n            Log.d(TAG, \"Consulta exitosa. Documentos encontrados: ${snapshot.size()}\")\r\n\r\n            // ✅ CORRECCIÓN CRÍTICA: Mapear el ID del documento\r\n            val figurasList = snapshot.documents.mapNotNull { document ->\r\n                // document.id contiene el ID de Firebase (ej. \"arco_mudejar\")\r\n                // Se deserializa el objeto y se le añade el ID con .copy()\r\n                document.toObject(FiguraData::class.java)?.copy(id = document.id)\r\n            }\r\n\r\n            Log.d(TAG, \"Resultado final de FiguraRepository.getAllFiguras() (con ID): ${figurasList.size} figuras.\")\r\n\r\n            // Opcional: Log para verificar que el ID se mapeó correctamente\r\n            figurasList.take(2).forEach {\r\n                Log.d(TAG, \"Verificación ID: ${it.nombre} -> ID: ${it.id}\")\r\n            }\r\n\r\n            return figurasList\r\n\r\n        } catch (e: Exception) {\r\n            Log.e(TAG, \"Error al obtener las figuras de Firestore\", e)\r\n            return emptyList()\r\n        }\r\n    }\r\n\r\n    suspend fun getFiguraById(id: String): FiguraData? {\r\n        val db = FirebaseFirestore.getInstance()\r\n        return try {\r\n            val doc = db.collection(\"figuras\").document(id).get().await()\r\n            if (doc.exists()) {\r\n                doc.toObject(FiguraData::class.java)?.copy(id = doc.id)\r\n            } else {\r\n                null\r\n            }\r\n        } catch (e: Exception) {\r\n            Log.e(TAG, \"Error al obtener la figura $id de Firestore\", e)\r\n            null\r\n        }\r\n    }\r\n}
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/nextapp/monasterio/repository/FiguraRepository.kt b/app/src/main/java/com/nextapp/monasterio/repository/FiguraRepository.kt
+--- a/app/src/main/java/com/nextapp/monasterio/repository/FiguraRepository.kt	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
++++ b/app/src/main/java/com/nextapp/monasterio/repository/FiguraRepository.kt	(date 1764868967089)
+@@ -1,8 +1,10 @@
+ package com.nextapp.monasterio.repository
+ 
+ import android.util.Log
++import com.google.firebase.firestore.DocumentReference
+ import com.google.firebase.firestore.FirebaseFirestore
+ import com.nextapp.monasterio.models.FiguraData
++import com.nextapp.monasterio.models.Punto
+ import kotlinx.coroutines.tasks.await
+ 
+ object FiguraRepository {
+@@ -11,38 +13,33 @@
+ 
+     suspend fun getAllFiguras(): List<FiguraData> {
+         val db = FirebaseFirestore.getInstance()
+-
+-        Log.d(TAG, "Iniciando consulta a la colección 'figuras'...")
+-
+-        try {
++        return try {
+             val snapshot = db.collection("figuras").get().await()
+-
+-            if (snapshot.isEmpty) {
+-                Log.d(TAG, "Consulta exitosa, pero la colección 'figuras' está vacía.")
+-                return emptyList()
+-            }
+-
+-            Log.d(TAG, "Consulta exitosa. Documentos encontrados: ${snapshot.size()}")
+-
+-            // ✅ CORRECCIÓN CRÍTICA: Mapear el ID del documento
+-            val figurasList = snapshot.documents.mapNotNull { document ->
+-                // document.id contiene el ID de Firebase (ej. "arco_mudejar")
+-                // Se deserializa el objeto y se le añade el ID con .copy()
+-                document.toObject(FiguraData::class.java)?.copy(id = document.id)
++            snapshot.documents.mapNotNull { doc ->
++                mapDocumentToFigura(doc.id, doc.data)
+             }
+-
+-            Log.d(TAG, "Resultado final de FiguraRepository.getAllFiguras() (con ID): ${figurasList.size} figuras.")
+-
+-            // Opcional: Log para verificar que el ID se mapeó correctamente
+-            figurasList.take(2).forEach {
+-                Log.d(TAG, "Verificación ID: ${it.nombre} -> ID: ${it.id}")
+-            }
+-
+-            return figurasList
+-
+         } catch (e: Exception) {
+-            Log.e(TAG, "Error al obtener las figuras de Firestore", e)
+-            return emptyList()
++            Log.e(TAG, "Error getAllFiguras", e)
++            emptyList()
++        }
++    }
++
++    suspend fun getFiguraByNombre(nombre: String): FiguraData? {
++        val db = FirebaseFirestore.getInstance()
++        return try {
++            val snapshot = db.collection("figuras")
++                .whereEqualTo("nombre", nombre)
++                .limit(1)
++                .get()
++                .await()
++
++            if (!snapshot.isEmpty) {
++                val doc = snapshot.documents[0]
++                mapDocumentToFigura(doc.id, doc.data)
++            } else null
++        } catch (e: Exception) {
++            Log.e(TAG, "Error getFiguraByNombre", e)
++            null
+         }
+     }
+ 
+@@ -51,13 +48,63 @@
+         return try {
+             val doc = db.collection("figuras").document(id).get().await()
+             if (doc.exists()) {
+-                doc.toObject(FiguraData::class.java)?.copy(id = doc.id)
+-            } else {
+-                null
+-            }
++                mapDocumentToFigura(doc.id, doc.data)
++            } else null
+         } catch (e: Exception) {
+-            Log.e(TAG, "Error al obtener la figura $id de Firestore", e)
++            Log.e(TAG, "Error getFiguraById", e)
+             null
+         }
+     }
++
++    // 👇 FUNCIÓN DE MAPEO MANUAL PARA EVITAR ERRORES DE TIPO 👇
++    private fun mapDocumentToFigura(id: String, data: Map<String, Any>?): FiguraData? {
++        if (data == null) return null
++        try {
++            // 1. Tratamiento especial para IMÁGENES (Reference -> String)
++            val imagenesRaw = data["imagenes"]
++            val imagenesList = if (imagenesRaw is List<*>) {
++                imagenesRaw.mapNotNull { item ->
++                    if (item is DocumentReference) item.id else item.toString()
++                }
++            } else emptyList()
++
++            // 2. Tratamiento especial para PATH (List<HashMap> -> List<Punto>)
++            val pathRaw = data["path"] as? List<Map<String, Number>>
++            val pathList = pathRaw?.map {
++                Punto((it["x"]?.toFloat() ?: 0f), (it["y"]?.toFloat() ?: 0f))
++            } ?: emptyList()
++
++            return FiguraData(
++                id = id,
++                nombre = data["nombre"] as? String ?: "",
++                descripcion = data["descripcion"] as? String ?: "",
++                imagenes = imagenesList, // Ahora es List<String>
++
++                info_es = data["info_es"] as? String ?: "",
++                info_en = data["info_en"] as? String ?: "",
++                info_de = data["info_de"] as? String ?: "",
++                info_fr = data["info_fr"] as? String ?: "",
++
++                path = pathList,
++                colorResaltado = (data["colorResaltado"] as? Number)?.toLong() ?: 0xFFFFFFFF,
++                scale = (data["scale"] as? Number)?.toFloat() ?: 1f,
++                offsetX = (data["offsetX"] as? Number)?.toFloat() ?: 0f,
++                offsetY = (data["offsetY"] as? Number)?.toFloat() ?: 0f,
++
++                tipoDestino = data["tipoDestino"] as? String ?: "",
++                valorDestino = data["valorDestino"] as? String ?: "",
++
++                audioUrl_es = data["audioUrl_es"] as? String,
++                audioUrl_en = data["audioUrl_en"] as? String,
++                audioUrl_de = data["audioUrl_de"] as? String ?: data["audioUrl_ge"] as? String, // Soporte doble
++                audioUrl_fr = data["audioUrl_fr"] as? String,
++
++                // 👇 AHORA SÍ LO LEEMOS CORRECTAMENTE
++                vista360Url = data["vista360Url"] as? String
++            )
++        } catch (e: Exception) {
++            Log.e(TAG, "Error mapeando figura $id", e)
++            return null
++        }
++    }
+ }
+\ No newline at end of file
+Index: app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/DetalleFiguraScreen.kt
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>\r\npackage com.nextapp.monasterio.ui.virtualvisit.screens\r\n\r\nimport androidx.compose.animation.Crossfade\r\nimport androidx.compose.animation.ExperimentalAnimationApi\r\nimport androidx.compose.foundation.BorderStroke\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.border\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.foundation.rememberScrollState\r\nimport androidx.compose.foundation.shape.CircleShape\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.foundation.verticalScroll\r\nimport androidx.compose.material3.CircularProgressIndicator\r\nimport androidx.compose.material3.Icon\r\nimport androidx.compose.material3.IconButton\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.LaunchedEffect\r\nimport androidx.compose.runtime.mutableStateOf\r\nimport androidx.compose.runtime.remember\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.platform.LocalConfiguration\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.text.font.FontWeight\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.unit.sp\r\nimport androidx.navigation.NavHostController\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.models.FiguraData\r\nimport com.nextapp.monasterio.models.ImagenData\r\nimport com.nextapp.monasterio.repository.FiguraRepository\r\nimport androidx.compose.runtime.getValue\r\nimport androidx.compose.runtime.setValue\r\nimport androidx.compose.ui.draw.clip\r\nimport androidx.compose.ui.layout.ContentScale\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport coil.compose.AsyncImage\r\nimport com.nextapp.monasterio.repository.ImagenRepository\r\nimport kotlinx.coroutines.delay\r\n\r\n@OptIn(ExperimentalAnimationApi::class)\r\n@Composable\r\nfun DetalleFiguraScreen(\r\n    navController: NavHostController,\r\n    figuraId: String // \uD83D\uDC48 Recibimos el ID\r\n) {\r\n    // 1. Estados de Datos\r\n    var figura by remember { mutableStateOf<FiguraData?>(null) }\r\n    var imagenes by remember { mutableStateOf<List<ImagenData>>(emptyList()) }\r\n    var isLoading by remember { mutableStateOf(true) }\r\n\r\n    // 2. Determinación del Idioma (desde la configuración local)\r\n    val currentLanguageCode = LocalConfiguration.current.locales[0].language\r\n\r\n    // 3. ESTADO DEL CARRUSEL (NUEVO)\r\n    var currentIndex by remember { mutableStateOf(0) }\r\n\r\n    // Repositorios\r\n    val figuraRepository = remember { FiguraRepository }\r\n    val imagenRepository = remember { ImagenRepository() }\r\n\r\n    // 4. LÓGICA DE CARGA Y EFECTO DE TRANSICIÓN\r\n    LaunchedEffect(figuraId, currentLanguageCode) {\r\n        isLoading = true\r\n        // Cargar la figura\r\n        val loadedFigura = figuraRepository.getFiguraById(figuraId)\r\n        figura = loadedFigura\r\n\r\n        // Cargar las imágenes referenciadas\r\n        if (loadedFigura != null) {\r\n            // Se asume que FiguraData.imagenes ahora es List<DocumentReference>\r\n            val loadedImages = loadedFigura.imagenes.mapNotNull { ref ->\r\n                val imageId = ref.id // Usamos .id de DocumentReference\r\n                imagenRepository.getImageById(imageId)\r\n            }\r\n            imagenes = loadedImages\r\n        }\r\n        isLoading = false\r\n    }\r\n\r\n    // 5. LÓGICA DE TRANSICIÓN AUTOMÁTICA DEL CARRUSEL\r\n    if (imagenes.size > 1) {\r\n        LaunchedEffect(currentIndex, imagenes.size) {\r\n            delay(4000L)\r\n            currentIndex = (currentIndex + 1) % imagenes.size\r\n        }\r\n    }\r\n\r\n    Box(\r\n        modifier = Modifier\r\n            .fillMaxSize()\r\n            .background(Color.White)\r\n    ) {\r\n        if (isLoading) {\r\n            Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {\r\n                CircularProgressIndicator(color = Color(0xFFFF8F00))\r\n            }\r\n        } else if (figura == null) {\r\n            Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {\r\n                Text(stringResource(R.string.error_figure,figuraId), color = Color.Red)\r\n            }\r\n        } else {\r\n            Column(\r\n                modifier = Modifier\r\n                    .fillMaxSize()\r\n                    .verticalScroll(rememberScrollState())\r\n                    .padding(horizontal = 16.dp, vertical = 48.dp)\r\n            ) {\r\n                // 6. TÍTULO\r\n                Text(\r\n                    text = figura!!.nombre.uppercase(),\r\n                    fontSize = 28.sp,\r\n                    fontWeight = FontWeight.Black,\r\n                    color = Color(figura!!.colorResaltado.toUInt().toInt()),\r\n                    textAlign = TextAlign.Center, // \uD83D\uDC48 Se centra el texto\r\n                    modifier = Modifier\r\n                        .fillMaxWidth() // \uD83D\uDC48 Se asegura que ocupe todo el ancho\r\n                        .padding(bottom = 16.dp)\r\n                )\r\n\r\n                // 7. IMÁGENES (CARRUSEL AUTOMÁTICO - REEMPLAZADO)\r\n                if (imagenes.isNotEmpty()) {\r\n                    Column(\r\n                        modifier = Modifier.fillMaxWidth(),\r\n                        horizontalAlignment = Alignment.CenterHorizontally\r\n                    ) {\r\n                        Box(\r\n                            modifier = Modifier\r\n                                .fillMaxWidth(0.9f)\r\n                                .height(260.dp)\r\n                                .clip(RoundedCornerShape(12.dp))\r\n                                .border(2.dp, Color(figura!!.colorResaltado.toUInt().toInt()), RoundedCornerShape(12.dp)),\r\n                            contentAlignment = Alignment.Center\r\n                        ) {\r\n                            Crossfade(\r\n                                targetState = currentIndex,\r\n                                label = \"imageFade\",\r\n                                modifier = Modifier.fillMaxSize()\r\n                            ) { page ->\r\n                                val imagen = imagenes[page]\r\n                                AsyncImage(\r\n                                    model = imagen.url,\r\n                                    contentDescription = imagen.titulo,\r\n                                    contentScale = ContentScale.Crop,\r\n                                    modifier = Modifier.fillMaxSize()\r\n                                )\r\n                            }\r\n\r\n                            // Indicadores (Dots)\r\n                            Row(\r\n                                Modifier\r\n                                    .align(Alignment.BottomCenter)\r\n                                    .padding(bottom = 6.dp)\r\n                            ) {\r\n                                repeat(imagenes.size) { index ->\r\n                                    val selected = currentIndex == index\r\n                                    Box(\r\n                                        Modifier\r\n                                            .padding(3.dp)\r\n                                            .size(if (selected) 9.dp else 7.dp)\r\n                                            .background(\r\n                                                if (selected) Color.White\r\n                                                else Color.White.copy(alpha = 0.4f),\r\n                                                shape = CircleShape\r\n                                            )\r\n                                    )\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    Spacer(modifier = Modifier.height(24.dp))\r\n                }\r\n\r\n\r\n                // 8. INFORMACIÓN (Multilenguaje)\r\n                val infoText = when (currentLanguageCode) {\r\n                    \"de\" -> figura!!.info_de\r\n                    \"en\" -> figura!!.info_en\r\n                    \"fr\" -> figura!!.info_fr\r\n                    else -> figura!!.info_es\r\n                }\r\n\r\n                Text(\r\n                    text = stringResource(R.string.general_information_figure),\r\n                    fontSize = 20.sp,\r\n                    fontWeight = FontWeight.Bold,\r\n                    color = Color(figura!!.colorResaltado.toUInt().toInt()),\r\n                    modifier = Modifier.padding(bottom = 8.dp)\r\n                )\r\n                Text(\r\n                    text = infoText,\r\n                    fontSize = 16.sp,\r\n                    color = Color.Black\r\n                )\r\n            }\r\n        }\r\n\r\n        // 9. BOTÓN ATRÁS\r\n        IconButton(\r\n            onClick = { navController.popBackStack() },\r\n            modifier = Modifier\r\n                .align(Alignment.TopStart)\r\n                .statusBarsPadding()\r\n                .padding(16.dp)\r\n                .background(\r\n                    color = Color.Black.copy(alpha = 0.5f),\r\n                    shape = RoundedCornerShape(12.dp)\r\n                )\r\n        ) {\r\n            Icon(\r\n                painter = painterResource(id = R.drawable.arrow_back),\r\n                contentDescription = stringResource(R.string.go_back),\r\n                tint = Color.White\r\n            )\r\n        }\r\n    }\r\n}
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/DetalleFiguraScreen.kt b/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/DetalleFiguraScreen.kt
+--- a/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/DetalleFiguraScreen.kt	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
++++ b/app/src/main/java/com/nextapp/monasterio/ui/virtualvisit/screens/DetalleFiguraScreen.kt	(date 1764871193674)
+@@ -1,83 +1,91 @@
+-
+ package com.nextapp.monasterio.ui.virtualvisit.screens
+ 
+ import androidx.compose.animation.Crossfade
+ import androidx.compose.animation.ExperimentalAnimationApi
+-import androidx.compose.foundation.BorderStroke
+ import androidx.compose.foundation.background
+ import androidx.compose.foundation.border
++import androidx.compose.foundation.clickable
+ import androidx.compose.foundation.layout.*
+ import androidx.compose.foundation.rememberScrollState
+ import androidx.compose.foundation.shape.CircleShape
+ import androidx.compose.foundation.shape.RoundedCornerShape
+ import androidx.compose.foundation.verticalScroll
+-import androidx.compose.material3.CircularProgressIndicator
+-import androidx.compose.material3.Icon
+-import androidx.compose.material3.IconButton
+-import androidx.compose.material3.Text
+-import androidx.compose.runtime.Composable
+-import androidx.compose.runtime.LaunchedEffect
+-import androidx.compose.runtime.mutableStateOf
+-import androidx.compose.runtime.remember
++import androidx.compose.material3.*
++import androidx.compose.runtime.*
+ import androidx.compose.ui.Alignment
+ import androidx.compose.ui.Modifier
++import androidx.compose.ui.draw.clip
+ import androidx.compose.ui.graphics.Color
++import androidx.compose.ui.layout.ContentScale
+ import androidx.compose.ui.platform.LocalConfiguration
++import androidx.compose.ui.platform.LocalContext
+ import androidx.compose.ui.res.painterResource
++import androidx.compose.ui.res.stringResource
+ import androidx.compose.ui.text.font.FontWeight
++import androidx.compose.ui.text.style.TextAlign
+ import androidx.compose.ui.unit.dp
+ import androidx.compose.ui.unit.sp
+ import androidx.navigation.NavHostController
++import coil.compose.AsyncImage
++import com.nextapp.monasterio.AppRoutes
+ import com.nextapp.monasterio.R
+ import com.nextapp.monasterio.models.FiguraData
+ import com.nextapp.monasterio.models.ImagenData
+ import com.nextapp.monasterio.repository.FiguraRepository
+-import androidx.compose.runtime.getValue
+-import androidx.compose.runtime.setValue
+-import androidx.compose.ui.draw.clip
+-import androidx.compose.ui.layout.ContentScale
+-import androidx.compose.ui.res.stringResource
+-import androidx.compose.ui.text.style.TextAlign
+-import coil.compose.AsyncImage
+ import com.nextapp.monasterio.repository.ImagenRepository
+ import kotlinx.coroutines.delay
++import android.util.Log
+ 
+ @OptIn(ExperimentalAnimationApi::class)
+ @Composable
+ fun DetalleFiguraScreen(
+     navController: NavHostController,
+-    figuraId: String // 👈 Recibimos el ID
++    rootNavController: NavHostController? = null, // 👈 AÑADIDO: Ahora acepta el navegador raíz
++    nombre: String
+ ) {
+     // 1. Estados de Datos
+     var figura by remember { mutableStateOf<FiguraData?>(null) }
+     var imagenes by remember { mutableStateOf<List<ImagenData>>(emptyList()) }
+     var isLoading by remember { mutableStateOf(true) }
+ 
+-    // 2. Determinación del Idioma (desde la configuración local)
+-    val currentLanguageCode = LocalConfiguration.current.locales[0].language
++    // 2. Determinación del Idioma
++    val configuration = LocalConfiguration.current
++    val locale = configuration.locales[0]
++    val currentLanguageCode = locale.language
+ 
+-    // 3. ESTADO DEL CARRUSEL (NUEVO)
++    // 3. ESTADO DEL CARRUSEL
+     var currentIndex by remember { mutableStateOf(0) }
+ 
+     // Repositorios
+     val figuraRepository = remember { FiguraRepository }
+     val imagenRepository = remember { ImagenRepository() }
+ 
+-    // 4. LÓGICA DE CARGA Y EFECTO DE TRANSICIÓN
+-    LaunchedEffect(figuraId, currentLanguageCode) {
++    // 4. LÓGICA DE CARGA ROBUSTA (DOBLE INTENTO)
++    LaunchedEffect(nombre, currentLanguageCode) {
+         isLoading = true
+-        // Cargar la figura
+-        val loadedFigura = figuraRepository.getFiguraById(figuraId)
++        Log.d("DetalleFigura", "Buscando figura con clave: $nombre")
++
++        // INTENTO 1: Buscar por campo 'nombre'
++        var loadedFigura = figuraRepository.getFiguraByNombre(nombre)
++
++        // INTENTO 2: Si falla, buscar por ID del documento
++        if (loadedFigura == null) {
++            Log.d("DetalleFigura", "No encontrada por nombre. Probando por ID...")
++            loadedFigura = figuraRepository.getFiguraById(nombre)
++        }
++
+         figura = loadedFigura
+ 
+-        // Cargar las imágenes referenciadas
++        // Cargar imágenes referenciadas
+         if (loadedFigura != null) {
+-            // Se asume que FiguraData.imagenes ahora es List<DocumentReference>
+-            val loadedImages = loadedFigura.imagenes.mapNotNull { ref ->
+-                val imageId = ref.id // Usamos .id de DocumentReference
++            Log.d("DetalleFigura", "Figura encontrada: ${loadedFigura.nombre}")
++            val loadedImages = loadedFigura.imagenes.mapNotNull { imageId ->
++                // Asumimos que la lista 'imagenes' contiene IDs de string
+                 imagenRepository.getImageById(imageId)
+             }
+             imagenes = loadedImages
++        } else {
++            Log.e("DetalleFigura", "❌ No se encontró ninguna figura con clave: $nombre")
+         }
+         isLoading = false
+     }
+@@ -94,89 +102,100 @@
+         modifier = Modifier
+             .fillMaxSize()
+             .background(Color.White)
++            .statusBarsPadding()
+     ) {
+         if (isLoading) {
+             Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {
+                 CircularProgressIndicator(color = Color(0xFFFF8F00))
+             }
+         } else if (figura == null) {
++            // Mensaje de error si fallan ambos intentos
+             Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {
+-                Text(stringResource(R.string.error_figure,figuraId), color = Color.Red)
++                Text("Error cargando datos: $nombre", color = Color.Red)
+             }
+         } else {
++            // CONTENIDO PRINCIPAL
+             Column(
+                 modifier = Modifier
+                     .fillMaxSize()
+                     .verticalScroll(rememberScrollState())
+-                    .padding(horizontal = 16.dp, vertical = 48.dp)
++                    .padding(horizontal = 16.dp)
++                    .padding(bottom = 40.dp) // Espacio inferior
+             ) {
+-                // 6. TÍTULO
+-                Text(
+-                    text = figura!!.nombre.uppercase(),
+-                    fontSize = 28.sp,
+-                    fontWeight = FontWeight.Black,
+-                    color = Color(figura!!.colorResaltado.toUInt().toInt()),
+-                    textAlign = TextAlign.Center, // 👈 Se centra el texto
+-                    modifier = Modifier
+-                        .fillMaxWidth() // 👈 Se asegura que ocupe todo el ancho
+-                        .padding(bottom = 16.dp)
+-                )
++
++                // --- CABECERA (Atrás + Título) ---
++                Box(
++                    modifier = Modifier
++                        .fillMaxWidth()
++                        .padding(top = 16.dp)
++                ) {
++                    // 1. Botón Atrás (Izq)
++                    Box(modifier = Modifier.align(Alignment.CenterStart)) {
++                        IconButton(
++                            onClick = { navController.popBackStack() },
++                            modifier = Modifier
++                                .background(Color.Black.copy(alpha = 0.5f), RoundedCornerShape(12.dp))
++                                .size(36.dp)
++                        ) {
++                            Icon(
++                                painter = painterResource(id = R.drawable.arrow_back),
++                                contentDescription = stringResource(R.string.go_back),
++                                tint = Color.White,
++                                modifier = Modifier.size(20.dp)
++                            )
++                        }
++                    }
++
++                    // 2. Título (Centro)
++                    Text(
++                        text = figura!!.nombre.uppercase(),
++                        fontSize = 22.sp,
++                        fontWeight = FontWeight.Black,
++                        color = Color(figura!!.colorResaltado.toUInt().toInt()),
++                        textAlign = TextAlign.Center,
++                        modifier = Modifier
++                            .align(Alignment.Center)
++                            .padding(horizontal = 48.dp)
++                    )
++                }
+ 
+-                // 7. IMÁGENES (CARRUSEL AUTOMÁTICO - REEMPLAZADO)
++                Spacer(modifier = Modifier.height(16.dp))
++
++                // --- 7. IMÁGENES (CARRUSEL) ---
+                 if (imagenes.isNotEmpty()) {
+-                    Column(
+-                        modifier = Modifier.fillMaxWidth(),
+-                        horizontalAlignment = Alignment.CenterHorizontally
+-                    ) {
+-                        Box(
+-                            modifier = Modifier
+-                                .fillMaxWidth(0.9f)
+-                                .height(260.dp)
+-                                .clip(RoundedCornerShape(12.dp))
+-                                .border(2.dp, Color(figura!!.colorResaltado.toUInt().toInt()), RoundedCornerShape(12.dp)),
+-                            contentAlignment = Alignment.Center
+-                        ) {
+-                            Crossfade(
+-                                targetState = currentIndex,
+-                                label = "imageFade",
+-                                modifier = Modifier.fillMaxSize()
+-                            ) { page ->
+-                                val imagen = imagenes[page]
+-                                AsyncImage(
+-                                    model = imagen.url,
+-                                    contentDescription = imagen.titulo,
+-                                    contentScale = ContentScale.Crop,
+-                                    modifier = Modifier.fillMaxSize()
+-                                )
+-                            }
+-
+-                            // Indicadores (Dots)
+-                            Row(
+-                                Modifier
+-                                    .align(Alignment.BottomCenter)
+-                                    .padding(bottom = 6.dp)
+-                            ) {
+-                                repeat(imagenes.size) { index ->
+-                                    val selected = currentIndex == index
+-                                    Box(
+-                                        Modifier
+-                                            .padding(3.dp)
+-                                            .size(if (selected) 9.dp else 7.dp)
+-                                            .background(
+-                                                if (selected) Color.White
+-                                                else Color.White.copy(alpha = 0.4f),
+-                                                shape = CircleShape
+-                                            )
+-                                    )
+-                                }
++                    Box(
++                        modifier = Modifier
++                            .fillMaxWidth()
++                            .height(260.dp)
++                            .clip(RoundedCornerShape(12.dp))
++                            .border(2.dp, Color(figura!!.colorResaltado.toUInt().toInt()), RoundedCornerShape(12.dp)),
++                        contentAlignment = Alignment.Center
++                    ) {
++                        Crossfade(targetState = currentIndex, label = "img") { page ->
++                            AsyncImage(
++                                model = imagenes[page].url,
++                                contentDescription = null,
++                                contentScale = ContentScale.Crop,
++                                modifier = Modifier.fillMaxSize()
++                            )
++                        }
++                        // Puntos indicadores
++                        Row(
++                            Modifier.align(Alignment.BottomCenter).padding(6.dp)
++                        ) {
++                            repeat(imagenes.size) { index ->
++                                val selected = currentIndex == index
++                                Box(
++                                    Modifier.padding(3.dp).size(if (selected) 8.dp else 6.dp)
++                                        .background(if (selected) Color.White else Color.White.copy(0.5f), CircleShape)
++                                )
+                             }
+                         }
+                     }
+                     Spacer(modifier = Modifier.height(24.dp))
+                 }
+ 
+-
+-                // 8. INFORMACIÓN (Multilenguaje)
++                // --- 8. INFORMACIÓN ---
+                 val infoText = when (currentLanguageCode) {
+                     "de" -> figura!!.info_de
+                     "en" -> figura!!.info_en
+@@ -192,30 +211,38 @@
+                     modifier = Modifier.padding(bottom = 8.dp)
+                 )
+                 Text(
+-                    text = infoText,
++                    text = infoText ?: "",
+                     fontSize = 16.sp,
+                     color = Color.Black
+                 )
+-            }
+-        }
+ 
+-        // 9. BOTÓN ATRÁS
+-        IconButton(
+-            onClick = { navController.popBackStack() },
+-            modifier = Modifier
+-                .align(Alignment.TopStart)
+-                .statusBarsPadding()
+-                .padding(16.dp)
+-                .background(
+-                    color = Color.Black.copy(alpha = 0.5f),
+-                    shape = RoundedCornerShape(12.dp)
+-                )
+-        ) {
+-            Icon(
+-                painter = painterResource(id = R.drawable.arrow_back),
+-                contentDescription = stringResource(R.string.go_back),
+-                tint = Color.White
+-            )
++                Spacer(modifier = Modifier.height(32.dp))
++
++                // --- 9. BOTÓN VER 360 (PIE DE PÁGINA) ---
++                // Solo se muestra si la figura tiene URL 360 en Firebase
++                if (!figura!!.vista360Url.isNullOrBlank()) {
++                    Button(
++                        onClick = {
++                            // Navegamos usando el rootNavController para salir del contexto del mapa
++                            rootNavController?.navigate(AppRoutes.PIN_360 + "/${figura!!.id}")
++                        },
++                        modifier = Modifier
++                            .fillMaxWidth()
++                            .height(56.dp),
++                        colors = ButtonDefaults.buttonColors(containerColor = Color.Black),
++                        shape = RoundedCornerShape(12.dp)
++                    ) {
++                        Text(
++                            text = stringResource(R.string.see_360),
++                            color = Color.White,
++                            fontSize = 18.sp,
++                            fontWeight = FontWeight.Bold
++                        )
++                    }
++                    // Espacio extra al final
++                    Spacer(modifier = Modifier.height(16.dp))
++                }
++            }
+         }
+     }
+ }
+\ No newline at end of file
+Index: .idea/shelf/Uncommitted_changes_before_Update_at_26_11_2025_23_48_[Changes]/shelved.patch
+===================================================================
+diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_26_11_2025_23_48_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_26_11_2025_23_48_[Changes]/shelved.patch
+deleted file mode 100644
+--- a/.idea/shelf/Uncommitted_changes_before_Update_at_26_11_2025_23_48_[Changes]/shelved.patch	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
++++ /dev/null	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
+@@ -1,1919 +0,0 @@
+-Index: app/src/main/java/com/nextapp/monasterio/ui/screens/ParejasScreen.kt
+-IDEA additional info:
+-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+-<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport android.app.Activity\r\nimport android.content.pm.ActivityInfo\r\nimport androidx.compose.animation.Crossfade\r\nimport androidx.compose.animation.core.tween\r\nimport androidx.compose.foundation.Image\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.clickable\r\nimport androidx.compose.foundation.layout.Arrangement\r\nimport androidx.compose.foundation.layout.Box\r\nimport androidx.compose.foundation.layout.Column\r\nimport androidx.compose.foundation.layout.aspectRatio\r\nimport androidx.compose.foundation.layout.fillMaxHeight\r\nimport androidx.compose.foundation.layout.fillMaxSize\r\nimport androidx.compose.foundation.layout.fillMaxWidth\r\nimport androidx.compose.foundation.layout.padding\r\nimport androidx.compose.foundation.layout.width\r\nimport androidx.compose.foundation.layout.wrapContentHeight\r\nimport androidx.compose.foundation.layout.wrapContentWidth\r\nimport androidx.compose.foundation.lazy.grid.GridCells\r\nimport androidx.compose.foundation.lazy.grid.LazyVerticalGrid\r\nimport androidx.compose.foundation.lazy.grid.items\r\nimport androidx.compose.material3.AlertDialog\r\nimport androidx.compose.material3.Button\r\nimport androidx.compose.material3.Card\r\nimport androidx.compose.material3.CardDefaults\r\nimport androidx.compose.material3.MaterialTheme\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.DisposableEffect\r\nimport androidx.compose.runtime.collectAsState\r\nimport androidx.compose.runtime.getValue\r\nimport androidx.compose.runtime.remember\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.layout.ContentScale\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.lifecycle.viewmodel.compose.viewModel\r\nimport androidx.navigation.NavController\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.models.ParejasPieza\r\nimport com.nextapp.monasterio.models.ParejasSize\r\nimport com.nextapp.monasterio.viewModels.ParejasViewModel\r\nimport com.nextapp.monasterio.viewModels.ParejasViewModelFactory\r\n\r\n\r\n@Composable\r\nfun ParejasScreen(\r\n    navController: NavController,\r\n    size : ParejasSize,\r\n    imagenes : List<Int>\r\n){\r\n    val factory = remember { ParejasViewModelFactory(size, imagenes) }\r\n    val viewModel: ParejasViewModel = viewModel(factory = factory)\r\n    val state by viewModel.uiState.collectAsState()\r\n\r\n    val context = LocalContext.current\r\n    val activity = context as? Activity\r\n\r\n    DisposableEffect(Unit) {\r\n        activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT\r\n        onDispose {\r\n\r\n        }\r\n    }\r\n\r\n    Column(\r\n        modifier = Modifier\r\n            .fillMaxSize()\r\n            .background(MaterialTheme.colorScheme.surfaceVariant)\r\n            .padding(16.dp),\r\n        horizontalAlignment = Alignment.CenterHorizontally,\r\n        verticalArrangement = Arrangement.Center\r\n    ) {\r\n\r\n        Column(\r\n            modifier = Modifier\r\n                .fillMaxWidth()\r\n                .padding(bottom = 16.dp),\r\n            horizontalAlignment = Alignment.CenterHorizontally\r\n        ) {\r\n            Text(\r\n                text = stringResource(R.string.left_pairs,state.parejas),\r\n                style = MaterialTheme.typography.titleMedium,\r\n                modifier = Modifier.padding(start = 4.dp)\r\n            )\r\n        }\r\n\r\n        LazyVerticalGrid(\r\n            columns = GridCells.Fixed(size.columns),\r\n            modifier = Modifier\r\n                .wrapContentHeight(Alignment.CenterVertically)\r\n                .wrapContentWidth(Alignment.CenterHorizontally)\r\n                .padding(vertical = 8.dp)\r\n                .then(\r\n                    if(size.rows == 4 ) {\r\n                        Modifier.width(300.dp)\r\n                    } else if (size.rows == 5){\r\n                        Modifier.width(250.dp)\r\n                    } else{\r\n                        Modifier.fillMaxWidth()\r\n                    }\r\n                ),\r\n            verticalArrangement = Arrangement.spacedBy(8.dp),\r\n            horizontalArrangement = Arrangement.spacedBy(8.dp),\r\n        ) {\r\n            items(\r\n                state.piezas,\r\n            ){pieza ->\r\n                GridCell(pieza = pieza, mostradoInicial = state.mostradoInicial,onClick = { id -> viewModel.onClickPieza(id) })\r\n            }\r\n        }\r\n    }\r\n\r\n    if (state.solucionado) {\r\n        ParejaDialog(onDismiss = {}, onConfirm = { navController.popBackStack() })\r\n    }\r\n}\r\n\r\n\r\n\r\n@Composable\r\nfun ParejaDialog(\r\n    onDismiss: () -> Unit,\r\n    onConfirm : () -> Unit\r\n){\r\n    AlertDialog(\r\n        onDismissRequest=onDismiss,\r\n        title = {\r\n            Text(stringResource(R.string.congratulations))\r\n        },\r\n        text = {\r\n            Text(stringResource(R.string.message_game_completed))\r\n        },confirmButton = {\r\n            Button(\r\n                onClick = onConfirm\r\n            ) {\r\n                Text(stringResource(R.string.ready))\r\n            }\r\n        },\r\n    )\r\n}\r\n\r\n@Composable\r\nfun GridCell(\r\n    pieza: ParejasPieza,\r\n    mostradoInicial : Boolean,\r\n    onClick : (Int) -> Unit,\r\n) {\r\n    val conPareja = pieza.conPareja\r\n    val isClickable = !conPareja\r\n\r\n    Card(\r\n        elevation = CardDefaults.cardElevation(defaultElevation = if (conPareja || pieza.estaVolteada) 4.dp else 2.dp),\r\n        modifier = Modifier\r\n            .aspectRatio(1f)\r\n            .then(\r\n                if (isClickable && !mostradoInicial){\r\n                    Modifier.clickable{ onClick(pieza.id) }\r\n                } else{\r\n                    Modifier\r\n                }\r\n            ),\r\n        shape = MaterialTheme.shapes.medium,\r\n        colors = CardDefaults.cardColors(\r\n            containerColor = Color.White\r\n        )\r\n    ) {\r\n        Box(\r\n            modifier = Modifier.fillMaxSize(),\r\n            contentAlignment = Alignment.Center\r\n        ) {\r\n            Crossfade(\r\n                targetState = if(conPareja || pieza.estaVolteada || mostradoInicial) 1 else 0,\r\n                animationSpec = tween(durationMillis = 300),\r\n                label=\"CardFlipAnimation\"\r\n            ) { state ->\r\n                if (state == 1) {\r\n                    Image(\r\n                        painter = painterResource(id = pieza.imagen),\r\n                        contentDescription = \"Pieza ${pieza.id}\",\r\n                        contentScale = ContentScale.Crop,\r\n                        modifier = Modifier.fillMaxSize()\r\n                    )\r\n                } else {\r\n                    Image(\r\n                        painterResource(R.drawable.escudo),\r\n                        contentDescription = stringResource(R.string.back_piece),\r\n                        contentScale = ContentScale.Fit,\r\n                        modifier = Modifier.fillMaxSize()\r\n                    )\r\n                }\r\n            }\r\n        }\r\n    }\r\n}
+-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+-<+>UTF-8
+-===================================================================
+-diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/ParejasScreen.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/ParejasScreen.kt
+---- a/app/src/main/java/com/nextapp/monasterio/ui/screens/ParejasScreen.kt	(revision 1714c52c981cd82e544abc43b0ceffe53fa17617)
+-+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/ParejasScreen.kt	(date 1764076512330)
+-@@ -108,11 +108,12 @@
+-                 ),
+-             verticalArrangement = Arrangement.spacedBy(8.dp),
+-             horizontalArrangement = Arrangement.spacedBy(8.dp),
+-+            userScrollEnabled = false
+-         ) {
+-             items(
+-                 state.piezas,
+-             ){pieza ->
+--                GridCell(pieza = pieza, mostradoInicial = state.mostradoInicial,onClick = { id -> viewModel.onClickPieza(id) })
+-+                GridCell(pieza = pieza, mostradoInicial = state.mostradoInicial, verificandoPareja = state.verificandoPareja, onClick = { id -> viewModel.onClickPieza(id) })
+-             }
+-         }
+-     }
+-@@ -150,11 +151,11 @@
+- fun GridCell(
+-     pieza: ParejasPieza,
+-     mostradoInicial : Boolean,
+-+    verificandoPareja : Boolean,
+-     onClick : (Int) -> Unit,
+- ) {
+-     val conPareja = pieza.conPareja
+--    val isClickable = !conPareja
+--
+-+    val isClickable = !conPareja && !verificandoPareja
+-     Card(
+-         elevation = CardDefaults.cardElevation(defaultElevation = if (conPareja || pieza.estaVolteada) 4.dp else 2.dp),
+-         modifier = Modifier
+-Index: app/src/main/java/com/nextapp/monasterio/viewModels/ParejasViewModel.kt
+-IDEA additional info:
+-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+-<+>package com.nextapp.monasterio.viewModels\r\n\r\nimport android.util.Log\r\nimport android.widget.ImageView\r\nimport androidx.lifecycle.ViewModel\r\nimport androidx.lifecycle.ViewModelProvider\r\nimport androidx.lifecycle.viewModelScope\r\nimport com.nextapp.monasterio.models.ParejasManager\r\nimport com.nextapp.monasterio.models.ParejasPieza\r\nimport com.nextapp.monasterio.models.ParejasSize\r\nimport com.nextapp.monasterio.models.PuzzleSize\r\nimport kotlinx.coroutines.delay\r\nimport kotlinx.coroutines.flow.MutableStateFlow\r\nimport kotlinx.coroutines.flow.StateFlow\r\nimport kotlinx.coroutines.flow.update\r\nimport kotlinx.coroutines.launch\r\n\r\ndata class parejasUiState(\r\n    val piezas : List<ParejasPieza> = emptyList(),\r\n    val size : ParejasSize,\r\n    val solucionado : Boolean = false,\r\n    val mostradoInicial : Boolean = true,\r\n    val parejas : Int = (size.columns* size.rows)/2\r\n)\r\n\r\nclass ParejasViewModel (\r\n    val size: ParejasSize,\r\n    val imagenesIds: List<Int>\r\n): ViewModel(){\r\n\r\n    private val _uiState = MutableStateFlow(parejasUiState(size=size))\r\n\r\n    val uiState: StateFlow<parejasUiState> = _uiState\r\n\r\n    val piezasManager = ParejasManager(size)\r\n\r\n    init{\r\n        resetGame()\r\n    }\r\n    fun resetGame(){\r\n        val piezasIniciales = piezasManager.inicializarParejaPiezas(imagenesIds)\r\n        _uiState.value = parejasUiState(\r\n            piezas = piezasIniciales,\r\n            size = size,\r\n            solucionado = false,\r\n            mostradoInicial =  true\r\n        )\r\n        viewModelScope.launch {\r\n            delay(3000)\r\n            _uiState.update{\r\n                it.copy(mostradoInicial = false)\r\n            }\r\n        }\r\n    }\r\n\r\n    private val piezasVolteadas = mutableListOf<ParejasPieza>()\r\n\r\n    fun onClickPieza(id:Int){\r\n        if(piezasVolteadas.size == 2) return\r\n\r\n        val piezaClickeada = _uiState.value.piezas.find { it.id == id } ?: return\r\n\r\n        if(piezaClickeada.estaVolteada || piezaClickeada.conPareja) return\r\n\r\n        val nuevasPiezas = _uiState.value.piezas.toMutableList().apply {\r\n            val index = indexOfFirst { it.id == id }\r\n            this[index] = piezaClickeada.copy(estaVolteada = true)\r\n        }\r\n        _uiState.update { it.copy(piezas = nuevasPiezas) }\r\n\r\n        val nuevaPiezaVolteada = nuevasPiezas.find { it.id == id }!!\r\n        piezasVolteadas.add(nuevaPiezaVolteada)\r\n\r\n        // 2. Si ya hay dos piezas volteadas, chequeamos la pareja\r\n        if (piezasVolteadas.size == 2) {\r\n            chequearPareja(piezasVolteadas)\r\n        }\r\n\r\n    }\r\n\r\n    private fun chequearPareja(piezas : List<ParejasPieza>){\r\n        val pieza1 = piezas[0]\r\n        val pieza2 = piezas[1]\r\n\r\n        viewModelScope.launch {\r\n\r\n            delay(1000)\r\n\r\n            var piezasCompletas = _uiState.value.piezas\r\n            var parejasRestantes = _uiState.value.parejas\r\n\r\n            if(pieza1.imagen == pieza2.imagen){\r\n                piezasCompletas = piezasCompletas.map { pieza ->\r\n                    if (pieza.id == pieza1.id || pieza.id == pieza2.id) {\r\n                        // Crea una nueva pieza, resuelta y no volteada\r\n                        pieza.copy(conPareja = true, estaVolteada = false).also{\r\n                        }\r\n                    } else {\r\n                        pieza\r\n                    }\r\n                }\r\n                parejasRestantes -= 1\r\n            }\r\n            else{\r\n                piezasCompletas = piezasCompletas.map { pieza ->\r\n                    if (pieza.id == pieza1.id || pieza.id == pieza2.id) {\r\n                        // Crea una nueva pieza, des-volteada\r\n                        pieza.copy(estaVolteada = false).also{\r\n                        }\r\n                    } else {\r\n                        pieza\r\n                    }\r\n                }\r\n            }\r\n            this@ParejasViewModel.piezasVolteadas.clear()\r\n            _uiState.update { it.copy(piezas = piezasCompletas, parejas=parejasRestantes) }\r\n            val todasPiezasConPareja = estaTerminado()\r\n            _uiState.update { it.copy(solucionado = estaTerminado()) }\r\n\r\n        }\r\n    }\r\n\r\n    private fun estaTerminado(): Boolean{\r\n        val piezasActuales = _uiState.value.piezas\r\n        val todasPiezasConPareja = piezasActuales.all{pieza ->\r\n            pieza.conPareja\r\n        }\r\n        return todasPiezasConPareja\r\n    }\r\n\r\n\r\n}\r\n\r\nclass ParejasViewModelFactory(\r\n    private val size: ParejasSize,\r\n    private val imagenesIds: List<Int>\r\n) : ViewModelProvider.Factory{\r\n    @Suppress(\"UNCHECKED_CAST\")\r\n    override fun <T : ViewModel> create(modelClass: Class<T>): T {\r\n        if (modelClass.isAssignableFrom(ParejasViewModel::class.java)) {\r\n            return ParejasViewModel(size, imagenesIds) as T\r\n        }\r\n        throw IllegalArgumentException(\"Unknown ViewModel class\")\r\n    }\r\n}
+-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+-<+>UTF-8
+-===================================================================
+-diff --git a/app/src/main/java/com/nextapp/monasterio/viewModels/ParejasViewModel.kt b/app/src/main/java/com/nextapp/monasterio/viewModels/ParejasViewModel.kt
+---- a/app/src/main/java/com/nextapp/monasterio/viewModels/ParejasViewModel.kt	(revision 1714c52c981cd82e544abc43b0ceffe53fa17617)
+-+++ b/app/src/main/java/com/nextapp/monasterio/viewModels/ParejasViewModel.kt	(date 1764076443622)
+-@@ -20,6 +20,7 @@
+-     val size : ParejasSize,
+-     val solucionado : Boolean = false,
+-     val mostradoInicial : Boolean = true,
+-+    val verificandoPareja: Boolean = false,
+-     val parejas : Int = (size.columns* size.rows)/2
+- )
+- 
+-@@ -56,8 +57,8 @@
+-     private val piezasVolteadas = mutableListOf<ParejasPieza>()
+- 
+-     fun onClickPieza(id:Int){
+-+        if(_uiState.value.verificandoPareja) return
+-         if(piezasVolteadas.size == 2) return
+--
+-         val piezaClickeada = _uiState.value.piezas.find { it.id == id } ?: return
+- 
+-         if(piezaClickeada.estaVolteada || piezaClickeada.conPareja) return
+-@@ -78,14 +79,13 @@
+- 
+-     }
+- 
+--    private fun chequearPareja(piezas : List<ParejasPieza>){
+-+    private fun chequearPareja(piezas : List<ParejasPieza>,){
+-         val pieza1 = piezas[0]
+-         val pieza2 = piezas[1]
+- 
+-         viewModelScope.launch {
+--
+-+            _uiState.update { it.copy(verificandoPareja = true) }
+-             delay(1000)
+--
+-             var piezasCompletas = _uiState.value.piezas
+-             var parejasRestantes = _uiState.value.parejas
+- 
+-@@ -113,10 +113,9 @@
+-                 }
+-             }
+-             this@ParejasViewModel.piezasVolteadas.clear()
+--            _uiState.update { it.copy(piezas = piezasCompletas, parejas=parejasRestantes) }
+-+            _uiState.update { it.copy(piezas = piezasCompletas, verificandoPareja = false, parejas=parejasRestantes) }
+-             val todasPiezasConPareja = estaTerminado()
+-             _uiState.update { it.copy(solucionado = estaTerminado()) }
+--
+-         }
+-     }
+- 
+-Index: .idea/shelf/Uncommitted_changes_before_Update_at_17_11_2025_09_17__Changes_.xml
+-===================================================================
+-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_17_11_2025_09_17__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_17_11_2025_09_17__Changes_.xml
+-deleted file mode 100644
+---- a/.idea/shelf/Uncommitted_changes_before_Update_at_17_11_2025_09_17__Changes_.xml	(revision 1714c52c981cd82e544abc43b0ceffe53fa17617)
+-+++ /dev/null	(revision 1714c52c981cd82e544abc43b0ceffe53fa17617)
+-@@ -1,4 +0,0 @@
+--<changelist name="Uncommitted_changes_before_Update_at_17_11_2025_09_17_[Changes]" date="1763367444194" recycled="true" deleted="true">
+--  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_17_11_2025_09_17_[Changes]/shelved.patch" />
+--  <option name="DESCRIPTION" value="Uncommitted changes before Update at 17/11/2025 09:17 [Changes]" />
+--</changelist>
+-\ No newline at end of file
+-Index: .idea/shelf/Uncommitted_changes_before_Update_at_17_11_2025_09_17_[Changes]/shelved.patch
+-===================================================================
+-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_17_11_2025_09_17_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_17_11_2025_09_17_[Changes]/shelved.patch
+-deleted file mode 100644
+---- a/.idea/shelf/Uncommitted_changes_before_Update_at_17_11_2025_09_17_[Changes]/shelved.patch	(revision 1714c52c981cd82e544abc43b0ceffe53fa17617)
+-+++ /dev/null	(revision 1714c52c981cd82e544abc43b0ceffe53fa17617)
+-@@ -1,1764 +0,0 @@
+--Index: .idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_20_07__Changes_.xml
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_20_07__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_20_07__Changes_.xml
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_20_07__Changes_.xml	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,4 +0,0 @@
+---<changelist name="Uncommitted_changes_before_Update_at_08_11_2025_20_07_[Changes]" date="1762628829564" recycled="true" deleted="true">
+---  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_20_07_[Changes]/shelved.patch" />
+---  <option name="DESCRIPTION" value="Uncommitted changes before Update at 08/11/2025 20:07 [Changes]" />
+---</changelist>
+--\ No newline at end of file
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_18_[Changes]/shelved.patch
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_18_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_18_[Changes]/shelved.patch
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_18_[Changes]/shelved.patch	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,17 +0,0 @@
+---Index: .idea/gradle.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"GradleSettings\">\r\n    <option name=\"linkedExternalProjectsSettings\">\r\n      <GradleProjectSettings>\r\n        <option name=\"testRunner\" value=\"CHOOSE_PER_TEST\" />\r\n        <option name=\"externalProjectPath\" value=\"$PROJECT_DIR$\" />\r\n        <option name=\"gradleJvm\" value=\"#GRADLE_LOCAL_JAVA_HOME\" />\r\n        <option name=\"modules\">\r\n          <set>\r\n            <option value=\"$PROJECT_DIR$\" />\r\n            <option value=\"$PROJECT_DIR$/app\" />\r\n          </set>\r\n        </option>\r\n      </GradleProjectSettings>\r\n    </option>\r\n  </component>\r\n</project>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/.idea/gradle.xml b/.idea/gradle.xml
+------ a/.idea/gradle.xml	(revision 1c0bfc618ece38c61714e2813735e3a928424a11)
+---+++ b/.idea/gradle.xml	(date 1762636134357)
+---@@ -1,5 +1,6 @@
+--- <?xml version="1.0" encoding="UTF-8"?>
+--- <project version="4">
+---+  <component name="GradleMigrationSettings" migrationVersion="1" />
+---   <component name="GradleSettings">
+---     <option name="linkedExternalProjectsSettings">
+---       <GradleProjectSettings>
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_21_48_[Changes]/shelved.patch
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_21_48_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_21_48_[Changes]/shelved.patch
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_21_48_[Changes]/shelved.patch	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,17 +0,0 @@
+---Index: .idea/gradle.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"GradleSettings\">\r\n    <option name=\"linkedExternalProjectsSettings\">\r\n      <GradleProjectSettings>\r\n        <option name=\"testRunner\" value=\"CHOOSE_PER_TEST\" />\r\n        <option name=\"externalProjectPath\" value=\"$PROJECT_DIR$\" />\r\n        <option name=\"gradleJvm\" value=\"#GRADLE_LOCAL_JAVA_HOME\" />\r\n        <option name=\"modules\">\r\n          <set>\r\n            <option value=\"$PROJECT_DIR$\" />\r\n            <option value=\"$PROJECT_DIR$/app\" />\r\n          </set>\r\n        </option>\r\n      </GradleProjectSettings>\r\n    </option>\r\n  </component>\r\n</project>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/.idea/gradle.xml b/.idea/gradle.xml
+------ a/.idea/gradle.xml	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ b/.idea/gradle.xml	(date 1762631053346)
+---@@ -1,5 +1,6 @@
+--- <?xml version="1.0" encoding="UTF-8"?>
+--- <project version="4">
+---+  <component name="GradleMigrationSettings" migrationVersion="1" />
+---   <component name="GradleSettings">
+---     <option name="linkedExternalProjectsSettings">
+---       <GradleProjectSettings>
+--Index: .idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_23_00_[Changes]/shelved.patch
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_23_00_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_23_00_[Changes]/shelved.patch
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_23_00_[Changes]/shelved.patch	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,872 +0,0 @@
+---Index: gradle.properties
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+># Project-wide Gradle settings.\r\n# IDE (e.g. Android Studio) users:\r\n# Gradle settings configured through the IDE *will override*\r\n# any settings specified in this file.\r\n# For more details on how to configure your build environment visit\r\n# http://www.gradle.org/docs/current/userguide/build_environment.html\r\n# Specifies the JVM arguments used for the daemon process.\r\n# The setting is particularly useful for tweaking memory settings.\r\norg.gradle.jvmargs=-Xmx2048m -Dfile.encoding=UTF-8\r\n# When configured, Gradle will run in incubating parallel mode.\r\n# This option should only be used with decoupled projects. For more details, visit\r\n# https://developer.android.com/r/tools/gradle-multi-project-decoupled-projects\r\n# org.gradle.parallel=true\r\n# AndroidX package structure to make it clearer which packages are bundled with the\r\n# Android operating system, and which are packaged with your app's APK\r\n# https://developer.android.com/topic/libraries/support-library/androidx-rn\r\nandroid.useAndroidX=true\r\n# Kotlin code style for this project: \"official\" or \"obsolete\":\r\nkotlin.code.style=official\r\n# Enables namespacing of each library's R class so that its R class includes only the\r\n# resources declared in the library itself and none from the library's dependencies,\r\n# thereby reducing the size of the R class for that library\r\nandroid.nonTransitiveRClass=true
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>ISO-8859-1
+---===================================================================
+---diff --git a/gradle.properties b/gradle.properties
+------ a/gradle.properties	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ b/gradle.properties	(date 1762631081582)
+---@@ -20,4 +20,5 @@
+--- # Enables namespacing of each library's R class so that its R class includes only the
+--- # resources declared in the library itself and none from the library's dependencies,
+--- # thereby reducing the size of the R class for that library
+----android.nonTransitiveRClass=true
+---\ No newline at end of file
+---+android.nonTransitiveRClass=true
+---+kotlin.compiler.force.k1=true
+---\ No newline at end of file
+---Index: gradle/libs.versions.toml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+>[versions]\r\nagp = \"8.11.1\" #no cambiar de la 8.11.1\r\nkotlin = \"2.0.21\"\r\ncoreKtx = \"1.17.0\"\r\njunit = \"4.13.2\"\r\njunitVersion = \"1.3.0\"\r\nespressoCore = \"3.7.0\"\r\nlifecycleRuntimeKtx = \"2.9.4\"\r\nactivityCompose = \"1.11.0\"\r\ncomposeBom = \"2025.10.01\"\r\n#Practica\r\nconstraintlayoutCompose = \"1.1.1\"\r\nnavigationCompose = \"2.9.5\"\r\nfoundation = \"1.9.4\"\r\nappcompat = \"1.7.0\"\r\nmaterial = \"1.12.0\"\r\nfirebase-gservices = \"4.4.4\"\r\nfirebase-bom = \"33.1.0\"\r\n#panoramicas\r\npanoramaGL = \"1.11.0\"\r\nfirebaseFirestore = \"26.0.2\"\r\n\r\n[libraries]\r\nandroidx-core-ktx = { group = \"androidx.core\", name = \"core-ktx\", version.ref = \"coreKtx\" }\r\njunit = { group = \"junit\", name = \"junit\", version.ref = \"junit\" }\r\nandroidx-junit = { group = \"androidx.test.ext\", name = \"junit\", version.ref = \"junitVersion\" }\r\nandroidx-espresso-core = { group = \"androidx.test.espresso\", name = \"espresso-core\", version.ref = \"espressoCore\" }\r\nandroidx-lifecycle-runtime-ktx = { group = \"androidx.lifecycle\", name = \"lifecycle-runtime-ktx\", version.ref = \"lifecycleRuntimeKtx\" }\r\nandroidx-activity-compose = { group = \"androidx.activity\", name = \"activity-compose\", version.ref = \"activityCompose\" }\r\nandroidx-compose-bom = { group = \"androidx.compose\", name = \"compose-bom\", version.ref = \"composeBom\" }\r\nandroidx-ui = { group = \"androidx.compose.ui\", name = \"ui\" }\r\nandroidx-ui-graphics = { group = \"androidx.compose.ui\", name = \"ui-graphics\" }\r\nandroidx-ui-tooling = { group = \"androidx.compose.ui\", name = \"ui-tooling\" }\r\nandroidx-ui-tooling-preview = { group = \"androidx.compose.ui\", name = \"ui-tooling-preview\" }\r\nandroidx-ui-test-manifest = { group = \"androidx.compose.ui\", name = \"ui-test-manifest\" }\r\nandroidx-ui-test-junit4 = { group = \"androidx.compose.ui\", name = \"ui-test-junit4\" }\r\nandroidx-material3 = { group = \"androidx.compose.material3\", name = \"material3\" }\r\n#Practica\r\nconstraintlayout-compose = { module = \"androidx.constraintlayout:constraintlayout-compose\", version.ref = \"constraintlayoutCompose\" }\r\nnavigation-compose = { module = \"androidx.navigation:navigation-compose\", version.ref = \"navigationCompose\" }\r\nandroidx-compose-foundation = { group = \"androidx.compose.foundation\", name = \"foundation\", version.ref = \"foundation\" }\r\nandroidx-appcompat = { module = \"androidx.appcompat:appcompat\", version.ref = \"appcompat\" }\r\ngoogle-material = { module = \"com.google.android.material:material\", version.ref = \"material\" }\r\nfirebase-bom = { module = \"com.google.firebase:firebase-bom\", version.ref = \"firebase-bom\" }\r\nfirebase-firestore = { module = \"com.google.firebase:firebase-firestore-ktx\" }\r\n#Panoramicas\r\npanoramaGL = { module = \"com.github.hannesa2:panoramaGL\", version.ref = \"panoramaGL\" }\r\ngoogle-firebase-firestore = { group = \"com.google.firebase\", name = \"firebase-firestore\", version.ref = \"firebaseFirestore\" }\r\n\r\n[plugins]\r\nandroid-application = { id = \"com.android.application\", version.ref = \"agp\" }\r\nkotlin-android = { id = \"org.jetbrains.kotlin.android\", version.ref = \"kotlin\" }\r\nkotlin-compose = { id = \"org.jetbrains.kotlin.plugin.compose\", version.ref = \"kotlin\" }\r\nfirebase-gservices = { id = \"com.google.gms.google-services\", version.ref = \"firebase-gservices\" }\r\n\r\n\r\n
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
+------ a/gradle/libs.versions.toml	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ b/gradle/libs.versions.toml	(date 1762638917078)
+---@@ -1,6 +1,6 @@
+--- [versions]
+--- agp = "8.11.1" #no cambiar de la 8.11.1
+----kotlin = "2.0.21"
+---+kotlin = "2.2.0"
+--- coreKtx = "1.17.0"
+--- junit = "4.13.2"
+--- junitVersion = "1.3.0"
+---Index: app/src/main/java/com/nextapp/monasterio/LanguageHelper.kt
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+>package com.nextapp.monasterio\r\n\r\nimport android.content.Context\r\nimport android.content.SharedPreferences\r\nimport androidx.appcompat.app.AppCompatDelegate\r\nimport androidx.core.os.LocaleListCompat\r\n\r\nobject LanguageHelper {\r\n\r\n    private const val PREFS_NAME = \"language_prefs\"\r\n    private const val PREF_KEY_LANGUAGE = \"language_code\"\r\n\r\n    private fun getPrefs(context: Context): SharedPreferences {\r\n        // --- INICIO DE LA CORRECCIÓN ---\r\n        // Usa SIEMPRE el contexto de la aplicación para evitar inconsistencias\r\n        return context.applicationContext.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE)\r\n        // --- FIN DE LA CORRECCIÓN ---\r\n    }\r\n\r\n    // 1. Carga el idioma guardado al iniciar la app\r\n    fun loadLocale(context: Context) {\r\n        val language = getPrefs(context).getString(PREF_KEY_LANGUAGE, null)\r\n        if (language != null) {\r\n            val appLocale = LocaleListCompat.forLanguageTags(language)\r\n            AppCompatDelegate.setApplicationLocales(appLocale)\r\n        }\r\n    }\r\n\r\n    // 2. Guarda el nuevo idioma cuando el usuario lo cambia\r\n    fun saveLocale(context: Context, language: String) {\r\n        getPrefs(context).edit().putString(PREF_KEY_LANGUAGE, language).commit()\r\n        val appLocale = LocaleListCompat.forLanguageTags(language)\r\n        AppCompatDelegate.setApplicationLocales(appLocale)\r\n    }\r\n}
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/java/com/nextapp/monasterio/LanguageHelper.kt b/app/src/main/java/com/nextapp/monasterio/LanguageHelper.kt
+------ a/app/src/main/java/com/nextapp/monasterio/LanguageHelper.kt	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ b/app/src/main/java/com/nextapp/monasterio/LanguageHelper.kt	(date 1762633262572)
+---@@ -4,6 +4,7 @@
+--- import android.content.SharedPreferences
+--- import androidx.appcompat.app.AppCompatDelegate
+--- import androidx.core.os.LocaleListCompat
+---+import androidx.core.content.edit
+--- 
+--- object LanguageHelper {
+--- 
+---@@ -17,7 +18,6 @@
+---         // --- FIN DE LA CORRECCIÓN ---
+---     }
+--- 
+----    // 1. Carga el idioma guardado al iniciar la app
+---     fun loadLocale(context: Context) {
+---         val language = getPrefs(context).getString(PREF_KEY_LANGUAGE, null)
+---         if (language != null) {
+---@@ -29,6 +29,7 @@
+---     // 2. Guarda el nuevo idioma cuando el usuario lo cambia
+---     fun saveLocale(context: Context, language: String) {
+---         getPrefs(context).edit().putString(PREF_KEY_LANGUAGE, language).commit()
+---+
+---         val appLocale = LocaleListCompat.forLanguageTags(language)
+---         AppCompatDelegate.setApplicationLocales(appLocale)
+---     }
+---Index: .idea/shelf/Uncommitted_changes_before_Update_at_05_11_2025_19_15_[Changes]/shelved.patch
+---===================================================================
+---diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_05_11_2025_19_15_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_05_11_2025_19_15_[Changes]/shelved.patch
+---deleted file mode 100644
+------ a/.idea/shelf/Uncommitted_changes_before_Update_at_05_11_2025_19_15_[Changes]/shelved.patch	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ /dev/null	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---@@ -1,639 +0,0 @@
+----Index: app/src/main/java/com/nextapp/monasterio/MainActivity.kt
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+>package com.nextapp.monasterio\r\n\r\nimport android.os.Bundle\r\nimport android.widget.Toast\r\nimport androidx.activity.ComponentActivity\r\nimport androidx.activity.compose.setContent\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.navigation.compose.rememberNavController\r\nimport com.nextapp.monasterio.ui.navigation.AppDrawerContent\r\nimport com.nextapp.monasterio.ui.navigation.AppNavigationHost\r\nimport com.nextapp.monasterio.ui.theme.*\r\nimport kotlinx.coroutines.launch\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport androidx.appcompat.app.AppCompatDelegate\r\nimport androidx.compose.ui.platform.LocalDensity\r\nimport androidx.compose.ui.unit.Density\r\nimport androidx.navigation.compose.currentBackStackEntryAsState\r\nimport com.nextapp.monasterio.utils.FontSize\r\n\r\nclass MainActivity : AppCompatActivity() {\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO)\r\n        super.onCreate(savedInstanceState)\r\n        LanguageHelper.loadLocale(this)\r\n        setContent {\r\n            val appFontScale = FontSize.devolverFontScale(this)\r\n            val currentDensity = LocalDensity.current\r\n            val newDensity= Density(\r\n                density= currentDensity.density,\r\n                fontScale = currentDensity.fontScale*appFontScale\r\n            )\r\n            CompositionLocalProvider(LocalDensity provides newDensity) {\r\n                Smov_monasterioTheme {\r\n                    MonasteryAppScreen()\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun MonasteryAppScreen() {\r\n    val context = LocalContext.current\r\n    val navController = rememberNavController()\r\n    val drawerState = rememberDrawerState(initialValue = DrawerValue.Closed)\r\n    val scope = rememberCoroutineScope()\r\n\r\n    val currentTitle = remember { mutableStateOf(context.getString(R.string.title_inicio)) }\r\n\r\n    // ✅ Detectar ruta actual\r\n    val currentBackStackEntry by navController.currentBackStackEntryAsState()\r\n    val currentRoute = currentBackStackEntry?.destination?.route\r\n\r\n    // ✅ Rutas inmersivas\r\n    val immersiveRoutes = listOf(AppRoutes.PIN_DETALLE)\r\n    val isImmersive = currentRoute in immersiveRoutes\r\n\r\n    // ✅ Actualizar título\r\n    LaunchedEffect(navController) {\r\n        navController.currentBackStackEntryFlow.collect { backStackEntry ->\r\n            val route = backStackEntry.destination.route\r\n            currentTitle.value = when (route) {\r\n                AppRoutes.INFO -> context.getString(R.string.title_info_general)\r\n                AppRoutes.HISTORIA -> context.getString(R.string.title_history)\r\n                AppRoutes.GALERIA -> context.getString(R.string.title_gallery)\r\n                AppRoutes.PERFIL -> context.getString(R.string.title_profile)\r\n                AppRoutes.AJUSTES -> context.getString(R.string.title_settings)\r\n                AppRoutes.OPCIONES_RESERVA,\r\n                AppRoutes.RESERVA,\r\n                AppRoutes.CONFIRMACION_RESERVA -> context.getString(R.string.title_appointment)\r\n                AppRoutes.VIRTUAL_VISIT -> context.getString(R.string.title_monasterio)\r\n                else -> context.getString(R.string.title_inicio)\r\n            }\r\n        }\r\n    }\r\n\r\n    if (isImmersive) {\r\n        // \uD83C\uDF0C Vista inmersiva sin barra ni menú\r\n        AppNavigationHost(\r\n            navController = navController,\r\n            modifier = Modifier.fillMaxSize()\r\n        )\r\n    } else {\r\n        // \uD83E\uDDF1 Vista normal con barra y menú\r\n        ModalNavigationDrawer(\r\n            drawerState = drawerState,\r\n            drawerContent = {\r\n                AppDrawerContent(\r\n                    navController = navController,\r\n                    scope = scope,\r\n                    drawerState = drawerState\r\n                )\r\n            }\r\n        ) {\r\n            Scaffold(\r\n                topBar = {\r\n                    CenterAlignedTopAppBar(\r\n                        title = { Text(currentTitle.value) },\r\n                        colors = TopAppBarDefaults.topAppBarColors(\r\n                            containerColor = MonasteryRed,\r\n                            titleContentColor = White,\r\n                            navigationIconContentColor = White,\r\n                            actionIconContentColor = White\r\n                        ),\r\n                        navigationIcon = {\r\n                            IconButton(onClick = {\r\n                                scope.launch {\r\n                                    drawerState.apply {\r\n                                        if (isClosed) open() else close()\r\n                                    }\r\n                                }\r\n                            }) {\r\n                                val iconRes = if (drawerState.isOpen) R.drawable.menu_close else R.drawable.ic_menu_24\r\n                                Icon(\r\n                                    painter = painterResource(id = iconRes),\r\n                                    contentDescription = stringResource(id = R.string.navigation_drawer_open)\r\n                                )\r\n                            }\r\n                        },\r\n                        actions = {\r\n                            IconButton(onClick = {\r\n                                Toast.makeText(context, \"Modo edición (próximamente)\", Toast.LENGTH_SHORT).show()\r\n                            }) {\r\n                                Icon(\r\n                                    painter = painterResource(id = R.drawable.lapiz),\r\n                                    contentDescription = stringResource(id = R.string.edit_mode)\r\n                                )\r\n                            }\r\n                        }\r\n                    )\r\n                }\r\n            ) { paddingValues ->\r\n                AppNavigationHost(\r\n                    navController = navController,\r\n                    modifier = Modifier.padding(paddingValues)\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/app/src/main/java/com/nextapp/monasterio/MainActivity.kt b/app/src/main/java/com/nextapp/monasterio/MainActivity.kt
+------- a/app/src/main/java/com/nextapp/monasterio/MainActivity.kt	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/app/src/main/java/com/nextapp/monasterio/MainActivity.kt	(date 1762358031493)
+----@@ -59,7 +59,7 @@
+----     val currentRoute = currentBackStackEntry?.destination?.route
+---- 
+----     // ✅ Rutas inmersivas
+-----    val immersiveRoutes = listOf(AppRoutes.PIN_DETALLE)
+----+    val immersiveRoutes = listOf(AppRoutes.PIN_DETALLE, AppRoutes.PANORAMA)
+----     val isImmersive = currentRoute in immersiveRoutes
+---- 
+----     // ✅ Actualizar título
+----Index: settings.gradle.kts
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+>pluginManagement {\r\n    repositories {\r\n        google {\r\n            content {\r\n                includeGroupByRegex(\"com\\\\.android.*\")\r\n                includeGroupByRegex(\"com\\\\.google.*\")\r\n                includeGroupByRegex(\"androidx.*\")\r\n            }\r\n        }\r\n        mavenCentral()\r\n        gradlePluginPortal()\r\n    }\r\n}\r\ndependencyResolutionManagement {\r\n    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)\r\n    repositories {\r\n        google()\r\n        mavenCentral( )\r\n        maven { url = uri(\"https://www.jitpack.io\") }\r\n    }\r\n}\r\n\r\nrootProject.name = \"SMOV_Monasterio\"\r\ninclude(\":app\")\r\n 
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/settings.gradle.kts b/settings.gradle.kts
+------- a/settings.gradle.kts	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/settings.gradle.kts	(date 1762358031452)
+----@@ -9,6 +9,7 @@
+----         }
+----         mavenCentral()
+----         gradlePluginPortal()
+----+        maven { url = uri("https://www.jitpack.io") }
+----     }
+---- }
+---- dependencyResolutionManagement {
+----Index: gradle/libs.versions.toml
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+>[versions]\r\nagp = \"8.11.1\" #no cambiar de la 8.11.1\r\nkotlin = \"2.0.21\"\r\ncoreKtx = \"1.17.0\"\r\njunit = \"4.13.2\"\r\njunitVersion = \"1.3.0\"\r\nespressoCore = \"3.7.0\"\r\nlifecycleRuntimeKtx = \"2.9.4\"\r\nactivityCompose = \"1.11.0\"\r\ncomposeBom = \"2025.10.01\"\r\n#Practica\r\nconstraintlayoutCompose = \"1.1.1\"\r\nnavigationCompose = \"2.9.5\"\r\nfoundation = \"1.9.4\"\r\nappcompat = \"1.7.0\"\r\nmaterial = \"1.12.0\"\r\nfirebase-gservices = \"4.4.4\"\r\nfirebase-bom = \"33.1.0\"\r\n\r\n[libraries]\r\nandroidx-core-ktx = { group = \"androidx.core\", name = \"core-ktx\", version.ref = \"coreKtx\" }\r\njunit = { group = \"junit\", name = \"junit\", version.ref = \"junit\" }\r\nandroidx-junit = { group = \"androidx.test.ext\", name = \"junit\", version.ref = \"junitVersion\" }\r\nandroidx-espresso-core = { group = \"androidx.test.espresso\", name = \"espresso-core\", version.ref = \"espressoCore\" }\r\nandroidx-lifecycle-runtime-ktx = { group = \"androidx.lifecycle\", name = \"lifecycle-runtime-ktx\", version.ref = \"lifecycleRuntimeKtx\" }\r\nandroidx-activity-compose = { group = \"androidx.activity\", name = \"activity-compose\", version.ref = \"activityCompose\" }\r\nandroidx-compose-bom = { group = \"androidx.compose\", name = \"compose-bom\", version.ref = \"composeBom\" }\r\nandroidx-ui = { group = \"androidx.compose.ui\", name = \"ui\" }\r\nandroidx-ui-graphics = { group = \"androidx.compose.ui\", name = \"ui-graphics\" }\r\nandroidx-ui-tooling = { group = \"androidx.compose.ui\", name = \"ui-tooling\" }\r\nandroidx-ui-tooling-preview = { group = \"androidx.compose.ui\", name = \"ui-tooling-preview\" }\r\nandroidx-ui-test-manifest = { group = \"androidx.compose.ui\", name = \"ui-test-manifest\" }\r\nandroidx-ui-test-junit4 = { group = \"androidx.compose.ui\", name = \"ui-test-junit4\" }\r\nandroidx-material3 = { group = \"androidx.compose.material3\", name = \"material3\" }\r\n#Practica\r\nconstraintlayout-compose = { module = \"androidx.constraintlayout:constraintlayout-compose\", version.ref = \"constraintlayoutCompose\" }\r\nnavigation-compose = { module = \"androidx.navigation:navigation-compose\", version.ref = \"navigationCompose\" }\r\nandroidx-compose-foundation = { group = \"androidx.compose.foundation\", name = \"foundation\", version.ref = \"foundation\" }\r\nandroidx-appcompat = { module = \"androidx.appcompat:appcompat\", version.ref = \"appcompat\" }\r\ngoogle-material = { module = \"com.google.android.material:material\", version.ref = \"material\" }\r\nfirebase-bom = { module = \"com.google.firebase:firebase-bom\", version.ref = \"firebase-bom\" }\r\nfirebase-firestore = { module = \"com.google.firebase:firebase-firestore-ktx\" }\r\n\r\n[plugins]\r\nandroid-application = { id = \"com.android.application\", version.ref = \"agp\" }\r\nkotlin-android = { id = \"org.jetbrains.kotlin.android\", version.ref = \"kotlin\" }\r\nkotlin-compose = { id = \"org.jetbrains.kotlin.plugin.compose\", version.ref = \"kotlin\" }\r\nfirebase-gservices = { id = \"com.google.gms.google-services\", version.ref = \"firebase-gservices\" }\r\n\r\n\r\n
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
+------- a/gradle/libs.versions.toml	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/gradle/libs.versions.toml	(date 1762366234772)
+----@@ -1,6 +1,6 @@
+---- [versions]
+---- agp = "8.11.1" #no cambiar de la 8.11.1
+-----kotlin = "2.0.21"
+----+kotlin = "2.2.21"
+---- coreKtx = "1.17.0"
+---- junit = "4.13.2"
+---- junitVersion = "1.3.0"
+----@@ -16,6 +16,8 @@
+---- material = "1.12.0"
+---- firebase-gservices = "4.4.4"
+---- firebase-bom = "33.1.0"
+----+#panoramicas
+----+panoramaGL = "1.11.0"
+---- 
+---- [libraries]
+---- androidx-core-ktx = { group = "androidx.core", name = "core-ktx", version.ref = "coreKtx" }
+----@@ -40,7 +42,8 @@
+---- google-material = { module = "com.google.android.material:material", version.ref = "material" }
+---- firebase-bom = { module = "com.google.firebase:firebase-bom", version.ref = "firebase-bom" }
+---- firebase-firestore = { module = "com.google.firebase:firebase-firestore-ktx" }
+-----
+----+#Panoramicas
+----+panoramaGL = { module = "com.github.hannesa2:panoramaGL", version.ref = "panoramaGL" }
+---- [plugins]
+---- android-application = { id = "com.android.application", version.ref = "agp" }
+---- kotlin-android = { id = "org.jetbrains.kotlin.android", version.ref = "kotlin" }
+----Index: app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+>package com.nextapp.monasterio.ui.navigation\r\n\r\nimport androidx.compose.foundation.clickable\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.navigation.NavGraph.Companion.findStartDestination\r\nimport androidx.navigation.NavHostController\r\nimport androidx.navigation.NavType\r\nimport androidx.navigation.navArgument\r\nimport androidx.navigation.compose.NavHost\r\nimport androidx.navigation.compose.composable\r\nimport com.nextapp.monasterio.AppRoutes\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.ui.screens.*\r\nimport com.nextapp.monasterio.ui.theme.MonasteryRed\r\nimport com.nextapp.monasterio.ui.theme.White\r\nimport kotlinx.coroutines.CoroutineScope\r\nimport kotlinx.coroutines.launch\r\nimport com.nextapp.monasterio.ui.virtualvisit.screens.PinDetalleScreen\r\n\r\n@Composable\r\nfun AppNavigationHost(\r\n    navController: NavHostController,\r\n    modifier: Modifier = Modifier\r\n) {\r\n    NavHost(\r\n        navController = navController,\r\n        startDestination = AppRoutes.INICIO,\r\n        modifier = modifier\r\n    ) {\r\n        composable(AppRoutes.INICIO)   { HomeScreenContent(navController = navController) }\r\n        composable(AppRoutes.INFO)     { InfoScreen() }\r\n        composable(AppRoutes.HISTORIA) { HistoriaScreen() }\r\n        composable(AppRoutes.GALERIA)  { GaleriaScreen() }\r\n        composable(AppRoutes.PERFIL)   { ProfileScreen() }\r\n        composable(AppRoutes.AJUSTES)  { AjustesScreen() }\r\n        composable(AppRoutes.OPCIONES_RESERVA) { OpcionesReservaScreen(navController = navController) }\r\n        composable(AppRoutes.RESERVA) { ReservaScreen(navController = navController) }\r\n        composable(\r\n            route = AppRoutes.CONFIRMACION_RESERVA + \"/{nombre}/{email}/{fecha}/{hora}\",\r\n            arguments = listOf(\r\n                navArgument(\"nombre\") { type = NavType.StringType },\r\n                navArgument(\"email\") { type = NavType.StringType },\r\n                navArgument(\"fecha\") { type = NavType.StringType },\r\n                navArgument(\"hora\") { type = NavType.StringType }\r\n            )\r\n        ) { backStackEntry ->\r\n            val nombre = backStackEntry.arguments?.getString(\"nombre\") ?: \"\"\r\n            val email = backStackEntry.arguments?.getString(\"email\") ?: \"\"\r\n            val fecha = backStackEntry.arguments?.getString(\"fecha\") ?: \"\"\r\n            val hora = backStackEntry.arguments?.getString(\"hora\") ?: \"\"\r\n            ConfirmacionReservaScreen(\r\n                navController = navController,\r\n                nombre = nombre,\r\n                email = email,\r\n                fecha = fecha,\r\n                hora = hora\r\n            )\r\n        }\r\n\r\n        // ✅ Corrección aquí: pasamos el navController principal\r\n        composable(AppRoutes.VIRTUAL_VISIT) {\r\n            VirtualVisitScreen(navController = navController)\r\n        }\r\n\r\n        // \uD83D\uDC47 Ruta inmersiva\r\n        composable(AppRoutes.PIN_DETALLE) {\r\n            PinDetalleScreen(navController = navController)\r\n\r\n        }\r\n    }\r\n}\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun AppDrawerContent(\r\n    navController: NavHostController,\r\n    scope: CoroutineScope,\r\n    drawerState: DrawerState\r\n) {\r\n    val navigateTo: (String) -> Unit = { route ->\r\n        navController.navigate(route) {\r\n            popUpTo(navController.graph.findStartDestination().id)\r\n            launchSingleTop = true\r\n        }\r\n        scope.launch { drawerState.close() }\r\n    }\r\n\r\n    ModalDrawerSheet(\r\n        modifier = Modifier.fillMaxHeight(),\r\n        drawerContainerColor = MonasteryRed,\r\n        drawerContentColor = White\r\n    ) {\r\n        Column(\r\n            modifier = Modifier\r\n                .fillMaxSize()\r\n                .padding(16.dp)\r\n        ) {\r\n            IconButton(onClick = { scope.launch { drawerState.close() } }) {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.ic_menu_24),\r\n                    contentDescription = stringResource(id = R.string.navigation_drawer_close)\r\n                )\r\n            }\r\n            Spacer(modifier = Modifier.height(32.dp))\r\n\r\n            DrawerMenuItem(\r\n                text = stringResource(id = R.string.title_inicio),\r\n                onClick = { navigateTo(AppRoutes.INICIO) }\r\n            )\r\n            DrawerMenuItem(\r\n                text = stringResource(id = R.string.menu_info),\r\n                onClick = { navigateTo(AppRoutes.INFO) }\r\n            )\r\n            DrawerMenuItem(\r\n                text = stringResource(id = R.string.menu_history),\r\n                onClick = { navigateTo(AppRoutes.HISTORIA) }\r\n            )\r\n            DrawerMenuItem(\r\n                text = stringResource(id = R.string.menu_gallery),\r\n                onClick = { navigateTo(AppRoutes.GALERIA) }\r\n            )\r\n            DrawerMenuItem(\r\n                text = stringResource(id = R.string.menu_profile),\r\n                onClick = { navigateTo(AppRoutes.PERFIL) }\r\n            )\r\n            DrawerMenuItem(\r\n                text = stringResource(id = R.string.menu_settings),\r\n                onClick = { navigateTo(AppRoutes.AJUSTES) }\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\n@Composable\r\nfun DrawerMenuItem(\r\n    text: String,\r\n    onClick: () -> Unit\r\n) {\r\n    Row(\r\n        modifier = Modifier\r\n            .fillMaxWidth()\r\n            .clickable(onClick = onClick)\r\n            .padding(vertical = 12.dp),\r\n        verticalAlignment = Alignment.CenterVertically\r\n    ) {\r\n        Icon(\r\n            painter = painterResource(id = R.drawable.arrow_right),\r\n            contentDescription = null,\r\n            modifier = Modifier.size(20.dp)\r\n        )\r\n        Spacer(modifier = Modifier.width(16.dp))\r\n        Text(\r\n            text = text,\r\n            color = White,\r\n            style = MaterialTheme.typography.bodyMedium\r\n        )\r\n    }\r\n}
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt b/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt
+------- a/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt	(date 1762358031480)
+----@@ -11,13 +11,13 @@
+---- import androidx.compose.ui.unit.dp
+---- import androidx.navigation.NavGraph.Companion.findStartDestination
+---- import androidx.navigation.NavHostController
+-----import androidx.navigation.NavType
+-----import androidx.navigation.navArgument
+----+import androidx.navigation.NavType // <-- Asegúrate de que este import existe
+----+import androidx.navigation.navArgument // <-- Asegúrate de que este import existe
+---- import androidx.navigation.compose.NavHost
+---- import androidx.navigation.compose.composable
+---- import com.nextapp.monasterio.AppRoutes
+---- import com.nextapp.monasterio.R
+-----import com.nextapp.monasterio.ui.screens.*
+----+import com.nextapp.monasterio.ui.screens.* // <-- Asegúrate de importar PanoramaScreen
+---- import com.nextapp.monasterio.ui.theme.MonasteryRed
+---- import com.nextapp.monasterio.ui.theme.White
+---- import kotlinx.coroutines.CoroutineScope
+----@@ -37,9 +37,33 @@
+----         composable(AppRoutes.INICIO)   { HomeScreenContent(navController = navController) }
+----         composable(AppRoutes.INFO)     { InfoScreen() }
+----         composable(AppRoutes.HISTORIA) { HistoriaScreen() }
+-----        composable(AppRoutes.GALERIA)  { GaleriaScreen() }
+----+
+----+        // --- ESTA LÍNEA ESTÁ CORRECTA ---
+----+        // Pasa el NavController a GaleriaScreen para que su botón funcione
+----+        composable(AppRoutes.GALERIA)  { GaleriaScreen(navController = navController) }
+----+
+----         composable(AppRoutes.PERFIL)   { ProfileScreen() }
+----         composable(AppRoutes.AJUSTES)  { AjustesScreen() }
+----+
+----+        // --- ESTA ES LA MODIFICACIÓN FINAL ---
+----+        // Reemplazamos la línea simple de 'PANORAMA' por esta con argumentos
+----+        composable(
+----+            route = AppRoutes.PANORAMA + "/{vistaId}", // 1. La ruta espera un ID
+----+            arguments = listOf(navArgument("vistaId") { type = NavType.StringType }) // 2. Definimos el ID
+----+        ) { backStackEntry ->
+----+            // 3. Recogemos el ID de la URL
+----+            val vistaId = backStackEntry.arguments?.getString("vistaId")
+----+
+----+            // 4. Se lo pasamos a PanoramaScreen
+----+            if (vistaId != null) {
+----+                PanoramaScreen(
+----+                    vistaId = vistaId,
+----+                    navController = navController
+----+                )
+----+            }
+----+        }
+----+
+----+        // --- RESTO DE TUS RUTAS (sin cambios) ---
+----         composable(AppRoutes.OPCIONES_RESERVA) { OpcionesReservaScreen(navController = navController) }
+----         composable(AppRoutes.RESERVA) { ReservaScreen(navController = navController) }
+----         composable(
+----@@ -64,19 +88,19 @@
+----             )
+----         }
+---- 
+-----        // ✅ Corrección aquí: pasamos el navController principal
+----         composable(AppRoutes.VIRTUAL_VISIT) {
+----             VirtualVisitScreen(navController = navController)
+----         }
+---- 
+-----        // 👇 Ruta inmersiva
+----         composable(AppRoutes.PIN_DETALLE) {
+----             PinDetalleScreen(navController = navController)
+-----
+----         }
+----     }
+---- }
+---- 
+----+//
+----+// --- EL RESTO DEL ARCHIVO SE QUEDA EXACTAMENTE IGUAL ---
+----+//
+---- @OptIn(ExperimentalMaterial3Api::class)
+---- @Composable
+---- fun AppDrawerContent(
+----Index: app/build.gradle.kts
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+>plugins {\r\n    alias(libs.plugins.android.application)\r\n    alias(libs.plugins.kotlin.android)\r\n    alias(libs.plugins.kotlin.compose)\r\n    alias(libs.plugins.firebase.gservices)\r\n}\r\n\r\nandroid {\r\n    namespace = \"com.nextapp.monasterio\"\r\n    compileSdk = 36\r\n\r\n    defaultConfig {\r\n        applicationId = \"com.nextapp.monasterio\"\r\n        minSdk = 24\r\n        targetSdk = 36\r\n        versionCode = 1\r\n        versionName = \"1.0\"\r\n\r\n        testInstrumentationRunner = \"androidx.test.runner.AndroidJUnitRunner\"\r\n    }\r\n\r\n    buildTypes {\r\n        release {\r\n            isMinifyEnabled = false\r\n            proguardFiles(\r\n                getDefaultProguardFile(\"proguard-android-optimize.txt\"),\r\n                \"proguard-rules.pro\"\r\n            )\r\n        }\r\n    }\r\n    compileOptions {\r\n        sourceCompatibility = JavaVersion.VERSION_11\r\n        targetCompatibility = JavaVersion.VERSION_11\r\n    }\r\n    kotlinOptions {\r\n        jvmTarget = \"11\"\r\n    }\r\n    buildFeatures {\r\n        compose = true\r\n    }\r\n}\r\n\r\ndependencies {\r\n\r\n    implementation(libs.androidx.core.ktx)\r\n    implementation(libs.androidx.lifecycle.runtime.ktx)\r\n    implementation(libs.androidx.activity.compose)\r\n    implementation(platform(libs.androidx.compose.bom))\r\n    implementation(libs.androidx.ui)\r\n    implementation(libs.androidx.ui.graphics)\r\n    implementation(libs.androidx.ui.tooling.preview)\r\n    implementation(libs.androidx.material3)\r\n    implementation(libs.androidx.compose.foundation)\r\n    testImplementation(libs.junit)\r\n    androidTestImplementation(libs.androidx.junit)\r\n    androidTestImplementation(libs.androidx.espresso.core)\r\n    androidTestImplementation(platform(libs.androidx.compose.bom))\r\n    androidTestImplementation(libs.androidx.ui.test.junit4)\r\n    debugImplementation(libs.androidx.ui.tooling)\r\n    debugImplementation(libs.androidx.ui.test.manifest)\r\n    //Practica\r\n    implementation(libs.constraintlayout.compose)\r\n    implementation(libs.navigation.compose)\r\n    implementation (libs.androidx.appcompat)\r\n    implementation (libs.google.material)\r\n\r\n    // Firebase\r\n    implementation(platform(libs.firebase.bom))\r\n    implementation(libs.firebase.firestore)\r\n    implementation(\"com.google.firebase:firebase-auth-ktx\")\r\n\r\n    implementation(\"com.caverock:androidsvg:1.4\")\r\n    implementation(\"androidx.core:core-ktx:1.12.0\")\r\n    implementation(\"com.google.android.material:material:1.10.0\")\r\n\r\n    // Plano Interactivo\r\n    implementation(\"io.github.chrisbanes:PhotoView:2.3.0\")\r\n\r\n\r\n}\r\n
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/app/build.gradle.kts b/app/build.gradle.kts
+------- a/app/build.gradle.kts	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/app/build.gradle.kts	(date 1762361761297)
+----@@ -76,5 +76,7 @@
+----     // Plano Interactivo
+----     implementation("io.github.chrisbanes:PhotoView:2.3.0")
+---- 
+----+    // Panoramica
+----+    implementation("com.github.hannesa2:panoramagl:1.14")
+---- 
+---- }
+----Index: app/src/main/java/com/nextapp/monasterio/ui/screens/PlaceHolderScreens.kt
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+>package com.nextapp.monasterio.ui.screens\r\n\r\nimport androidx.compose.foundation.layout.Box\r\nimport androidx.compose.foundation.layout.fillMaxSize\r\nimport androidx.compose.material3.MaterialTheme\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\n\r\n//Pantallas aun vacias, borrar archivo cuando las pantallas tengan contenido\r\n\r\n@Composable\r\nfun GaleriaScreen() {\r\n    Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {\r\n        Text(text = \"Contenido de Galería\", style = MaterialTheme.typography.headlineMedium)\r\n    }\r\n}\r\n\r\n/*@Composable\r\nfun PerfilScreen() {\r\n    Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {\r\n        Text(text = \"Contenido de Perfil\", style = MaterialTheme.typography.headlineMedium)\r\n    }\r\n}*/
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/app/src/main/java/com/nextapp/monasterio/ui/screens/PlaceHolderScreens.kt b/app/src/main/java/com/nextapp/monasterio/ui/screens/PlaceHolderScreens.kt
+------- a/app/src/main/java/com/nextapp/monasterio/ui/screens/PlaceHolderScreens.kt	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/app/src/main/java/com/nextapp/monasterio/ui/screens/PlaceHolderScreens.kt	(date 1762358031411)
+----@@ -1,25 +1,56 @@
+----+// En: ui/screens/PlaceholderScreens.kt (o donde esté GaleriaScreen)
+----+
+---- package com.nextapp.monasterio.ui.screens
+---- 
+-----import androidx.compose.foundation.layout.Box
+----+import androidx.compose.foundation.layout.fillMaxWidth
+----+import androidx.compose.foundation.layout.Arrangement
+----+import androidx.compose.foundation.layout.Column
+----+import androidx.compose.foundation.layout.Spacer
+---- import androidx.compose.foundation.layout.fillMaxSize
+-----import androidx.compose.material3.MaterialTheme
+----+import androidx.compose.foundation.layout.height
+----+import androidx.compose.foundation.layout.padding
+----+import androidx.compose.foundation.lazy.LazyColumn // ¡Importante!
+----+import androidx.compose.material3.Button
+---- import androidx.compose.material3.Text
+---- import androidx.compose.runtime.Composable
+---- import androidx.compose.ui.Alignment
+---- import androidx.compose.ui.Modifier
+-----
+-----//Pantallas aun vacias, borrar archivo cuando las pantallas tengan contenido
+----+import androidx.compose.ui.unit.dp
+----+import androidx.navigation.NavController
+----+import com.nextapp.monasterio.AppRoutes
+----+import com.nextapp.monasterio.data.MonasterioMapRepository // ¡Importante!
+---- 
+---- @Composable
+-----fun GaleriaScreen() {
+-----    Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {
+-----        Text(text = "Contenido de Galería", style = MaterialTheme.typography.headlineMedium)
+----+fun GaleriaScreen(navController: NavController) { // Recuerda que recibe NavController
+----+
+----+    // 1. Obtenemos la lista completa de vistas del repositorio
+----+    val vistas = MonasterioMapRepository.getVistas()
+----+
+----+    // 2. Usamos LazyColumn para mostrar eficientemente la lista de botones
+----+    LazyColumn(
+----+        modifier = Modifier
+----+            .fillMaxSize()
+----+            .padding(horizontal = 32.dp), // Añadimos padding
+----+        verticalArrangement = Arrangement.Center,
+----+        horizontalAlignment = Alignment.CenterHorizontally
+----+    ) {
+----+        // 3. Creamos un item (un botón) por cada vista en la lista
+----+        items(vistas.size) { index ->
+----+            val vista = vistas[index]
+----+
+----+            Button(
+----+                onClick = {
+----+                    // 4. Al hacer clic, navega a PanoramaScreen con el ID de la vista
+----+                    navController.navigate(AppRoutes.PANORAMA + "/${vista.id}")
+----+                },
+----+                modifier = Modifier.fillMaxWidth() // Hacemos que los botones sean anchos
+----+            ) {
+----+                Text(text = vista.nombre) // Mostramos el nombre descriptivo
+----+            }
+----+
+----+            Spacer(modifier = Modifier.height(16.dp))
+----+        }
+----     }
+---- }
+---- 
+-----/*@Composable
+-----fun PerfilScreen() {
+-----    Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {
+-----        Text(text = "Contenido de Perfil", style = MaterialTheme.typography.headlineMedium)
+-----    }
+-----}*/
+----\ No newline at end of file
+----+// ... (tus otros PlaceholderScreens como PerfilScreen, etc.)
+----\ No newline at end of file
+----Index: .idea/inspectionProfiles/Project_Default.xml
+----===================================================================
+----diff --git a/.idea/inspectionProfiles/Project_Default.xml b/.idea/inspectionProfiles/Project_Default.xml
+----deleted file mode 100644
+------- a/.idea/inspectionProfiles/Project_Default.xml	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ /dev/null	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----@@ -1,61 +0,0 @@
+-----<component name="InspectionProjectProfileManager">
+-----  <profile version="1.0">
+-----    <option name="myName" value="Project Default" />
+-----    <inspection_tool class="ComposePreviewDimensionRespectsLimit" enabled="true" level="WARNING" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="ComposePreviewMustBeTopLevelFunction" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="ComposePreviewNeedsComposableAnnotation" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="ComposePreviewNotSupportedInUnitTestFiles" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="GlancePreviewDimensionRespectsLimit" enabled="true" level="WARNING" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="GlancePreviewMustBeTopLevelFunction" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="GlancePreviewNeedsComposableAnnotation" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="GlancePreviewNotSupportedInUnitTestFiles" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="PreviewAnnotationInFunctionWithParameters" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="PreviewApiLevelMustBeValid" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="PreviewDeviceShouldUseNewSpec" enabled="true" level="WEAK WARNING" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="PreviewFontScaleMustBeGreaterThanZero" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="PreviewMultipleParameterProviders" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="PreviewParameterProviderOnFirstParameter" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----    <inspection_tool class="PreviewPickerAnnotation" enabled="true" level="ERROR" enabled_by_default="true">
+-----      <option name="composableFile" value="true" />
+-----      <option name="previewFile" value="true" />
+-----    </inspection_tool>
+-----  </profile>
+-----</component>
+----\ No newline at end of file
+----Index: .idea/studiobot.xml
+----===================================================================
+----diff --git a/.idea/studiobot.xml b/.idea/studiobot.xml
+----deleted file mode 100644
+------- a/.idea/studiobot.xml	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ /dev/null	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----@@ -1,6 +0,0 @@
+-----<?xml version="1.0" encoding="UTF-8"?>
+-----<project version="4">
+-----  <component name="StudioBotProjectSettings">
+-----    <option name="shareContext" value="OptedIn" />
+-----  </component>
+-----</project>
+----\ No newline at end of file
+----Index: .idea/codeStyles/codeStyleConfig.xml
+----===================================================================
+----diff --git a/.idea/codeStyles/codeStyleConfig.xml b/.idea/codeStyles/codeStyleConfig.xml
+----deleted file mode 100644
+------- a/.idea/codeStyles/codeStyleConfig.xml	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ /dev/null	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----@@ -1,5 +0,0 @@
+-----<component name="ProjectCodeStyleConfiguration">
+-----  <state>
+-----    <option name="USE_PER_PROJECT_SETTINGS" value="true" />
+-----  </state>
+-----</component>
+----\ No newline at end of file
+----Index: .idea/androidTestResultsUserPreferences.xml
+----===================================================================
+----diff --git a/.idea/androidTestResultsUserPreferences.xml b/.idea/androidTestResultsUserPreferences.xml
+----deleted file mode 100644
+------- a/.idea/androidTestResultsUserPreferences.xml	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ /dev/null	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----@@ -1,22 +0,0 @@
+-----<?xml version="1.0" encoding="UTF-8"?>
+-----<project version="4">
+-----  <component name="AndroidTestResultsUserPreferences">
+-----    <option name="androidTestResultsTableState">
+-----      <map>
+-----        <entry key="28629151">
+-----          <value>
+-----            <AndroidTestResultsTableState>
+-----              <option name="preferredColumnWidths">
+-----                <map>
+-----                  <entry key="Duration" value="90" />
+-----                  <entry key="Medium_Phone_API_36.0" value="120" />
+-----                  <entry key="Tests" value="360" />
+-----                </map>
+-----              </option>
+-----            </AndroidTestResultsTableState>
+-----          </value>
+-----        </entry>
+-----      </map>
+-----    </option>
+-----  </component>
+-----</project>
+----\ No newline at end of file
+----Index: .idea/codeStyles/Project.xml
+----===================================================================
+----diff --git a/.idea/codeStyles/Project.xml b/.idea/codeStyles/Project.xml
+----deleted file mode 100644
+------- a/.idea/codeStyles/Project.xml	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ /dev/null	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----@@ -1,123 +0,0 @@
+-----<component name="ProjectCodeStyleConfiguration">
+-----  <code_scheme name="Project" version="173">
+-----    <JetCodeStyleSettings>
+-----      <option name="CODE_STYLE_DEFAULTS" value="KOTLIN_OFFICIAL" />
+-----    </JetCodeStyleSettings>
+-----    <codeStyleSettings language="XML">
+-----      <option name="FORCE_REARRANGE_MODE" value="1" />
+-----      <indentOptions>
+-----        <option name="CONTINUATION_INDENT_SIZE" value="4" />
+-----      </indentOptions>
+-----      <arrangement>
+-----        <rules>
+-----          <section>
+-----            <rule>
+-----              <match>
+-----                <AND>
+-----                  <NAME>xmlns:android</NAME>
+-----                  <XML_ATTRIBUTE />
+-----                  <XML_NAMESPACE>^$</XML_NAMESPACE>
+-----                </AND>
+-----              </match>
+-----            </rule>
+-----          </section>
+-----          <section>
+-----            <rule>
+-----              <match>
+-----                <AND>
+-----                  <NAME>xmlns:.*</NAME>
+-----                  <XML_ATTRIBUTE />
+-----                  <XML_NAMESPACE>^$</XML_NAMESPACE>
+-----                </AND>
+-----              </match>
+-----              <order>BY_NAME</order>
+-----            </rule>
+-----          </section>
+-----          <section>
+-----            <rule>
+-----              <match>
+-----                <AND>
+-----                  <NAME>.*:id</NAME>
+-----                  <XML_ATTRIBUTE />
+-----                  <XML_NAMESPACE>http://schemas.android.com/apk/res/android</XML_NAMESPACE>
+-----                </AND>
+-----              </match>
+-----            </rule>
+-----          </section>
+-----          <section>
+-----            <rule>
+-----              <match>
+-----                <AND>
+-----                  <NAME>.*:name</NAME>
+-----                  <XML_ATTRIBUTE />
+-----                  <XML_NAMESPACE>http://schemas.android.com/apk/res/android</XML_NAMESPACE>
+-----                </AND>
+-----              </match>
+-----            </rule>
+-----          </section>
+-----          <section>
+-----            <rule>
+-----              <match>
+-----                <AND>
+-----                  <NAME>name</NAME>
+-----                  <XML_ATTRIBUTE />
+-----                  <XML_NAMESPACE>^$</XML_NAMESPACE>
+-----                </AND>
+-----              </match>
+-----            </rule>
+-----          </section>
+-----          <section>
+-----            <rule>
+-----              <match>
+-----                <AND>
+-----                  <NAME>style</NAME>
+-----                  <XML_ATTRIBUTE />
+-----                  <XML_NAMESPACE>^$</XML_NAMESPACE>
+-----                </AND>
+-----              </match>
+-----            </rule>
+-----          </section>
+-----          <section>
+-----            <rule>
+-----              <match>
+-----                <AND>
+-----                  <NAME>.*</NAME>
+-----                  <XML_ATTRIBUTE />
+-----                  <XML_NAMESPACE>^$</XML_NAMESPACE>
+-----                </AND>
+-----              </match>
+-----              <order>BY_NAME</order>
+-----            </rule>
+-----          </section>
+-----          <section>
+-----            <rule>
+-----              <match>
+-----                <AND>
+-----                  <NAME>.*</NAME>
+-----                  <XML_ATTRIBUTE />
+-----                  <XML_NAMESPACE>http://schemas.android.com/apk/res/android</XML_NAMESPACE>
+-----                </AND>
+-----              </match>
+-----              <order>ANDROID_ATTRIBUTE_ORDER</order>
+-----            </rule>
+-----          </section>
+-----          <section>
+-----            <rule>
+-----              <match>
+-----                <AND>
+-----                  <NAME>.*</NAME>
+-----                  <XML_ATTRIBUTE />
+-----                  <XML_NAMESPACE>.*</XML_NAMESPACE>
+-----                </AND>
+-----              </match>
+-----              <order>BY_NAME</order>
+-----            </rule>
+-----          </section>
+-----        </rules>
+-----      </arrangement>
+-----    </codeStyleSettings>
+-----    <codeStyleSettings language="kotlin">
+-----      <option name="CODE_STYLE_DEFAULTS" value="KOTLIN_OFFICIAL" />
+-----    </codeStyleSettings>
+-----  </code_scheme>
+-----</component>
+----\ No newline at end of file
+----Index: .idea/.gitignore
+----===================================================================
+----diff --git a/.idea/.gitignore b/.idea/.gitignore
+----deleted file mode 100644
+------- a/.idea/.gitignore	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ /dev/null	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----@@ -1,3 +0,0 @@
+-----# Default ignored files
+-----/shelf/
+-----/workspace.xml
+----Index: .idea/misc.xml
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+><project version=\"4\">\r\n  <component name=\"ExternalStorageConfigurationManager\" enabled=\"true\" />\r\n  <component name=\"ProjectRootManager\" version=\"2\" languageLevel=\"JDK_21\" default=\"true\" project-jdk-name=\"jbr-21\" project-jdk-type=\"JavaSDK\">\r\n    <output url=\"file://$PROJECT_DIR$/build/classes\" />\r\n  </component>\r\n  <component name=\"ProjectType\">\r\n    <option name=\"id\" value=\"Android\" />\r\n  </component>\r\n</project>
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/.idea/misc.xml b/.idea/misc.xml
+------- a/.idea/misc.xml	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/.idea/misc.xml	(date 1762365946520)
+----@@ -1,9 +1,5 @@
+----+<?xml version="1.0" encoding="UTF-8"?>
+---- <project version="4">
+----   <component name="ExternalStorageConfigurationManager" enabled="true" />
+-----  <component name="ProjectRootManager" version="2" languageLevel="JDK_21" default="true" project-jdk-name="jbr-21" project-jdk-type="JavaSDK">
+-----    <output url="file://$PROJECT_DIR$/build/classes" />
+-----  </component>
+-----  <component name="ProjectType">
+-----    <option name="id" value="Android" />
+-----  </component>
+----+  <component name="ProjectRootManager" version="2" languageLevel="JDK_21" default="true" project-jdk-name="jbr-21" project-jdk-type="JavaSDK" />
+---- </project>
+----\ No newline at end of file
+----Index: .idea/gradle.xml
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"GradleMigrationSettings\" migrationVersion=\"1\" />\r\n  <component name=\"GradleSettings\">\r\n    <option name=\"linkedExternalProjectsSettings\">\r\n      <GradleProjectSettings>\r\n        <option name=\"testRunner\" value=\"CHOOSE_PER_TEST\" />\r\n        <option name=\"externalProjectPath\" value=\"$PROJECT_DIR$\" />\r\n        <option name=\"gradleJvm\" value=\"#GRADLE_LOCAL_JAVA_HOME\" />\r\n        <option name=\"modules\">\r\n          <set>\r\n            <option value=\"$PROJECT_DIR$\" />\r\n            <option value=\"$PROJECT_DIR$/app\" />\r\n          </set>\r\n        </option>\r\n      </GradleProjectSettings>\r\n    </option>\r\n  </component>\r\n</project>
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/.idea/gradle.xml b/.idea/gradle.xml
+------- a/.idea/gradle.xml	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/.idea/gradle.xml	(date 1762365946571)
+----@@ -1,6 +1,5 @@
+---- <?xml version="1.0" encoding="UTF-8"?>
+---- <project version="4">
+-----  <component name="GradleMigrationSettings" migrationVersion="1" />
+----   <component name="GradleSettings">
+----     <option name="linkedExternalProjectsSettings">
+----       <GradleProjectSettings>
+----Index: .idea/vcs.xml
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"VcsDirectoryMappings\">\r\n    <mapping directory=\"$PROJECT_DIR$\" vcs=\"Git\" />\r\n  </component>\r\n</project>
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/.idea/vcs.xml b/.idea/vcs.xml
+------- a/.idea/vcs.xml	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/.idea/vcs.xml	(date 1762365792809)
+----@@ -1,6 +1,6 @@
+---- <?xml version="1.0" encoding="UTF-8"?>
+---- <project version="4">
+----   <component name="VcsDirectoryMappings">
+-----    <mapping directory="$PROJECT_DIR$" vcs="Git" />
+----+    <mapping directory="" vcs="Git" />
+----   </component>
+---- </project>
+----\ No newline at end of file
+----Index: .idea/deploymentTargetSelector.xml
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"deploymentTargetSelector\">\r\n    <selectionStates>\r\n      <SelectionState runConfigName=\"app\">\r\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\r\n        <DropdownSelection timestamp=\"2025-11-02T21:37:26.652388500Z\">\r\n          <Target type=\"DEFAULT_BOOT\">\r\n            <handle>\r\n              <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=R52T40GVQQB\" />\r\n            </handle>\r\n          </Target>\r\n        </DropdownSelection>\r\n        <DialogSelection>\r\n          <targets>\r\n            <Target type=\"DEFAULT_BOOT\">\r\n              <handle>\r\n                <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=RZCX7216PCM\" />\r\n              </handle>\r\n            </Target>\r\n            <Target type=\"DEFAULT_BOOT\">\r\n              <handle>\r\n                <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=R52T40GVQQB\" />\r\n              </handle>\r\n            </Target>\r\n          </targets>\r\n        </DialogSelection>\r\n      </SelectionState>\r\n    </selectionStates>\r\n  </component>\r\n</project>
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/.idea/deploymentTargetSelector.xml b/.idea/deploymentTargetSelector.xml
+------- a/.idea/deploymentTargetSelector.xml	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/.idea/deploymentTargetSelector.xml	(date 1762365792841)
+----@@ -4,27 +4,6 @@
+----     <selectionStates>
+----       <SelectionState runConfigName="app">
+----         <option name="selectionMode" value="DROPDOWN" />
+-----        <DropdownSelection timestamp="2025-11-02T21:37:26.652388500Z">
+-----          <Target type="DEFAULT_BOOT">
+-----            <handle>
+-----              <DeviceId pluginId="PhysicalDevice" identifier="serial=R52T40GVQQB" />
+-----            </handle>
+-----          </Target>
+-----        </DropdownSelection>
+-----        <DialogSelection>
+-----          <targets>
+-----            <Target type="DEFAULT_BOOT">
+-----              <handle>
+-----                <DeviceId pluginId="PhysicalDevice" identifier="serial=RZCX7216PCM" />
+-----              </handle>
+-----            </Target>
+-----            <Target type="DEFAULT_BOOT">
+-----              <handle>
+-----                <DeviceId pluginId="PhysicalDevice" identifier="serial=R52T40GVQQB" />
+-----              </handle>
+-----            </Target>
+-----          </targets>
+-----        </DialogSelection>
+----       </SelectionState>
+----     </selectionStates>
+----   </component>
+----Index: app/src/main/java/com/nextapp/monasterio/AppRoutes.kt
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+>package com.nextapp.monasterio\r\n\r\n/**\r\n * Define todas las rutas (llaves) de navegación en un solo lugar\r\n * para evitar errores de escritura y centralizar la gestión.\r\n */\r\nobject AppRoutes {\r\n    const val INICIO = \"inicio\"\r\n    const val INFO = \"info\"\r\n    const val HISTORIA = \"historia\"\r\n    const val GALERIA = \"galeria\"\r\n    const val PERFIL = \"perfil\"\r\n    const val AJUSTES = \"ajustes\"\r\n    const val OPCIONES_RESERVA = \"opciones_reserva\"\r\n    const val RESERVA = \"reserva\"\r\n    const val CONFIRMACION_RESERVA = \"confirmacion_reserva\"\r\n    const val VIRTUAL_VISIT = \"virtual_visit\"\r\n    const val PIN_DETALLE = \"pin_detalle\"\r\n}\r\n
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/app/src/main/java/com/nextapp/monasterio/AppRoutes.kt b/app/src/main/java/com/nextapp/monasterio/AppRoutes.kt
+------- a/app/src/main/java/com/nextapp/monasterio/AppRoutes.kt	(revision 908520697335b64df4dc786e407d3b983b76a621)
+----+++ b/app/src/main/java/com/nextapp/monasterio/AppRoutes.kt	(date 1762358031507)
+----@@ -16,4 +16,5 @@
+----     const val CONFIRMACION_RESERVA = "confirmacion_reserva"
+----     const val VIRTUAL_VISIT = "virtual_visit"
+----     const val PIN_DETALLE = "pin_detalle"
+----+    const val PANORAMA = "panorama"
+---- }
+---Index: .idea/shelf/Uncommitted_changes_before_Update_at_05_11_2025_19_15__Changes_.xml
+---===================================================================
+---diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_05_11_2025_19_15__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_05_11_2025_19_15__Changes_.xml
+---deleted file mode 100644
+------ a/.idea/shelf/Uncommitted_changes_before_Update_at_05_11_2025_19_15__Changes_.xml	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ /dev/null	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---@@ -1,7 +0,0 @@
+----<changelist name="Uncommitted_changes_before_Update_at_05_11_2025_19_15_[Changes]" date="1762366521209" recycled="true" deleted="true">
+----  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_05_11_2025_19_15_[Changes]/shelved.patch" />
+----  <option name="DESCRIPTION" value="Uncommitted changes before Update at 05/11/2025 19:15 [Changes]" />
+----  <binary>
+----    <option name="BEFORE_PATH" value=".idea/.name" />
+----  </binary>
+----</changelist>
+---\ No newline at end of file
+---Index: .idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_11_47_[Changes]/shelved.patch
+---===================================================================
+---diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_11_47_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_11_47_[Changes]/shelved.patch
+---deleted file mode 100644
+------ a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_11_47_[Changes]/shelved.patch	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ /dev/null	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---@@ -1,32 +0,0 @@
+----Index: .idea/misc.xml
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ExternalStorageConfigurationManager\" enabled=\"true\" />\r\n  <component name=\"ProjectRootManager\" version=\"2\" languageLevel=\"JDK_21\" default=\"true\" project-jdk-name=\"jbr-21\" project-jdk-type=\"JavaSDK\" />\r\n</project>
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/.idea/misc.xml b/.idea/misc.xml
+------- a/.idea/misc.xml	(revision 708c6a78c122aaa13d5546fe078947800d0c3b61)
+----+++ b/.idea/misc.xml	(date 1762598797154)
+----@@ -1,4 +1,3 @@
+-----<?xml version="1.0" encoding="UTF-8"?>
+---- <project version="4">
+----   <component name="ExternalStorageConfigurationManager" enabled="true" />
+----   <component name="ProjectRootManager" version="2" languageLevel="JDK_21" default="true" project-jdk-name="jbr-21" project-jdk-type="JavaSDK" />
+----Index: .idea/gradle.xml
+----IDEA additional info:
+----Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+----<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"GradleSettings\">\r\n    <option name=\"linkedExternalProjectsSettings\">\r\n      <GradleProjectSettings>\r\n        <option name=\"testRunner\" value=\"CHOOSE_PER_TEST\" />\r\n        <option name=\"externalProjectPath\" value=\"$PROJECT_DIR$\" />\r\n        <option name=\"gradleJvm\" value=\"#GRADLE_LOCAL_JAVA_HOME\" />\r\n        <option name=\"modules\">\r\n          <set>\r\n            <option value=\"$PROJECT_DIR$\" />\r\n            <option value=\"$PROJECT_DIR$/app\" />\r\n          </set>\r\n        </option>\r\n      </GradleProjectSettings>\r\n    </option>\r\n  </component>\r\n</project>
+----Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+----<+>UTF-8
+----===================================================================
+----diff --git a/.idea/gradle.xml b/.idea/gradle.xml
+------- a/.idea/gradle.xml	(revision 708c6a78c122aaa13d5546fe078947800d0c3b61)
+----+++ b/.idea/gradle.xml	(date 1762598845132)
+----@@ -1,5 +1,6 @@
+---- <?xml version="1.0" encoding="UTF-8"?>
+---- <project version="4">
+----+  <component name="GradleMigrationSettings" migrationVersion="1" />
+----   <component name="GradleSettings">
+----     <option name="linkedExternalProjectsSettings">
+----       <GradleProjectSettings>
+---Index: .idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_11_47__Changes_.xml
+---===================================================================
+---diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_11_47__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_11_47__Changes_.xml
+---deleted file mode 100644
+------ a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_11_47__Changes_.xml	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ /dev/null	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---@@ -1,4 +0,0 @@
+----<changelist name="Uncommitted_changes_before_Update_at_08_11_2025_11_47_[Changes]" date="1762598854800" recycled="false" toDelete="true">
+----  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_11_47_[Changes]/shelved.patch" />
+----  <option name="DESCRIPTION" value="Uncommitted changes before Update at 08/11/2025 11:47 [Changes]" />
+----</changelist>
+---\ No newline at end of file
+---Index: .idea/vcs.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"VcsDirectoryMappings\">\r\n    <mapping directory=\"\" vcs=\"Git\" />\r\n  </component>\r\n</project>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/.idea/vcs.xml b/.idea/vcs.xml
+------ a/.idea/vcs.xml	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ b/.idea/vcs.xml	(date 1762631952646)
+---@@ -1,6 +1,6 @@
+--- <?xml version="1.0" encoding="UTF-8"?>
+--- <project version="4">
+---   <component name="VcsDirectoryMappings">
+----    <mapping directory="" vcs="Git" />
+---+    <mapping directory="$PROJECT_DIR$" vcs="Git" />
+---   </component>
+--- </project>
+---\ No newline at end of file
+---Index: .idea/misc.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ExternalStorageConfigurationManager\" enabled=\"true\" />\r\n  <component name=\"ProjectRootManager\" version=\"2\" languageLevel=\"JDK_21\" default=\"true\" project-jdk-name=\"jbr-21\" project-jdk-type=\"JavaSDK\" />\r\n</project>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/.idea/misc.xml b/.idea/misc.xml
+------ a/.idea/misc.xml	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ b/.idea/misc.xml	(date 1762637952730)
+---@@ -1,4 +1,3 @@
+----<?xml version="1.0" encoding="UTF-8"?>
+--- <project version="4">
+---   <component name="ExternalStorageConfigurationManager" enabled="true" />
+---   <component name="ProjectRootManager" version="2" languageLevel="JDK_21" default="true" project-jdk-name="jbr-21" project-jdk-type="JavaSDK" />
+---Index: .idea/deploymentTargetSelector.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"deploymentTargetSelector\">\r\n    <selectionStates>\r\n      <SelectionState runConfigName=\"app\">\r\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\r\n        <DropdownSelection timestamp=\"2025-11-07T14:58:50.699472400Z\">\r\n          <Target type=\"DEFAULT_BOOT\">\r\n            <template>\r\n              <DeviceId pluginId=\"FirebaseDirectAccess\" type=\"TEMPLATE\" identifier=\"model_id=akita/34\" />\r\n            </template>\r\n          </Target>\r\n        </DropdownSelection>\r\n        <DialogSelection>\r\n          <targets>\r\n            <Target type=\"DEFAULT_BOOT\">\r\n              <handle>\r\n                <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=RZCX7216PCM\" />\r\n              </handle>\r\n            </Target>\r\n            <Target type=\"DEFAULT_BOOT\">\r\n              <handle>\r\n                <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=R52T40GVQQB\" />\r\n              </handle>\r\n            </Target>\r\n          </targets>\r\n        </DialogSelection>\r\n      </SelectionState>\r\n    </selectionStates>\r\n  </component>\r\n</project>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/.idea/deploymentTargetSelector.xml b/.idea/deploymentTargetSelector.xml
+------ a/.idea/deploymentTargetSelector.xml	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ b/.idea/deploymentTargetSelector.xml	(date 1762631952663)
+---@@ -4,27 +4,6 @@
+---     <selectionStates>
+---       <SelectionState runConfigName="app">
+---         <option name="selectionMode" value="DROPDOWN" />
+----        <DropdownSelection timestamp="2025-11-07T14:58:50.699472400Z">
+----          <Target type="DEFAULT_BOOT">
+----            <template>
+----              <DeviceId pluginId="FirebaseDirectAccess" type="TEMPLATE" identifier="model_id=akita/34" />
+----            </template>
+----          </Target>
+----        </DropdownSelection>
+----        <DialogSelection>
+----          <targets>
+----            <Target type="DEFAULT_BOOT">
+----              <handle>
+----                <DeviceId pluginId="PhysicalDevice" identifier="serial=RZCX7216PCM" />
+----              </handle>
+----            </Target>
+----            <Target type="DEFAULT_BOOT">
+----              <handle>
+----                <DeviceId pluginId="PhysicalDevice" identifier="serial=R52T40GVQQB" />
+----              </handle>
+----            </Target>
+----          </targets>
+----        </DialogSelection>
+---       </SelectionState>
+---     </selectionStates>
+---   </component>
+---Index: .idea/gradle.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"GradleSettings\">\r\n    <option name=\"linkedExternalProjectsSettings\">\r\n      <GradleProjectSettings>\r\n        <option name=\"testRunner\" value=\"CHOOSE_PER_TEST\" />\r\n        <option name=\"externalProjectPath\" value=\"$PROJECT_DIR$\" />\r\n        <option name=\"gradleJvm\" value=\"#GRADLE_LOCAL_JAVA_HOME\" />\r\n        <option name=\"modules\">\r\n          <set>\r\n            <option value=\"$PROJECT_DIR$\" />\r\n            <option value=\"$PROJECT_DIR$/app\" />\r\n          </set>\r\n        </option>\r\n      </GradleProjectSettings>\r\n    </option>\r\n  </component>\r\n</project>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/.idea/gradle.xml b/.idea/gradle.xml
+------ a/.idea/gradle.xml	(revision 1ce74093873ec1b16c413750e558114559284ef6)
+---+++ b/.idea/gradle.xml	(date 1762632722244)
+---@@ -1,5 +1,6 @@
+--- <?xml version="1.0" encoding="UTF-8"?>
+--- <project version="4">
+---+  <component name="GradleMigrationSettings" migrationVersion="1" />
+---   <component name="GradleSettings">
+---     <option name="linkedExternalProjectsSettings">
+---       <GradleProjectSettings>
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]1/shelved.patch
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]1/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]1/shelved.patch
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]1/shelved.patch	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,17 +0,0 @@
+---Index: .idea/gradle.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"GradleSettings\">\r\n    <option name=\"linkedExternalProjectsSettings\">\r\n      <GradleProjectSettings>\r\n        <option name=\"testRunner\" value=\"CHOOSE_PER_TEST\" />\r\n        <option name=\"externalProjectPath\" value=\"$PROJECT_DIR$\" />\r\n        <option name=\"gradleJvm\" value=\"#GRADLE_LOCAL_JAVA_HOME\" />\r\n        <option name=\"modules\">\r\n          <set>\r\n            <option value=\"$PROJECT_DIR$\" />\r\n            <option value=\"$PROJECT_DIR$/app\" />\r\n          </set>\r\n        </option>\r\n      </GradleProjectSettings>\r\n    </option>\r\n  </component>\r\n</project>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/.idea/gradle.xml b/.idea/gradle.xml
+------ a/.idea/gradle.xml	(revision 1c0bfc618ece38c61714e2813735e3a928424a11)
+---+++ b/.idea/gradle.xml	(date 1762636093999)
+---@@ -1,5 +1,6 @@
+--- <?xml version="1.0" encoding="UTF-8"?>
+--- <project version="4">
+---+  <component name="GradleMigrationSettings" migrationVersion="1" />
+---   <component name="GradleSettings">
+---     <option name="linkedExternalProjectsSettings">
+---       <GradleProjectSettings>
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_07__Changes_.xml
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_07__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_07__Changes_.xml
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_07__Changes_.xml	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,4 +0,0 @@
+---<changelist name="Uncommitted_changes_before_Checkout_at_08_11_2025_22_07_[Changes]" date="1762636073541" recycled="true" deleted="true">
+---  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_07_[Changes]/shelved.patch" />
+---  <option name="DESCRIPTION" value="Uncommitted changes before Checkout at 08/11/2025 22:07 [Changes]" />
+---</changelist>
+--\ No newline at end of file
+--Index: .idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_12_05_[Changes]1/shelved.patch
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_12_05_[Changes]1/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_12_05_[Changes]1/shelved.patch
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_12_05_[Changes]1/shelved.patch	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,186 +0,0 @@
+---Index: app/src/main/java/com/nextapp/monasterio/MainActivity.kt
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+>package com.nextapp.monasterio\r\n\r\nimport android.os.Bundle\r\nimport android.widget.Toast\r\nimport androidx.activity.ComponentActivity\r\nimport androidx.activity.compose.setContent\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.navigation.compose.rememberNavController\r\nimport com.nextapp.monasterio.ui.navigation.AppDrawerContent\r\nimport com.nextapp.monasterio.ui.navigation.AppNavigationHost\r\nimport com.nextapp.monasterio.ui.theme.*\r\nimport kotlinx.coroutines.launch\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport androidx.appcompat.app.AppCompatDelegate\r\nimport androidx.compose.ui.platform.LocalDensity\r\nimport androidx.compose.ui.unit.Density\r\nimport androidx.navigation.compose.currentBackStackEntryAsState\r\nimport com.nextapp.monasterio.utils.FontSize\r\n\r\nclass MainActivity : AppCompatActivity() {\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO)\r\n        super.onCreate(savedInstanceState)\r\n        LanguageHelper.loadLocale(this)\r\n        setContent {\r\n            val appFontScale = FontSize.devolverFontScale(this)\r\n            val currentDensity = LocalDensity.current\r\n            val newDensity= Density(\r\n                density= currentDensity.density,\r\n                fontScale = currentDensity.fontScale*appFontScale\r\n            )\r\n            CompositionLocalProvider(LocalDensity provides newDensity) {\r\n                Smov_monasterioTheme {\r\n                    MonasteryAppScreen()\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun MonasteryAppScreen() {\r\n    val context = LocalContext.current\r\n    val navController = rememberNavController()\r\n    val drawerState = rememberDrawerState(initialValue = DrawerValue.Closed)\r\n    val scope = rememberCoroutineScope()\r\n\r\n    val currentTitle = remember { mutableStateOf(context.getString(R.string.title_inicio)) }\r\n\r\n    // ✅ Detectar ruta actual\r\n    val currentBackStackEntry by navController.currentBackStackEntryAsState()\r\n    val currentRoute = currentBackStackEntry?.destination?.route\r\n\r\n    // ✅ Rutas inmersivas\r\n    val immersiveRoutes = listOf(AppRoutes.PIN_DETALLE)\r\n    val isImmersive = currentRoute in immersiveRoutes\r\n\r\n    val gesturesEnabled = when(currentRoute){\r\n        AppRoutes.VIRTUAL_VISIT -> false\r\n        else -> true\r\n    }\r\n\r\n    // ✅ Actualizar título\r\n    LaunchedEffect(navController) {\r\n        navController.currentBackStackEntryFlow.collect { backStackEntry ->\r\n            val route = backStackEntry.destination.route\r\n            currentTitle.value = when (route) {\r\n                AppRoutes.INFO -> context.getString(R.string.title_info_general)\r\n                AppRoutes.HISTORIA -> context.getString(R.string.title_history)\r\n                AppRoutes.GALERIA -> context.getString(R.string.title_gallery)\r\n                AppRoutes.PERFIL -> context.getString(R.string.title_profile)\r\n                AppRoutes.AJUSTES -> context.getString(R.string.title_settings)\r\n                AppRoutes.OPCIONES_RESERVA,\r\n                AppRoutes.RESERVA,\r\n                AppRoutes.CONFIRMACION_RESERVA -> context.getString(R.string.title_appointment)\r\n                AppRoutes.VIRTUAL_VISIT -> context.getString(R.string.title_monasterio)\r\n                else -> context.getString(R.string.title_inicio)\r\n            }\r\n        }\r\n    }\r\n\r\n    if (isImmersive) {\r\n        // \uD83C\uDF0C Vista inmersiva sin barra ni menú\r\n        AppNavigationHost(\r\n            navController = navController,\r\n            modifier = Modifier.fillMaxSize()\r\n        )\r\n    } else {\r\n        // \uD83E\uDDF1 Vista normal con barra y menú\r\n        ModalNavigationDrawer(\r\n            drawerState = drawerState,\r\n            drawerContent = {\r\n                AppDrawerContent(\r\n                    navController = navController,\r\n                    scope = scope,\r\n                    drawerState = drawerState\r\n                )\r\n            },\r\n            gesturesEnabled = gesturesEnabled\r\n        ) {\r\n            Scaffold(\r\n                topBar = {\r\n                    CenterAlignedTopAppBar(\r\n                        title = { Text(currentTitle.value) },\r\n                        colors = TopAppBarDefaults.topAppBarColors(\r\n                            containerColor = MonasteryRed,\r\n                            titleContentColor = White,\r\n                            navigationIconContentColor = White,\r\n                            actionIconContentColor = White\r\n                        ),\r\n                        navigationIcon = {\r\n                            IconButton(onClick = {\r\n                                scope.launch {\r\n                                    drawerState.apply {\r\n                                        if (isClosed) open() else close()\r\n                                    }\r\n                                }\r\n                            }) {\r\n                                val iconRes = if (drawerState.isOpen) R.drawable.menu_close else R.drawable.ic_menu_24\r\n                                Icon(\r\n                                    painter = painterResource(id = iconRes),\r\n                                    contentDescription = stringResource(id = R.string.navigation_drawer_open)\r\n                                )\r\n                            }\r\n                        },\r\n                        actions = {\r\n                            IconButton(onClick = {\r\n                                Toast.makeText(context, \"Modo edición (próximamente)\", Toast.LENGTH_SHORT).show()\r\n                            }) {\r\n                                Icon(\r\n                                    painter = painterResource(id = R.drawable.lapiz),\r\n                                    contentDescription = stringResource(id = R.string.edit_mode)\r\n                                )\r\n                            }\r\n                        }\r\n                    )\r\n                }\r\n            ) { paddingValues ->\r\n                AppNavigationHost(\r\n                    navController = navController,\r\n                    modifier = Modifier.padding(paddingValues)\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/java/com/nextapp/monasterio/MainActivity.kt b/app/src/main/java/com/nextapp/monasterio/MainActivity.kt
+------ a/app/src/main/java/com/nextapp/monasterio/MainActivity.kt	(revision 7bf4f8b6f6cb424fd6f3fce44f84f0a52360e3bc)
+---+++ b/app/src/main/java/com/nextapp/monasterio/MainActivity.kt	(date 1762555781669)
+---@@ -1,8 +1,8 @@
+--- package com.nextapp.monasterio
+--- 
+---+
+--- import android.os.Bundle
+--- import android.widget.Toast
+----import androidx.activity.ComponentActivity
+--- import androidx.activity.compose.setContent
+--- import androidx.compose.foundation.layout.*
+--- import androidx.compose.material3.*
+---@@ -18,6 +18,8 @@
+--- import kotlinx.coroutines.launch
+--- import androidx.appcompat.app.AppCompatActivity
+--- import androidx.appcompat.app.AppCompatDelegate
+---+import androidx.compose.ui.graphics.Color
+---+import androidx.compose.ui.platform.LocalConfiguration
+--- import androidx.compose.ui.platform.LocalDensity
+--- import androidx.compose.ui.unit.Density
+--- import androidx.navigation.compose.currentBackStackEntryAsState
+---@@ -52,6 +54,20 @@
+---     val drawerState = rememberDrawerState(initialValue = DrawerValue.Closed)
+---     val scope = rememberCoroutineScope()
+--- 
+---+    val stringEspanyol= stringResource(R.string.spanish_language)
+---+    val stringAleman= stringResource(R.string.german_language)
+---+    val stringIngles= stringResource(R.string.english_language)
+---+
+---+
+---+    var mostrarIdioma by remember { mutableStateOf(false) }
+---+
+---+    val configuration = LocalConfiguration.current
+---+    val currentLanguageCode = configuration.locales[0].language
+---+
+---+    var idioma by remember { mutableStateOf(currentLanguageCode) }
+---+
+---+    var idiomasDisponibles = listOf(stringEspanyol,stringIngles,stringAleman)
+---+
+---     val currentTitle = remember { mutableStateOf(context.getString(R.string.title_inicio)) }
+--- 
+---     // ✅ Detectar ruta actual
+---@@ -131,15 +147,53 @@
+---                             }
+---                         },
+---                         actions = {
+----                            IconButton(onClick = {
+----                                Toast.makeText(context, "Modo edición (próximamente)", Toast.LENGTH_SHORT).show()
+----                            }) {
+----                                Icon(
+----                                    painter = painterResource(id = R.drawable.lapiz),
+----                                    contentDescription = stringResource(id = R.string.edit_mode)
+----                                )
+----                            }
+----                        }
+---+                            Box {
+---+                                IconButton(onClick = {
+---+                                    mostrarIdioma = true
+---+                                }) {
+---+                                    val iconRes =
+---+                                        if (idioma == "es" || idioma == stringEspanyol) R.drawable.espanya else if (idioma == "de" || idioma == stringAleman) R.drawable.alemania else R.drawable.reinounido
+---+                                    Icon(
+---+                                        painter = painterResource(id = iconRes),
+---+                                        tint = Color.Unspecified,
+---+                                        contentDescription = if (idioma == "es" || idioma == stringEspanyol ) stringEspanyol
+---+                                         else if (idioma == "de" || idioma == stringAleman) stringAleman else stringIngles
+---+                                    )
+---+                                }
+---+                                DropdownMenu(
+---+                                    expanded = mostrarIdioma,
+---+                                    onDismissRequest = { mostrarIdioma = false },
+---+                                    modifier = Modifier.fillMaxWidth(0.8f),
+---+                                ) {
+---+                                    idiomasDisponibles.forEach { idiomaSlot ->
+---+                                        DropdownMenuItem(
+---+                                            text = { Text(idiomaSlot) },
+---+                                            onClick = {
+---+                                                idioma = idiomaSlot
+---+                                                mostrarIdioma = false
+---+                                                if(idiomaSlot == stringEspanyol)
+---+                                                    LanguageHelper.saveLocale(context, "es")
+---+                                                else if(idiomaSlot == stringAleman){
+---+                                                    LanguageHelper.saveLocale(context, "de")
+---+                                                } else LanguageHelper.saveLocale(context, "en")
+---+                                            }
+---+                                        )
+---+                                    }
+---+                                }
+---+                            }
+---+                                IconButton(onClick = {
+---+                                    Toast.makeText(
+---+                                        context,
+---+                                        "Modo edición (próximamente)",
+---+                                        Toast.LENGTH_SHORT
+---+                                    ).show()
+---+                                }) {
+---+                                    Icon(
+---+                                        painter = painterResource(id = R.drawable.lapiz),
+---+                                        contentDescription = stringResource(id = R.string.edit_mode)
+---+                                    )
+---+                                }
+---+                            }
+---                     )
+---                 }
+---             ) { paddingValues ->
+---@@ -150,4 +204,4 @@
+---             }
+---         }
+---     }
+----}
+---\ No newline at end of file
+---+}
+---Index: app/src/main/res/values/strings.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><resources>\r\n    <string name=\"app_name\">Santa María\\nla Real de Huelgas</string>\r\n    <string name=\"title_inicio\">Inicio</string>\r\n    <string name=\"virtual_visit\">VISITA VIRTUAL</string>\r\n    <string name=\"book_appointment\">RESERVA CITA</string>\r\n    <string name=\"monastery_name\">Santa María\\nla Real de Huelgas</string>\r\n    <string name=\"edit_mode\">Modo edición</string>\r\n    <string name=\"navigation_drawer_open\">Abrir menú</string>\r\n    <string name=\"navigation_drawer_close\">Cerrar menú</string>\r\n    <string name=\"menu_info\">Información monasterio</string>\r\n    <string name=\"menu_history\">Historia</string>\r\n    <string name=\"menu_gallery\">Galería</string>\r\n    <string name=\"menu_profile\">Perfil</string>\r\n    <string name=\"menu_settings\">Ajustes</string>\r\n    <string name=\"title_info_general\">Información General</string>\r\n    <string name=\"title_history\">Historia</string>\r\n    <string name=\"title_gallery\">Galería</string>\r\n    <string name=\"title_profile\">Perfil</string>\r\n    <string name=\"title_settings\">Ajustes</string>\r\n    <string name=\"info_location\">C/…</string>\r\n    <string name=\"info_hours\">C/XX:XX - YY:YY</string>\r\n    <string name=\"general_info\">Información general:</string>\r\n    <string name=\"history_1800\">1800</string>\r\n    <string name=\"history_1900\">1900-1950</string>\r\n    <string name=\"history_1950\">1950-2000</string>\r\n    <string name=\"history_actualidad\">Actualidad</string>\r\n    <string name=\"title_appointment\">Reservar Cita</string>\r\n    <string name=\"option_phone_appointment\">Reservar por teléfono</string>\r\n    <string name=\"option_online_appointment\">Reservar online</string>\r\n    <string name=\"name_appointment\">Nombre y apellidos</string>\r\n    <string name=\"email_appointment\">Correo electrónico</string>\r\n    <string name=\"date_appointment\">Fecha</string>\r\n    <string name=\"hour_appointment\">Hora</string>\r\n    <string name=\"placeholdername_appointment\">Introduce tu nombre y apellidos</string>\r\n    <string name=\"placeholderemail_appointment\">Introduce tu correo electrónico</string>\r\n    <string name=\"placeholderdate_appointment\">Selecciona una fecha</string>\r\n    <string name=\"placeholderhour_appointment\">Selecciona una hora</string>\r\n    <string name=\"compulsory_name\">El nombre es obligatorio</string>\r\n    <string name=\"valid_name\">El nombre contiene algún simbolo no válido</string>\r\n    <string name=\"compulsory_email\">El email es obligatorio</string>\r\n    <string name=\"valid_email\">El formato del email no es válido</string>\r\n    <string name=\"date_no_selected\">Se debe seleccionar una fecha</string>\r\n    <string name=\"hour_no_selected\">Se debe seleccionar una hora</string>\r\n    <string name=\"datepicker_ok\">Ok</string>\r\n    <string name=\"datepicker_cancel\">Cancelar</string>\r\n    <string name=\"confirm_button\">CONFIRMAR</string>\r\n    <string name=\"contentimage_confirmation\">Confirmado</string>\r\n    <string name=\"confirmation_appointment\">¡CASI LISTO!</string>\r\n    <string name=\"details_appointment\">Tu solicitud de reserva está preparada. Por favor, pulsa \\'enviar\\' en la aplicación de correo que se acaba de abrir para finalizar tu solicitud. Te responderemos a ese correo para confirmar la disponibilidad.</string>\r\n    <string name=\"email_subject\">Solicitud de Reserva de Vista - %1$s</string>\r\n    <string name=\"email_message\">Hola,\\n\\nMe gustaría solicitar una reserva para una visita al monasterio con los siguientes datos:\\n\\n* Nombre: %1$s\\n* Email: %2$s\\n* Fecha de la visita: %3$s\\n* Hora de la visita: %4$s\\n\\nQuedo a la espera de su amable confirmación.\\n\\nMuchas gracias,\\nAtentamente,\\n\\n%1$s</string>\r\n    <string name=\"email_error\">No se encontró ninguna app de correo</string>\r\n    <string name=\"history_content_placeholder\">Mauris vel nisi id metus vestibulum vehicula nec ac orci. Curabitur massa diam, fermentum sit amet augue sit, volutpat efficitur enim. Phasellus a cursus orci, id laoreet dolor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</string>\r\n    <string name=\"language_select\">Seleccionar Idioma</string>\r\n    <string name=\"font_size_select\">Selecciona el tamaño de la letra</string>\r\n    <string name=\"font_extrabig\">Extra Grande</string>\r\n    <string name=\"font_normal\">Mediana</string>\r\n    <string name=\"font_big\">Grande</string>\r\n    <string name=\"title_monasterio\">Monasterio</string>\r\n</resources>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
+------ a/app/src/main/res/values/strings.xml	(revision 7bf4f8b6f6cb424fd6f3fce44f84f0a52360e3bc)
+---+++ b/app/src/main/res/values/strings.xml	(date 1762551297909)
+---@@ -1,5 +1,5 @@
+--- <resources>
+----    <string name="app_name">Santa María\nla Real de Huelgas</string>
+---+    <string name="app_name">Santa María la Real de Huelgas</string>
+---     <string name="title_inicio">Inicio</string>
+---     <string name="virtual_visit">VISITA VIRTUAL</string>
+---     <string name="book_appointment">RESERVA CITA</string>
+---@@ -57,4 +57,7 @@
+---     <string name="font_normal">Mediana</string>
+---     <string name="font_big">Grande</string>
+---     <string name="title_monasterio">Monasterio</string>
+---+    <string name="spanish_language">Español</string>
+---+    <string name="german_language">Alemán</string>
+---+    <string name="english_language">Inglés</string>
+--- </resources>
+---\ No newline at end of file
+---Index: app/src/main/res/values-en/strings.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<resources>\r\n    <string name=\"app_name\">Museum360</string>\r\n    <string name=\"title_inicio\">Home</string>\r\n    <string name=\"virtual_visit\">VIRTUAL VISIT</string>\r\n    <string name=\"book_appointment\">BOOK APPOINTMENT</string>\r\n    <string name=\"monastery_name\">Santa María\\nla Real de Huelgas</string>\r\n    <string name=\"edit_mode\">Edit mode</string>\r\n    <string name=\"navigation_drawer_open\">Open menu</string>\r\n    <string name=\"navigation_drawer_close\">Close menu</string>\r\n    <string name=\"menu_info\">Monastery information</string>\r\n    <string name=\"menu_history\">History</string>\r\n    <string name=\"menu_gallery\">Gallery</string>\r\n    <string name=\"menu_profile\">Profile</string>\r\n    <string name=\"menu_settings\">Settings</string>\r\n    <string name=\"title_info_general\">General Information</string>\r\n    <string name=\"title_history\">History</string>\r\n    <string name=\"title_gallery\">Gallery</string>\r\n    <string name=\"title_profile\">Profile</string>\r\n    <string name=\"title_settings\">Settings</string>\r\n\r\n    <string name=\"info_location\">Street: …</string>\r\n\r\n    <string name=\"info_hours\">Hours: XX:XX - YY:YY</string>\r\n    <string name=\"general_info\">General information:</string>\r\n\r\n    <string name=\"history_1800\">1800</string>\r\n    <string name=\"history_1900\">1900-1950</string>\r\n    <string name=\"history_1950\">1950-2000</string>\r\n    <string name=\"history_actualidad\">Present Day</string>\r\n    <string name=\"title_appointment\">Book Appointment</string>\r\n    <string name=\"option_phone_appointment\">Book by phone</string>\r\n    <string name=\"option_online_appointment\">Book online</string>\r\n    <string name=\"name_appointment\">Name</string>\r\n    <string name=\"email_appointment\">Email</string>\r\n    <string name=\"date_appointment\">Date</string>\r\n    <string name=\"hour_appointment\">Time</string>\r\n    <string name=\"placeholdername_appointment\">Enter your full name</string>\r\n    <string name=\"placeholderemail_appointment\">Enter your email address</string>\r\n    <string name=\"placeholderdate_appointment\">Select a date</string>\r\n    <string name=\"placeholderhour_appointment\">Select a time</string>\r\n    <string name=\"compulsory_name\">Name is required</string>\r\n    <string name=\"valid_name\">The name contains an invalid symbol</string>\r\n    <string name=\"compulsory_email\">Email is required</string>\r\n    <string name=\"valid_email\">The email format is invalid</string>\r\n    <string name=\"date_no_selected\">A date must be selected</string>\r\n    <string name=\"hour_no_selected\">A time must be selected</string>\r\n    <string name=\"datepicker_ok\">Ok</string>\r\n    <string name=\"datepicker_cancel\">Cancel</string>\r\n    <string name=\"confirm_button\">CONFIRM</string>\r\n    <string name=\"contentimage_confirmation\">Confirmed</string>\r\n    <string name=\"confirmation_appointment\">ALMOST READY!!</string>\r\n    <string name=\"details_appointment\">Your booking request is ready. Please click \\'send\\' in the email application that just opened to finalize your request. We will reply to that email to confirm availability..</string>\r\n    <string name=\"email_subject\">View Reservation Request - %1$s</string>\r\n    <string name=\"email_message\">Hello,\\n\\nI would like to request a reservation for a visit to the monastery with the following details:\\n\\n* Name: %1$s\\n* Email: %2$s\\n* Date of visit: %3$s\\n* Time of visit: %4$s\\n\\nI look forward to your kind confirmation.\\n\\nThank you very much,\\nSincerely,\\n\\n%1$s</string>\r\n    <string name=\"email_error\">No email app was found</string>\r\n    <string name=\"history_content_placeholder\">Mauris vel nisi id metus vestibulum vehicula nec ac orci. Curabitur massa diam, fermentum sit amet augue sit, volutpat efficitur enim. Phasellus a cursus orci, id laoreet dolor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</string>\r\n    <string name=\"language_select\">Select language</string>\r\n    <string name=\"font_size_select\">Select the font size</string>\r\n    <string name=\"font_extrabig\">Extra Big</string>\r\n    <string name=\"font_normal\">Medium</string>\r\n    <string name=\"font_big\">Big</string>\r\n    <string name=\"title_monasterio\">Monastery</string>\r\n\r\n</resources>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/res/values-en/strings.xml b/app/src/main/res/values-en/strings.xml
+------ a/app/src/main/res/values-en/strings.xml	(revision 7bf4f8b6f6cb424fd6f3fce44f84f0a52360e3bc)
+---+++ b/app/src/main/res/values-en/strings.xml	(date 1762551373956)
+---@@ -61,5 +61,8 @@
+---     <string name="font_normal">Medium</string>
+---     <string name="font_big">Big</string>
+---     <string name="title_monasterio">Monastery</string>
+---+    <string name="spanish_language">Spanish</string>
+---+    <string name="german_language">German</string>
+---+    <string name="english_language">English</string>
+--- 
+--- </resources>
+---\ No newline at end of file
+---Index: app/src/main/res/values-de/strings.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<resources>\r\n    <string name=\"app_name\">Museum360</string>\r\n    <string name=\"title_inicio\">Startseite</string>\r\n    <string name=\"virtual_visit\">VIRTUELLER BESUCH</string>\r\n    <string name=\"book_appointment\">TERMIN BUCHEN</string>\r\n    <string name=\"monastery_name\">Santa María\\nla Real de Huelgas</string>\r\n    <string name=\"edit_mode\">Bearbeiten</string>\r\n    <string name=\"navigation_drawer_open\">Menü öffnen</string>\r\n    <string name=\"navigation_drawer_close\">Menü schließen</string>\r\n    <string name=\"menu_info\">Klosterinformationen</string>\r\n    <string name=\"menu_history\">Geschichte</string>\r\n    <string name=\"menu_gallery\">Galerie</string>\r\n    <string name=\"menu_profile\">Profil</string>\r\n    <string name=\"menu_settings\">Einstellungen</string>\r\n    <string name=\"title_info_general\">Allgemeine Informationen</string>\r\n    <string name=\"title_history\">Geschichte</string>\r\n    <string name=\"title_gallery\">Galerie</string>\r\n    <string name=\"title_profile\">Profil</string>\r\n    <string name=\"title_settings\">Einstellungen</string>\r\n\r\n\r\n    <string name=\"info_location\">Straße: …</string>\r\n\r\n    <string name=\"info_hours\">Öffnungszeiten: XX:XX - YY:YY</string>\r\n    <string name=\"general_info\">Allgemeine Informationen:</string>\r\n\r\n    <string name=\"history_1800\">1800</string>\r\n    <string name=\"history_1900\">1900-1950</string>\r\n    <string name=\"history_1950\">1950-2000</string>\r\n    <string name=\"history_actualidad\">Heute</string>\r\n    <string name=\"title_appointment\">Termin vereinbaren</string>\r\n    <string name=\"option_phone_appointment\">Buchen Sie telefonisch</string>\r\n    <string name=\"option_online_appointment\">Online buchen</string>\r\n    <string name=\"name_appointment\">Name</string>\r\n    <string name=\"email_appointment\">E-Mail</string>\r\n    <string name=\"date_appointment\">Datum</string>\r\n    <string name=\"hour_appointment\">Stunde</string>\r\n    <string name=\"placeholdername_appointment\">Geben Sie Ihren vollständigen Namen ein</string>\r\n    <string name=\"placeholderemail_appointment\">Geben Sie Ihre E-Mail-Adresse ein</string>\r\n    <string name=\"placeholderdate_appointment\">Datum auswählen</string>\r\n    <string name=\"placeholderhour_appointment\">Wählen Sie eine Uhrzeit</string>\r\n    <string name=\"compulsory_name\">Name erforderlich</string>\r\n    <string name=\"valid_name\">Der Name enthält ein ungültiges Symbol</string>\r\n    <string name=\"compulsory_email\">E-Mail-Adresse erforderlich</string>\r\n    <string name=\"valid_email\">Das E-Mail-Format ist ungültig.</string>\r\n    <string name=\"date_no_selected\">Ein Datum muss ausgewählt werden.</string>\r\n    <string name=\"hour_no_selected\">Es muss ein Zeitpunkt ausgewählt werden.</string>\r\n    <string name=\"datepicker_ok\">Ok</string>\r\n    <string name=\"datepicker_cancel\">Stornieren</string>\r\n    <string name=\"confirm_button\">BESTÄTIGEN</string>\r\n    <string name=\"contentimage_confirmation\">Bestätigt</string>\r\n    <string name=\"confirmation_appointment\">FAST FERTIG!!</string>\r\n    <string name=\"details_appointment\">Ihre Buchungsanfrage ist fertig. Bitte klicken Sie in der soeben geöffneten E-Mail-Anwendung auf „Senden“, um Ihre Anfrage abzuschließen. Wir werden Ihnen die Verfügbarkeit per E-Mail bestätigen..</string>\r\n    <string name=\"email_subject\">Reservierungsanfrage ansehen - %1$s</string>\r\n    <string name=\"email_message\">Hallo,\\n\\nich möchte hiermit eine Reservierung für einen Besuch im Kloster anfragen. Bitte geben Sie folgende Daten an:\\n\\n* Name: %1$s\\n* E-Mail: %2$s\\n* Besuchsdatum: %3$s\\n* Besuchszeit: %4$s\\n\\nIch freue mich auf Ihre Bestätigung.\\n\\nVielen Dank,\\nMit freundlichen Grüßen,\\n\\n%1$s</string>\r\n    <string name=\"email_error\">Es wurde keine E-Mail-App gefunden.</string>\r\n    <string name=\"history_content_placeholder\">Mauris vel nisi id metus vestibulum vehicula nec ac orci. Curabitur massa diam, fermentum sit amet augue sit, volutpat efficitur enim. Phasellus a cursus orci, id laoreet dolor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</string>\r\n    <string name=\"language_select\">Sprache auswählen</string>\r\n    <string name=\"font_size_select\">Wählen Sie die Schriftgröße aus</string>\r\n    <string name=\"font_extrabig\">Extra groß</string>\r\n    <string name=\"font_normal\">Mittlere</string>\r\n    <string name=\"font_big\">Groß</string>\r\n    <string name=\"title_monasterio\">Kloster</string>\r\n\r\n</resources>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/res/values-de/strings.xml b/app/src/main/res/values-de/strings.xml
+------ a/app/src/main/res/values-de/strings.xml	(revision 7bf4f8b6f6cb424fd6f3fce44f84f0a52360e3bc)
+---+++ b/app/src/main/res/values-de/strings.xml	(date 1762551335139)
+---@@ -62,5 +62,8 @@
+---     <string name="font_normal">Mittlere</string>
+---     <string name="font_big">Groß</string>
+---     <string name="title_monasterio">Kloster</string>
+---+    <string name="spanish_language">Spanisch</string>
+---+    <string name="german_language">Deutsch</string>
+---+    <string name="english_language">Englisch</string>
+--- 
+--- </resources>
+---\ No newline at end of file
+--Index: .idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_23_00__Changes_.xml
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_23_00__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_23_00__Changes_.xml
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_23_00__Changes_.xml	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,4 +0,0 @@
+---<changelist name="Uncommitted_changes_before_Update_at_08_11_2025_23_00_[Changes]" date="1762639210614" recycled="true" deleted="true">
+---  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_23_00_[Changes]/shelved.patch" />
+---  <option name="DESCRIPTION" value="Uncommitted changes before Update at 08/11/2025 23:00 [Changes]" />
+---</changelist>
+--\ No newline at end of file
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_07_[Changes]/shelved.patch
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_07_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_07_[Changes]/shelved.patch
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_07_[Changes]/shelved.patch	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,17 +0,0 @@
+---Index: .idea/gradle.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"GradleSettings\">\r\n    <option name=\"linkedExternalProjectsSettings\">\r\n      <GradleProjectSettings>\r\n        <option name=\"testRunner\" value=\"CHOOSE_PER_TEST\" />\r\n        <option name=\"externalProjectPath\" value=\"$PROJECT_DIR$\" />\r\n        <option name=\"gradleJvm\" value=\"#GRADLE_LOCAL_JAVA_HOME\" />\r\n        <option name=\"modules\">\r\n          <set>\r\n            <option value=\"$PROJECT_DIR$\" />\r\n            <option value=\"$PROJECT_DIR$/app\" />\r\n          </set>\r\n        </option>\r\n      </GradleProjectSettings>\r\n    </option>\r\n  </component>\r\n</project>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/.idea/gradle.xml b/.idea/gradle.xml
+------ a/.idea/gradle.xml	(revision 1c0bfc618ece38c61714e2813735e3a928424a11)
+---+++ b/.idea/gradle.xml	(date 1762635811330)
+---@@ -1,5 +1,6 @@
+--- <?xml version="1.0" encoding="UTF-8"?>
+--- <project version="4">
+---+  <component name="GradleMigrationSettings" migrationVersion="1" />
+---   <component name="GradleSettings">
+---     <option name="linkedExternalProjectsSettings">
+---       <GradleProjectSettings>
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08__Changes_1.xml
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08__Changes_1.xml b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08__Changes_1.xml
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08__Changes_1.xml	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,4 +0,0 @@
+---<changelist name="Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]1" date="1762636134377" recycled="true" deleted="true">
+---  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]1/shelved.patch" />
+---  <option name="DESCRIPTION" value="Uncommitted changes before Checkout at 08/11/2025 22:08 [Changes]" />
+---</changelist>
+--\ No newline at end of file
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_21_48__Changes_.xml
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_21_48__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_21_48__Changes_.xml
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_21_48__Changes_.xml	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,4 +0,0 @@
+---<changelist name="Uncommitted_changes_before_Checkout_at_08_11_2025_21_48_[Changes]" date="1762634936332" recycled="true" deleted="true">
+---  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_21_48_[Changes]/shelved.patch" />
+---  <option name="DESCRIPTION" value="Uncommitted changes before Checkout at 08/11/2025 21:48 [Changes]" />
+---</changelist>
+--\ No newline at end of file
+--Index: .idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_20_07_[Changes]/shelved.patch
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_20_07_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_20_07_[Changes]/shelved.patch
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_20_07_[Changes]/shelved.patch	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,192 +0,0 @@
+---Index: app/src/main/java/com/nextapp/monasterio/MainActivity.kt
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+>package com.nextapp.monasterio\r\n\r\nimport android.os.Bundle\r\nimport android.widget.Toast\r\nimport androidx.activity.ComponentActivity\r\nimport androidx.activity.compose.setContent\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.navigation.compose.rememberNavController\r\nimport com.nextapp.monasterio.ui.navigation.AppDrawerContent\r\nimport com.nextapp.monasterio.ui.navigation.AppNavigationHost\r\nimport com.nextapp.monasterio.ui.theme.*\r\nimport kotlinx.coroutines.launch\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport androidx.appcompat.app.AppCompatDelegate\r\nimport androidx.compose.ui.platform.LocalDensity\r\nimport androidx.compose.ui.unit.Density\r\nimport androidx.navigation.compose.currentBackStackEntryAsState\r\nimport com.nextapp.monasterio.utils.FontSize\r\n\r\nclass MainActivity : AppCompatActivity() {\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO)\r\n        super.onCreate(savedInstanceState)\r\n        LanguageHelper.loadLocale(this)\r\n        setContent {\r\n            val appFontScale = FontSize.devolverFontScale(this)\r\n            val currentDensity = LocalDensity.current\r\n            val newDensity= Density(\r\n                density= currentDensity.density,\r\n                fontScale = currentDensity.fontScale*appFontScale\r\n            )\r\n            CompositionLocalProvider(LocalDensity provides newDensity) {\r\n                Smov_monasterioTheme {\r\n                    MonasteryAppScreen()\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun MonasteryAppScreen() {\r\n    val context = LocalContext.current\r\n    val navController = rememberNavController()\r\n    val drawerState = rememberDrawerState(initialValue = DrawerValue.Closed)\r\n    val scope = rememberCoroutineScope()\r\n\r\n    val currentTitle = remember { mutableStateOf(context.getString(R.string.title_inicio)) }\r\n\r\n    // ✅ Detectar ruta actual\r\n    val currentBackStackEntry by navController.currentBackStackEntryAsState()\r\n    val currentRoute = currentBackStackEntry?.destination?.route\r\n\r\n    // ✅ Rutas inmersivas\r\n    val immersiveRoutes = listOf(AppRoutes.PIN_DETALLE)\r\n    val isImmersive = currentRoute in immersiveRoutes\r\n\r\n    val gesturesEnabled = when(currentRoute){\r\n        AppRoutes.VIRTUAL_VISIT -> false\r\n        else -> true\r\n    }\r\n\r\n    // ✅ Actualizar título\r\n    LaunchedEffect(navController) {\r\n        navController.currentBackStackEntryFlow.collect { backStackEntry ->\r\n            val route = backStackEntry.destination.route\r\n            currentTitle.value = when (route) {\r\n                AppRoutes.INFO -> context.getString(R.string.title_info_general)\r\n                AppRoutes.HISTORIA -> context.getString(R.string.title_history)\r\n                AppRoutes.GALERIA -> context.getString(R.string.title_gallery)\r\n                AppRoutes.PERFIL -> context.getString(R.string.title_profile)\r\n                AppRoutes.AJUSTES -> context.getString(R.string.title_settings)\r\n                AppRoutes.OPCIONES_RESERVA,\r\n                AppRoutes.RESERVA,\r\n                AppRoutes.CONFIRMACION_RESERVA -> context.getString(R.string.title_appointment)\r\n                AppRoutes.VIRTUAL_VISIT -> context.getString(R.string.title_monasterio)\r\n                else -> context.getString(R.string.title_inicio)\r\n            }\r\n        }\r\n    }\r\n\r\n    if (isImmersive) {\r\n        // \uD83C\uDF0C Vista inmersiva sin barra ni menú\r\n        AppNavigationHost(\r\n            navController = navController,\r\n            modifier = Modifier.fillMaxSize()\r\n        )\r\n    } else {\r\n        // \uD83E\uDDF1 Vista normal con barra y menú\r\n        ModalNavigationDrawer(\r\n            drawerState = drawerState,\r\n            drawerContent = {\r\n                AppDrawerContent(\r\n                    navController = navController,\r\n                    scope = scope,\r\n                    drawerState = drawerState\r\n                )\r\n            },\r\n            gesturesEnabled = gesturesEnabled\r\n        ) {\r\n            Scaffold(\r\n                topBar = {\r\n                    CenterAlignedTopAppBar(\r\n                        title = { Text(currentTitle.value) },\r\n                        colors = TopAppBarDefaults.topAppBarColors(\r\n                            containerColor = MonasteryRed,\r\n                            titleContentColor = White,\r\n                            navigationIconContentColor = White,\r\n                            actionIconContentColor = White\r\n                        ),\r\n                        navigationIcon = {\r\n                            IconButton(onClick = {\r\n                                scope.launch {\r\n                                    drawerState.apply {\r\n                                        if (isClosed) open() else close()\r\n                                    }\r\n                                }\r\n                            }) {\r\n                                val iconRes = if (drawerState.isOpen) R.drawable.menu_close else R.drawable.ic_menu_24\r\n                                Icon(\r\n                                    painter = painterResource(id = iconRes),\r\n                                    contentDescription = stringResource(id = R.string.navigation_drawer_open)\r\n                                )\r\n                            }\r\n                        },\r\n                        actions = {\r\n                            IconButton(onClick = {\r\n                                Toast.makeText(context, \"Modo edición (próximamente)\", Toast.LENGTH_SHORT).show()\r\n                            }) {\r\n                                Icon(\r\n                                    painter = painterResource(id = R.drawable.lapiz),\r\n                                    contentDescription = stringResource(id = R.string.edit_mode)\r\n                                )\r\n                            }\r\n                        }\r\n                    )\r\n                }\r\n            ) { paddingValues ->\r\n                AppNavigationHost(\r\n                    navController = navController,\r\n                    modifier = Modifier.padding(paddingValues)\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/java/com/nextapp/monasterio/MainActivity.kt b/app/src/main/java/com/nextapp/monasterio/MainActivity.kt
+------ a/app/src/main/java/com/nextapp/monasterio/MainActivity.kt	(revision 6455732f5969476c18d5bc46e33a52869ec3e410)
+---+++ b/app/src/main/java/com/nextapp/monasterio/MainActivity.kt	(date 1762624578235)
+---@@ -1,8 +1,8 @@
+--- package com.nextapp.monasterio
+--- 
+---+
+--- import android.os.Bundle
+--- import android.widget.Toast
+----import androidx.activity.ComponentActivity
+--- import androidx.activity.compose.setContent
+--- import androidx.compose.foundation.layout.*
+--- import androidx.compose.material3.*
+---@@ -18,8 +18,14 @@
+--- import kotlinx.coroutines.launch
+--- import androidx.appcompat.app.AppCompatActivity
+--- import androidx.appcompat.app.AppCompatDelegate
+---+import androidx.compose.foundation.Image
+---+import androidx.compose.foundation.border
+---+import androidx.compose.ui.graphics.Color
+---+import androidx.compose.ui.layout.ContentScale
+---+import androidx.compose.ui.platform.LocalConfiguration
+--- import androidx.compose.ui.platform.LocalDensity
+--- import androidx.compose.ui.unit.Density
+---+import androidx.compose.ui.unit.dp
+--- import androidx.navigation.compose.currentBackStackEntryAsState
+--- import com.nextapp.monasterio.utils.FontSize
+--- 
+---@@ -52,6 +58,20 @@
+---     val drawerState = rememberDrawerState(initialValue = DrawerValue.Closed)
+---     val scope = rememberCoroutineScope()
+--- 
+---+    val stringEspanyol= "Español"
+---+    val stringAleman= "Deutsch"
+---+    val stringIngles= "English"
+---+
+---+
+---+    var mostrarIdioma by remember { mutableStateOf(false) }
+---+
+---+    val configuration = LocalConfiguration.current
+---+    val currentLanguageCode = configuration.locales[0].language
+---+
+---+    var idioma by remember { mutableStateOf(currentLanguageCode) }
+---+
+---+    var idiomasDisponibles = listOf(stringEspanyol,stringIngles,stringAleman)
+---+
+---     val currentTitle = remember { mutableStateOf(context.getString(R.string.title_inicio)) }
+--- 
+---     // ✅ Detectar ruta actual
+---@@ -131,15 +151,53 @@
+---                             }
+---                         },
+---                         actions = {
+----                            IconButton(onClick = {
+----                                Toast.makeText(context, "Modo edición (próximamente)", Toast.LENGTH_SHORT).show()
+----                            }) {
+----                                Icon(
+----                                    painter = painterResource(id = R.drawable.lapiz),
+----                                    contentDescription = stringResource(id = R.string.edit_mode)
+----                                )
+----                            }
+----                        }
+---+                            Box {
+---+                                OutlinedIconButton(onClick = {
+---+                                    mostrarIdioma = true
+---+                                }) {
+---+                                    val iconRes =
+---+                                        if (idioma == "es" || idioma == stringEspanyol) R.drawable.espanya else if (idioma == "de" || idioma == stringAleman) R.drawable.alemania else R.drawable.reinounido
+---+                                    Image(
+---+                                        painter = painterResource(id = iconRes),
+---+                                        contentDescription = if (idioma == "es" || idioma == stringEspanyol ) stringEspanyol
+---+                                         else if (idioma == "de" || idioma == stringAleman) stringAleman else stringIngles,
+---+                                        contentScale = ContentScale.Crop
+---+                                    )
+---+                                }
+---+                                DropdownMenu(
+---+                                    expanded = mostrarIdioma,
+---+                                    onDismissRequest = { mostrarIdioma = false },
+---+                                    modifier = Modifier.fillMaxWidth(0.8f),
+---+                                ) {
+---+                                    idiomasDisponibles.forEach { idiomaSlot ->
+---+                                        DropdownMenuItem(
+---+                                            text = { Text(idiomaSlot) },
+---+                                            onClick = {
+---+                                                idioma = idiomaSlot
+---+                                                mostrarIdioma = false
+---+                                                if(idiomaSlot == stringEspanyol)
+---+                                                    LanguageHelper.saveLocale(context, "es")
+---+                                                else if(idiomaSlot == stringAleman){
+---+                                                    LanguageHelper.saveLocale(context, "de")
+---+                                                } else LanguageHelper.saveLocale(context, "en")
+---+                                            }
+---+                                        )
+---+                                    }
+---+                                }
+---+                            }
+---+                                IconButton(onClick = {
+---+                                    Toast.makeText(
+---+                                        context,
+---+                                        "Modo edición (próximamente)",
+---+                                        Toast.LENGTH_SHORT
+---+                                    ).show()
+---+                                }) {
+---+                                    Icon(
+---+                                        painter = painterResource(id = R.drawable.lapiz),
+---+                                        contentDescription = stringResource(id = R.string.edit_mode)
+---+                                    )
+---+                                }
+---+                            }
+---                     )
+---                 }
+---             ) { paddingValues ->
+---@@ -150,4 +208,4 @@
+---             }
+---         }
+---     }
+----}
+---\ No newline at end of file
+---+}
+---Index: app/src/main/res/values/strings.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><resources>\r\n    <string name=\"app_name\">Santa María\\nla Real de Huelgas</string>\r\n    <string name=\"title_inicio\">Inicio</string>\r\n    <string name=\"virtual_visit\">VISITA VIRTUAL</string>\r\n    <string name=\"book_appointment\">RESERVA CITA</string>\r\n    <string name=\"monastery_name\">Santa María\\nla Real de Huelgas</string>\r\n    <string name=\"edit_mode\">Modo edición</string>\r\n    <string name=\"navigation_drawer_open\">Abrir menú</string>\r\n    <string name=\"navigation_drawer_close\">Cerrar menú</string>\r\n    <string name=\"menu_info\">Información monasterio</string>\r\n    <string name=\"menu_history\">Historia</string>\r\n    <string name=\"menu_gallery\">Galería</string>\r\n    <string name=\"menu_profile\">Perfil</string>\r\n    <string name=\"menu_settings\">Ajustes</string>\r\n    <string name=\"title_info_general\">Información General</string>\r\n    <string name=\"title_history\">Historia</string>\r\n    <string name=\"title_gallery\">Galería</string>\r\n    <string name=\"title_profile\">Perfil</string>\r\n    <string name=\"title_settings\">Ajustes</string>\r\n    <string name=\"info_location\">C/…</string>\r\n    <string name=\"info_hours\">C/XX:XX - YY:YY</string>\r\n    <string name=\"general_info\">Información general:</string>\r\n    <string name=\"history_1800\">1800</string>\r\n    <string name=\"history_1900\">1900-1950</string>\r\n    <string name=\"history_1950\">1950-2000</string>\r\n    <string name=\"history_actualidad\">Actualidad</string>\r\n    <string name=\"title_appointment\">Reservar Cita</string>\r\n    <string name=\"option_phone_appointment\">Reservar por teléfono</string>\r\n    <string name=\"option_online_appointment\">Reservar online</string>\r\n    <string name=\"name_appointment\">Nombre y apellidos</string>\r\n    <string name=\"email_appointment\">Correo electrónico</string>\r\n    <string name=\"date_appointment\">Fecha</string>\r\n    <string name=\"hour_appointment\">Hora</string>\r\n    <string name=\"placeholdername_appointment\">Introduce tu nombre y apellidos</string>\r\n    <string name=\"placeholderemail_appointment\">Introduce tu correo electrónico</string>\r\n    <string name=\"placeholderdate_appointment\">Selecciona una fecha</string>\r\n    <string name=\"placeholderhour_appointment\">Selecciona una hora</string>\r\n    <string name=\"compulsory_name\">El nombre es obligatorio</string>\r\n    <string name=\"valid_name\">El nombre contiene algún simbolo no válido</string>\r\n    <string name=\"compulsory_email\">El email es obligatorio</string>\r\n    <string name=\"valid_email\">El formato del email no es válido</string>\r\n    <string name=\"date_no_selected\">Se debe seleccionar una fecha</string>\r\n    <string name=\"hour_no_selected\">Se debe seleccionar una hora</string>\r\n    <string name=\"datepicker_ok\">Ok</string>\r\n    <string name=\"datepicker_cancel\">Cancelar</string>\r\n    <string name=\"confirm_button\">CONFIRMAR</string>\r\n    <string name=\"contentimage_confirmation\">Confirmado</string>\r\n    <string name=\"confirmation_appointment\">¡CASI LISTO!</string>\r\n    <string name=\"details_appointment\">Tu solicitud de reserva está preparada. Por favor, pulsa \\'enviar\\' en la aplicación de correo que se acaba de abrir para finalizar tu solicitud. Te responderemos a ese correo para confirmar la disponibilidad.</string>\r\n    <string name=\"email_subject\">Solicitud de Reserva de Vista - %1$s</string>\r\n    <string name=\"email_message\">Hola,\\n\\nMe gustaría solicitar una reserva para una visita al monasterio con los siguientes datos:\\n\\n* Nombre: %1$s\\n* Email: %2$s\\n* Fecha de la visita: %3$s\\n* Hora de la visita: %4$s\\n\\nQuedo a la espera de su amable confirmación.\\n\\nMuchas gracias,\\nAtentamente,\\n\\n%1$s</string>\r\n    <string name=\"email_error\">No se encontró ninguna app de correo</string>\r\n    <string name=\"history_content_placeholder\">Mauris vel nisi id metus vestibulum vehicula nec ac orci. Curabitur massa diam, fermentum sit amet augue sit, volutpat efficitur enim. Phasellus a cursus orci, id laoreet dolor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</string>\r\n    <string name=\"language_select\">Seleccionar Idioma</string>\r\n    <string name=\"font_size_select\">Selecciona el tamaño de la letra</string>\r\n    <string name=\"font_extrabig\">Extra Grande</string>\r\n    <string name=\"font_normal\">Mediana</string>\r\n    <string name=\"font_big\">Grande</string>\r\n    <string name=\"title_monasterio\">Monasterio</string>\r\n</resources>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
+------ a/app/src/main/res/values/strings.xml	(revision 6455732f5969476c18d5bc46e33a52869ec3e410)
+---+++ b/app/src/main/res/values/strings.xml	(date 1762599962270)
+---@@ -1,5 +1,5 @@
+--- <resources>
+----    <string name="app_name">Santa María\nla Real de Huelgas</string>
+---+    <string name="app_name">Santa María la Real de Huelgas</string>
+---     <string name="title_inicio">Inicio</string>
+---     <string name="virtual_visit">VISITA VIRTUAL</string>
+---     <string name="book_appointment">RESERVA CITA</string>
+---@@ -57,4 +57,7 @@
+---     <string name="font_normal">Mediana</string>
+---     <string name="font_big">Grande</string>
+---     <string name="title_monasterio">Monasterio</string>
+---+    <string name="spanish_language">Español</string>
+---+    <string name="german_language">Alemán</string>
+---+    <string name="english_language">Inglés</string>
+--- </resources>
+---\ No newline at end of file
+---Index: app/src/main/res/values-en/strings.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<resources>\r\n    <string name=\"app_name\">Museum360</string>\r\n    <string name=\"title_inicio\">Home</string>\r\n    <string name=\"virtual_visit\">VIRTUAL VISIT</string>\r\n    <string name=\"book_appointment\">BOOK APPOINTMENT</string>\r\n    <string name=\"monastery_name\">Santa María\\nla Real de Huelgas</string>\r\n    <string name=\"edit_mode\">Edit mode</string>\r\n    <string name=\"navigation_drawer_open\">Open menu</string>\r\n    <string name=\"navigation_drawer_close\">Close menu</string>\r\n    <string name=\"menu_info\">Monastery information</string>\r\n    <string name=\"menu_history\">History</string>\r\n    <string name=\"menu_gallery\">Gallery</string>\r\n    <string name=\"menu_profile\">Profile</string>\r\n    <string name=\"menu_settings\">Settings</string>\r\n    <string name=\"title_info_general\">General Information</string>\r\n    <string name=\"title_history\">History</string>\r\n    <string name=\"title_gallery\">Gallery</string>\r\n    <string name=\"title_profile\">Profile</string>\r\n    <string name=\"title_settings\">Settings</string>\r\n\r\n    <string name=\"info_location\">Street: …</string>\r\n\r\n    <string name=\"info_hours\">Hours: XX:XX - YY:YY</string>\r\n    <string name=\"general_info\">General information:</string>\r\n\r\n    <string name=\"history_1800\">1800</string>\r\n    <string name=\"history_1900\">1900-1950</string>\r\n    <string name=\"history_1950\">1950-2000</string>\r\n    <string name=\"history_actualidad\">Present Day</string>\r\n    <string name=\"title_appointment\">Book Appointment</string>\r\n    <string name=\"option_phone_appointment\">Book by phone</string>\r\n    <string name=\"option_online_appointment\">Book online</string>\r\n    <string name=\"name_appointment\">Name</string>\r\n    <string name=\"email_appointment\">Email</string>\r\n    <string name=\"date_appointment\">Date</string>\r\n    <string name=\"hour_appointment\">Time</string>\r\n    <string name=\"placeholdername_appointment\">Enter your full name</string>\r\n    <string name=\"placeholderemail_appointment\">Enter your email address</string>\r\n    <string name=\"placeholderdate_appointment\">Select a date</string>\r\n    <string name=\"placeholderhour_appointment\">Select a time</string>\r\n    <string name=\"compulsory_name\">Name is required</string>\r\n    <string name=\"valid_name\">The name contains an invalid symbol</string>\r\n    <string name=\"compulsory_email\">Email is required</string>\r\n    <string name=\"valid_email\">The email format is invalid</string>\r\n    <string name=\"date_no_selected\">A date must be selected</string>\r\n    <string name=\"hour_no_selected\">A time must be selected</string>\r\n    <string name=\"datepicker_ok\">Ok</string>\r\n    <string name=\"datepicker_cancel\">Cancel</string>\r\n    <string name=\"confirm_button\">CONFIRM</string>\r\n    <string name=\"contentimage_confirmation\">Confirmed</string>\r\n    <string name=\"confirmation_appointment\">ALMOST READY!!</string>\r\n    <string name=\"details_appointment\">Your booking request is ready. Please click \\'send\\' in the email application that just opened to finalize your request. We will reply to that email to confirm availability..</string>\r\n    <string name=\"email_subject\">View Reservation Request - %1$s</string>\r\n    <string name=\"email_message\">Hello,\\n\\nI would like to request a reservation for a visit to the monastery with the following details:\\n\\n* Name: %1$s\\n* Email: %2$s\\n* Date of visit: %3$s\\n* Time of visit: %4$s\\n\\nI look forward to your kind confirmation.\\n\\nThank you very much,\\nSincerely,\\n\\n%1$s</string>\r\n    <string name=\"email_error\">No email app was found</string>\r\n    <string name=\"history_content_placeholder\">Mauris vel nisi id metus vestibulum vehicula nec ac orci. Curabitur massa diam, fermentum sit amet augue sit, volutpat efficitur enim. Phasellus a cursus orci, id laoreet dolor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</string>\r\n    <string name=\"language_select\">Select language</string>\r\n    <string name=\"font_size_select\">Select the font size</string>\r\n    <string name=\"font_extrabig\">Extra Big</string>\r\n    <string name=\"font_normal\">Medium</string>\r\n    <string name=\"font_big\">Big</string>\r\n    <string name=\"title_monasterio\">Monastery</string>\r\n\r\n</resources>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/res/values-en/strings.xml b/app/src/main/res/values-en/strings.xml
+------ a/app/src/main/res/values-en/strings.xml	(revision 6455732f5969476c18d5bc46e33a52869ec3e410)
+---+++ b/app/src/main/res/values-en/strings.xml	(date 1762599962278)
+---@@ -61,5 +61,8 @@
+---     <string name="font_normal">Medium</string>
+---     <string name="font_big">Big</string>
+---     <string name="title_monasterio">Monastery</string>
+---+    <string name="spanish_language">Spanish</string>
+---+    <string name="german_language">German</string>
+---+    <string name="english_language">English</string>
+--- 
+--- </resources>
+---\ No newline at end of file
+---Index: app/src/main/res/values-de/strings.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<resources>\r\n    <string name=\"app_name\">Museum360</string>\r\n    <string name=\"title_inicio\">Startseite</string>\r\n    <string name=\"virtual_visit\">VIRTUELLER BESUCH</string>\r\n    <string name=\"book_appointment\">TERMIN BUCHEN</string>\r\n    <string name=\"monastery_name\">Santa María\\nla Real de Huelgas</string>\r\n    <string name=\"edit_mode\">Bearbeiten</string>\r\n    <string name=\"navigation_drawer_open\">Menü öffnen</string>\r\n    <string name=\"navigation_drawer_close\">Menü schließen</string>\r\n    <string name=\"menu_info\">Klosterinformationen</string>\r\n    <string name=\"menu_history\">Geschichte</string>\r\n    <string name=\"menu_gallery\">Galerie</string>\r\n    <string name=\"menu_profile\">Profil</string>\r\n    <string name=\"menu_settings\">Einstellungen</string>\r\n    <string name=\"title_info_general\">Allgemeine Informationen</string>\r\n    <string name=\"title_history\">Geschichte</string>\r\n    <string name=\"title_gallery\">Galerie</string>\r\n    <string name=\"title_profile\">Profil</string>\r\n    <string name=\"title_settings\">Einstellungen</string>\r\n\r\n\r\n    <string name=\"info_location\">Straße: …</string>\r\n\r\n    <string name=\"info_hours\">Öffnungszeiten: XX:XX - YY:YY</string>\r\n    <string name=\"general_info\">Allgemeine Informationen:</string>\r\n\r\n    <string name=\"history_1800\">1800</string>\r\n    <string name=\"history_1900\">1900-1950</string>\r\n    <string name=\"history_1950\">1950-2000</string>\r\n    <string name=\"history_actualidad\">Heute</string>\r\n    <string name=\"title_appointment\">Termin vereinbaren</string>\r\n    <string name=\"option_phone_appointment\">Buchen Sie telefonisch</string>\r\n    <string name=\"option_online_appointment\">Online buchen</string>\r\n    <string name=\"name_appointment\">Name</string>\r\n    <string name=\"email_appointment\">E-Mail</string>\r\n    <string name=\"date_appointment\">Datum</string>\r\n    <string name=\"hour_appointment\">Stunde</string>\r\n    <string name=\"placeholdername_appointment\">Geben Sie Ihren vollständigen Namen ein</string>\r\n    <string name=\"placeholderemail_appointment\">Geben Sie Ihre E-Mail-Adresse ein</string>\r\n    <string name=\"placeholderdate_appointment\">Datum auswählen</string>\r\n    <string name=\"placeholderhour_appointment\">Wählen Sie eine Uhrzeit</string>\r\n    <string name=\"compulsory_name\">Name erforderlich</string>\r\n    <string name=\"valid_name\">Der Name enthält ein ungültiges Symbol</string>\r\n    <string name=\"compulsory_email\">E-Mail-Adresse erforderlich</string>\r\n    <string name=\"valid_email\">Das E-Mail-Format ist ungültig.</string>\r\n    <string name=\"date_no_selected\">Ein Datum muss ausgewählt werden.</string>\r\n    <string name=\"hour_no_selected\">Es muss ein Zeitpunkt ausgewählt werden.</string>\r\n    <string name=\"datepicker_ok\">Ok</string>\r\n    <string name=\"datepicker_cancel\">Stornieren</string>\r\n    <string name=\"confirm_button\">BESTÄTIGEN</string>\r\n    <string name=\"contentimage_confirmation\">Bestätigt</string>\r\n    <string name=\"confirmation_appointment\">FAST FERTIG!!</string>\r\n    <string name=\"details_appointment\">Ihre Buchungsanfrage ist fertig. Bitte klicken Sie in der soeben geöffneten E-Mail-Anwendung auf „Senden“, um Ihre Anfrage abzuschließen. Wir werden Ihnen die Verfügbarkeit per E-Mail bestätigen..</string>\r\n    <string name=\"email_subject\">Reservierungsanfrage ansehen - %1$s</string>\r\n    <string name=\"email_message\">Hallo,\\n\\nich möchte hiermit eine Reservierung für einen Besuch im Kloster anfragen. Bitte geben Sie folgende Daten an:\\n\\n* Name: %1$s\\n* E-Mail: %2$s\\n* Besuchsdatum: %3$s\\n* Besuchszeit: %4$s\\n\\nIch freue mich auf Ihre Bestätigung.\\n\\nVielen Dank,\\nMit freundlichen Grüßen,\\n\\n%1$s</string>\r\n    <string name=\"email_error\">Es wurde keine E-Mail-App gefunden.</string>\r\n    <string name=\"history_content_placeholder\">Mauris vel nisi id metus vestibulum vehicula nec ac orci. Curabitur massa diam, fermentum sit amet augue sit, volutpat efficitur enim. Phasellus a cursus orci, id laoreet dolor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</string>\r\n    <string name=\"language_select\">Sprache auswählen</string>\r\n    <string name=\"font_size_select\">Wählen Sie die Schriftgröße aus</string>\r\n    <string name=\"font_extrabig\">Extra groß</string>\r\n    <string name=\"font_normal\">Mittlere</string>\r\n    <string name=\"font_big\">Groß</string>\r\n    <string name=\"title_monasterio\">Kloster</string>\r\n\r\n</resources>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/res/values-de/strings.xml b/app/src/main/res/values-de/strings.xml
+------ a/app/src/main/res/values-de/strings.xml	(revision 6455732f5969476c18d5bc46e33a52869ec3e410)
+---+++ b/app/src/main/res/values-de/strings.xml	(date 1762599962287)
+---@@ -62,5 +62,8 @@
+---     <string name="font_normal">Mittlere</string>
+---     <string name="font_big">Groß</string>
+---     <string name="title_monasterio">Kloster</string>
+---+    <string name="spanish_language">Spanisch</string>
+---+    <string name="german_language">Deutsch</string>
+---+    <string name="english_language">Englisch</string>
+--- 
+--- </resources>
+---\ No newline at end of file
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08__Changes_.xml
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08__Changes_.xml
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08__Changes_.xml	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,4 +0,0 @@
+---<changelist name="Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]" date="1762636094033" recycled="true" deleted="true">
+---  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]/shelved.patch" />
+---  <option name="DESCRIPTION" value="Uncommitted changes before Checkout at 08/11/2025 22:08 [Changes]" />
+---</changelist>
+--\ No newline at end of file
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_54__Changes_.xml
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_54__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_54__Changes_.xml
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_54__Changes_.xml	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,4 +0,0 @@
+---<changelist name="Uncommitted_changes_before_Checkout_at_08_11_2025_22_54_[Changes]" date="1762638861779" recycled="true" deleted="true">
+---  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_54_[Changes]/shelved.patch" />
+---  <option name="DESCRIPTION" value="Uncommitted changes before Checkout at 08/11/2025 22:54 [Changes]" />
+---</changelist>
+--\ No newline at end of file
+--Index: .idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_12_05__Changes_1.xml
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_12_05__Changes_1.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_12_05__Changes_1.xml
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_12_05__Changes_1.xml	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,4 +0,0 @@
+---<changelist name="Uncommitted_changes_before_Update_at_08_11_2025_12_05_[Changes]1" date="1762599965498" recycled="true" deleted="true">
+---  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_08_11_2025_12_05_[Changes]1/shelved.patch" />
+---  <option name="DESCRIPTION" value="Uncommitted changes before Update at 08/11/2025 12:05 [Changes]" />
+---</changelist>
+--\ No newline at end of file
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]/shelved.patch
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]/shelved.patch
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_08_[Changes]/shelved.patch	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,17 +0,0 @@
+---Index: .idea/gradle.xml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"GradleSettings\">\r\n    <option name=\"linkedExternalProjectsSettings\">\r\n      <GradleProjectSettings>\r\n        <option name=\"testRunner\" value=\"CHOOSE_PER_TEST\" />\r\n        <option name=\"externalProjectPath\" value=\"$PROJECT_DIR$\" />\r\n        <option name=\"gradleJvm\" value=\"#GRADLE_LOCAL_JAVA_HOME\" />\r\n        <option name=\"modules\">\r\n          <set>\r\n            <option value=\"$PROJECT_DIR$\" />\r\n            <option value=\"$PROJECT_DIR$/app\" />\r\n          </set>\r\n        </option>\r\n      </GradleProjectSettings>\r\n    </option>\r\n  </component>\r\n</project>
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/.idea/gradle.xml b/.idea/gradle.xml
+------ a/.idea/gradle.xml	(revision 1c0bfc618ece38c61714e2813735e3a928424a11)
+---+++ b/.idea/gradle.xml	(date 1762636073534)
+---@@ -1,5 +1,6 @@
+--- <?xml version="1.0" encoding="UTF-8"?>
+--- <project version="4">
+---+  <component name="GradleMigrationSettings" migrationVersion="1" />
+---   <component name="GradleSettings">
+---     <option name="linkedExternalProjectsSettings">
+---       <GradleProjectSettings>
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_54_[Changes]/shelved.patch
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_54_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_54_[Changes]/shelved.patch
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_54_[Changes]/shelved.patch	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,258 +0,0 @@
+---Index: app/src/main/java/com/nextapp/monasterio/MainActivity.kt
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+>package com.nextapp.monasterio\r\n\r\nimport android.os.Bundle\r\nimport android.widget.Toast\r\nimport androidx.activity.ComponentActivity\r\nimport androidx.activity.compose.setContent\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.navigation.compose.rememberNavController\r\nimport com.nextapp.monasterio.ui.navigation.AppDrawerContent\r\nimport com.nextapp.monasterio.ui.navigation.AppNavigationHost\r\nimport com.nextapp.monasterio.ui.theme.*\r\nimport kotlinx.coroutines.launch\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport androidx.appcompat.app.AppCompatDelegate\r\nimport androidx.compose.ui.platform.LocalDensity\r\nimport androidx.compose.ui.unit.Density\r\nimport androidx.navigation.compose.currentBackStackEntryAsState\r\nimport com.nextapp.monasterio.utils.FontSize\r\n\r\nclass MainActivity : AppCompatActivity() {\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO)\r\n        super.onCreate(savedInstanceState)\r\n        LanguageHelper.loadLocale(this)\r\n        setContent {\r\n            val appFontScale = FontSize.devolverFontScale(this)\r\n            val currentDensity = LocalDensity.current\r\n            val newDensity= Density(\r\n                density= currentDensity.density,\r\n                fontScale = currentDensity.fontScale*appFontScale\r\n            )\r\n            CompositionLocalProvider(LocalDensity provides newDensity) {\r\n                Smov_monasterioTheme {\r\n                    MonasteryAppScreen()\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun MonasteryAppScreen() {\r\n    val context = LocalContext.current\r\n    val navController = rememberNavController()\r\n    val drawerState = rememberDrawerState(initialValue = DrawerValue.Closed)\r\n    val scope = rememberCoroutineScope()\r\n\r\n    val currentTitle = remember { mutableStateOf(context.getString(R.string.title_inicio)) }\r\n\r\n    // ✅ Detectar ruta actual\r\n    val currentBackStackEntry by navController.currentBackStackEntryAsState()\r\n    val currentRoute = currentBackStackEntry?.destination?.route\r\n\r\n    // ✅ Rutas inmersivas\r\n    val immersiveRoutes = listOf(AppRoutes.PIN_DETALLE)\r\n    val isImmersive = currentRoute in immersiveRoutes\r\n\r\n    val gesturesEnabled = when(currentRoute){\r\n        AppRoutes.VIRTUAL_VISIT -> false\r\n        else -> true\r\n    }\r\n\r\n    // ✅ Actualizar título\r\n    LaunchedEffect(navController) {\r\n        navController.currentBackStackEntryFlow.collect { backStackEntry ->\r\n            val route = backStackEntry.destination.route\r\n            currentTitle.value = when (route) {\r\n                AppRoutes.INFO -> context.getString(R.string.title_info_general)\r\n                AppRoutes.HISTORIA -> context.getString(R.string.title_history)\r\n                AppRoutes.GALERIA -> context.getString(R.string.title_gallery)\r\n                AppRoutes.PERFIL -> context.getString(R.string.title_profile)\r\n                AppRoutes.AJUSTES -> context.getString(R.string.title_settings)\r\n                AppRoutes.OPCIONES_RESERVA,\r\n                AppRoutes.RESERVA,\r\n                AppRoutes.CONFIRMACION_RESERVA -> context.getString(R.string.title_appointment)\r\n                AppRoutes.VIRTUAL_VISIT -> context.getString(R.string.title_monasterio)\r\n                else -> context.getString(R.string.title_inicio)\r\n            }\r\n        }\r\n    }\r\n\r\n    if (isImmersive) {\r\n        // \uD83C\uDF0C Vista inmersiva sin barra ni menú\r\n        AppNavigationHost(\r\n            navController = navController,\r\n            modifier = Modifier.fillMaxSize()\r\n        )\r\n    } else {\r\n        // \uD83E\uDDF1 Vista normal con barra y menú\r\n        ModalNavigationDrawer(\r\n            drawerState = drawerState,\r\n            drawerContent = {\r\n                AppDrawerContent(\r\n                    navController = navController,\r\n                    scope = scope,\r\n                    drawerState = drawerState\r\n                )\r\n            },\r\n            gesturesEnabled = gesturesEnabled\r\n        ) {\r\n            Scaffold(\r\n                topBar = {\r\n                    CenterAlignedTopAppBar(\r\n                        title = { Text(currentTitle.value) },\r\n                        colors = TopAppBarDefaults.topAppBarColors(\r\n                            containerColor = MonasteryRed,\r\n                            titleContentColor = White,\r\n                            navigationIconContentColor = White,\r\n                            actionIconContentColor = White\r\n                        ),\r\n                        navigationIcon = {\r\n                            IconButton(onClick = {\r\n                                scope.launch {\r\n                                    drawerState.apply {\r\n                                        if (isClosed) open() else close()\r\n                                    }\r\n                                }\r\n                            }) {\r\n                                val iconRes = if (drawerState.isOpen) R.drawable.menu_close else R.drawable.ic_menu_24\r\n                                Icon(\r\n                                    painter = painterResource(id = iconRes),\r\n                                    contentDescription = stringResource(id = R.string.navigation_drawer_open)\r\n                                )\r\n                            }\r\n                        },\r\n                        actions = {\r\n                            IconButton(onClick = {\r\n                                Toast.makeText(context, \"Modo edición (próximamente)\", Toast.LENGTH_SHORT).show()\r\n                            }) {\r\n                                Icon(\r\n                                    painter = painterResource(id = R.drawable.lapiz),\r\n                                    contentDescription = stringResource(id = R.string.edit_mode)\r\n                                )\r\n                            }\r\n                        }\r\n                    )\r\n                }\r\n            ) { paddingValues ->\r\n                AppNavigationHost(\r\n                    navController = navController,\r\n                    modifier = Modifier.padding(paddingValues)\r\n                )\r\n            }\r\n        }\r\n    }\r\n}
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/java/com/nextapp/monasterio/MainActivity.kt b/app/src/main/java/com/nextapp/monasterio/MainActivity.kt
+------ a/app/src/main/java/com/nextapp/monasterio/MainActivity.kt	(revision 39a86368e80442156ba767c8ea88d7fdae822333)
+---+++ b/app/src/main/java/com/nextapp/monasterio/MainActivity.kt	(date 1762637290372)
+---@@ -1,8 +1,8 @@
+--- package com.nextapp.monasterio
+--- 
+---+
+--- import android.os.Bundle
+--- import android.widget.Toast
+----import androidx.activity.ComponentActivity
+--- import androidx.activity.compose.setContent
+--- import androidx.compose.foundation.layout.*
+--- import androidx.compose.material3.*
+---@@ -18,8 +18,14 @@
+--- import kotlinx.coroutines.launch
+--- import androidx.appcompat.app.AppCompatActivity
+--- import androidx.appcompat.app.AppCompatDelegate
+---+import androidx.compose.foundation.Image
+---+import androidx.compose.foundation.border
+---+import androidx.compose.ui.graphics.Color
+---+import androidx.compose.ui.layout.ContentScale
+---+import androidx.compose.ui.platform.LocalConfiguration
+--- import androidx.compose.ui.platform.LocalDensity
+--- import androidx.compose.ui.unit.Density
+---+import androidx.compose.ui.unit.dp
+--- import androidx.navigation.compose.currentBackStackEntryAsState
+--- import com.nextapp.monasterio.utils.FontSize
+--- 
+---@@ -52,15 +58,39 @@
+---     val drawerState = rememberDrawerState(initialValue = DrawerValue.Closed)
+---     val scope = rememberCoroutineScope()
+--- 
+---+    val stringEspanyol= "Español"
+---+    val stringAleman= "Deutsch"
+---+    val stringIngles= "English"
+---+
+---+
+---+    var mostrarIdioma by remember { mutableStateOf(false) }
+---+
+---+    val configuration = LocalConfiguration.current
+---+    val currentLanguageCode = configuration.locales[0].language
+---+
+---+    var idioma by remember { mutableStateOf(currentLanguageCode) }
+---+
+---+    var idiomasDisponibles = listOf(stringEspanyol,stringIngles,stringAleman)
+---+
+---     val currentTitle = remember { mutableStateOf(context.getString(R.string.title_inicio)) }
+--- 
+---     // ✅ Detectar ruta actual
+---     val currentBackStackEntry by navController.currentBackStackEntryAsState()
+---     val currentRoute = currentBackStackEntry?.destination?.route
+--- 
+----    // ✅ Rutas inmersivas
+----    val immersiveRoutes = listOf(AppRoutes.PIN_DETALLE)
+----    val isImmersive = currentRoute in immersiveRoutes
+---+    // --- ¡AQUÍ ESTÁ LA CORRECCIÓN! ---
+---+    // En lugar de una lista, comprobamos si la ruta "empieza por" la ruta base,
+---+    // ya que ahora tiene argumentos (ej: "panorama/monastery_1")
+---+
+---+    // Comprueba si la ruta actual empieza por "panorama"
+---+    val isPanorama = currentRoute?.startsWith(AppRoutes.PANORAMA) == true
+---+    // Comprueba si la ruta actual es exactamente "pin_detalle"
+---+    val isPinDetalle = currentRoute == AppRoutes.PIN_DETALLE
+---+
+---+    // La vista es inmersiva si CUALQUIERA de las dos es verdadera
+---+    val isImmersive = isPanorama || isPinDetalle
+---+    // --- FIN DE LA CORRECCIÓN ---
+---+
+--- 
+---     val gesturesEnabled = when(currentRoute){
+---         AppRoutes.VIRTUAL_VISIT -> false
+---@@ -71,7 +101,11 @@
+---     LaunchedEffect(navController) {
+---         navController.currentBackStackEntryFlow.collect { backStackEntry ->
+---             val route = backStackEntry.destination.route
+----            currentTitle.value = when (route) {
+---+            // --- MODIFICACIÓN SUGERIDA ---
+---+            // Añadimos esto para que no intente buscar un título para la ruta con argumento
+---+            val routeBase = route?.split("/")?.firstOrNull() ?: route
+---+
+---+            currentTitle.value = when (routeBase) { // <-- Usamos routeBase
+---                 AppRoutes.INFO -> context.getString(R.string.title_info_general)
+---                 AppRoutes.HISTORIA -> context.getString(R.string.title_history)
+---                 AppRoutes.GALERIA -> context.getString(R.string.title_gallery)
+---@@ -81,6 +115,7 @@
+---                 AppRoutes.RESERVA,
+---                 AppRoutes.CONFIRMACION_RESERVA -> context.getString(R.string.title_appointment)
+---                 AppRoutes.VIRTUAL_VISIT -> context.getString(R.string.title_monasterio)
+---+                // (No es necesario añadir PANORAMA aquí, ya que será inmersiva y no mostrará título)
+---                 else -> context.getString(R.string.title_inicio)
+---             }
+---         }
+---@@ -131,8 +166,46 @@
+---                             }
+---                         },
+---                         actions = {
+---+                            Box {
+---+                                OutlinedIconButton(onClick = {
+---+                                    mostrarIdioma = true
+---+                                }) {
+---+                                    val iconRes =
+---+                                        if (idioma == "es" || idioma == stringEspanyol) R.drawable.espanya else if (idioma == "de" || idioma == stringAleman) R.drawable.alemania else R.drawable.reinounido
+---+                                    Image(
+---+                                        painter = painterResource(id = iconRes),
+---+                                        contentDescription = if (idioma == "es" || idioma == stringEspanyol ) stringEspanyol
+---+                                        else if (idioma == "de" || idioma == stringAleman) stringAleman else stringIngles,
+---+                                        contentScale = ContentScale.Crop
+---+                                    )
+---+                                }
+---+                                DropdownMenu(
+---+                                    expanded = mostrarIdioma,
+---+                                    onDismissRequest = { mostrarIdioma = false },
+---+                                    modifier = Modifier.fillMaxWidth(0.8f),
+---+                                ) {
+---+                                    idiomasDisponibles.forEach { idiomaSlot ->
+---+                                        DropdownMenuItem(
+---+                                            text = { Text(idiomaSlot) },
+---+                                            onClick = {
+---+                                                idioma = idiomaSlot
+---+                                                mostrarIdioma = false
+---+                                                if(idiomaSlot == stringEspanyol)
+---+                                                    LanguageHelper.saveLocale(context, "es")
+---+                                                else if(idiomaSlot == stringAleman){
+---+                                                    LanguageHelper.saveLocale(context, "de")
+---+                                                } else LanguageHelper.saveLocale(context, "en")
+---+                                            }
+---+                                        )
+---+                                    }
+---+                                }
+---+                            }
+---                             IconButton(onClick = {
+----                                Toast.makeText(context, "Modo edición (próximamente)", Toast.LENGTH_SHORT).show()
+---+                                Toast.makeText(
+---+                                    context,
+---+                                    "Modo edición (próximamente)",
+---+                                    Toast.LENGTH_SHORT
+---+                                ).show()
+---                             }) {
+---                                 Icon(
+---                                     painter = painterResource(id = R.drawable.lapiz),
+---Index: settings.gradle.kts
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+>pluginManagement {\r\n    repositories {\r\n        google {\r\n            content {\r\n                includeGroupByRegex(\"com\\\\.android.*\")\r\n                includeGroupByRegex(\"com\\\\.google.*\")\r\n                includeGroupByRegex(\"androidx.*\")\r\n            }\r\n        }\r\n        mavenCentral()\r\n        gradlePluginPortal()\r\n    }\r\n}\r\ndependencyResolutionManagement {\r\n    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)\r\n    repositories {\r\n        google()\r\n        mavenCentral( )\r\n        maven { url = uri(\"https://www.jitpack.io\") }\r\n    }\r\n}\r\n\r\nrootProject.name = \"SMOV_Monasterio\"\r\ninclude(\":app\")\r\n 
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/settings.gradle.kts b/settings.gradle.kts
+------ a/settings.gradle.kts	(revision 39a86368e80442156ba767c8ea88d7fdae822333)
+---+++ b/settings.gradle.kts	(date 1762637928480)
+---@@ -16,7 +16,7 @@
+---     repositories {
+---         google()
+---         mavenCentral( )
+----        maven { url = uri("https://www.jitpack.io") }
+---+        maven { url = uri("https://jitpack.io") }
+---     }
+--- }
+--- 
+---Index: app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+>package com.nextapp.monasterio.ui.navigation\r\n\r\nimport androidx.compose.foundation.clickable\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.res.painterResource\r\nimport androidx.compose.ui.res.stringResource\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.navigation.NavGraph.Companion.findStartDestination\r\nimport androidx.navigation.NavHostController\r\nimport androidx.navigation.NavType\r\nimport androidx.navigation.navArgument\r\nimport androidx.navigation.compose.NavHost\r\nimport androidx.navigation.compose.composable\r\nimport com.nextapp.monasterio.AppRoutes\r\nimport com.nextapp.monasterio.R\r\nimport com.nextapp.monasterio.ui.screens.*\r\nimport com.nextapp.monasterio.ui.virtualvisit.screens.*\r\nimport com.nextapp.monasterio.ui.theme.MonasteryRed\r\nimport com.nextapp.monasterio.ui.theme.White\r\nimport kotlinx.coroutines.CoroutineScope\r\nimport kotlinx.coroutines.launch\r\n\r\n@Composable\r\nfun AppNavigationHost(\r\n    navController: NavHostController,\r\n    modifier: Modifier = Modifier\r\n) {\r\n    NavHost(\r\n        navController = navController,\r\n        startDestination = AppRoutes.INICIO,\r\n        modifier = modifier\r\n    ) {\r\n        composable(AppRoutes.INICIO)   { HomeScreenContent(navController = navController) }\r\n        composable(AppRoutes.INFO)     { InfoScreen() }\r\n        composable(AppRoutes.HISTORIA) { HistoriaScreen() }\r\n        composable(AppRoutes.GALERIA)  { GaleriaScreen() }\r\n        composable(AppRoutes.PERFIL)   { ProfileScreen() }\r\n        composable(AppRoutes.AJUSTES)  { AjustesScreen() }\r\n        composable(AppRoutes.OPCIONES_RESERVA) { OpcionesReservaScreen(navController = navController) }\r\n        composable(AppRoutes.RESERVA) { ReservaScreen(navController = navController) }\r\n\r\n        composable(\r\n            route = AppRoutes.CONFIRMACION_RESERVA + \"/{nombre}/{email}/{fecha}/{hora}\",\r\n            arguments = listOf(\r\n                navArgument(\"nombre\") { type = NavType.StringType },\r\n                navArgument(\"email\") { type = NavType.StringType },\r\n                navArgument(\"fecha\") { type = NavType.StringType },\r\n                navArgument(\"hora\") { type = NavType.StringType }\r\n            )\r\n        ) { backStackEntry ->\r\n            val nombre = backStackEntry.arguments?.getString(\"nombre\") ?: \"\"\r\n            val email = backStackEntry.arguments?.getString(\"email\") ?: \"\"\r\n            val fecha = backStackEntry.arguments?.getString(\"fecha\") ?: \"\"\r\n            val hora = backStackEntry.arguments?.getString(\"hora\") ?: \"\"\r\n            ConfirmacionReservaScreen(\r\n                navController = navController,\r\n                nombre = nombre,\r\n                email = email,\r\n                fecha = fecha,\r\n                hora = hora\r\n            )\r\n        }\r\n\r\n        // \uD83E\uDDED Módulo de visita virtual\r\n        composable(AppRoutes.VIRTUAL_VISIT) {\r\n            VirtualVisitScreen(navController = navController)\r\n        }\r\n\r\n        composable(\r\n            route = \"pin_detalle/{pinId}\",\r\n            arguments = listOf(navArgument(\"pinId\") { type = NavType.StringType })\r\n        ) { backStackEntry ->\r\n            val pinId = backStackEntry.arguments?.getString(\"pinId\") ?: \"\"\r\n            PinDetalleFirestoreScreen(\r\n                pinId = pinId,\r\n                navController = navController\r\n            )\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n}\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun AppDrawerContent(\r\n    navController: NavHostController,\r\n    scope: CoroutineScope,\r\n    drawerState: DrawerState\r\n) {\r\n    val navigateTo: (String) -> Unit = { route ->\r\n        navController.navigate(route) {\r\n            popUpTo(navController.graph.findStartDestination().id)\r\n            launchSingleTop = true\r\n        }\r\n        scope.launch { drawerState.close() }\r\n    }\r\n\r\n    ModalDrawerSheet(\r\n        modifier = Modifier.fillMaxHeight(),\r\n        drawerContainerColor = MonasteryRed,\r\n        drawerContentColor = White\r\n    ) {\r\n        Column(\r\n            modifier = Modifier\r\n                .fillMaxSize()\r\n                .padding(16.dp)\r\n        ) {\r\n            IconButton(onClick = { scope.launch { drawerState.close() } }) {\r\n                Icon(\r\n                    painter = painterResource(id = R.drawable.ic_menu_24),\r\n                    contentDescription = stringResource(id = R.string.navigation_drawer_close)\r\n                )\r\n            }\r\n            Spacer(modifier = Modifier.height(32.dp))\r\n\r\n            DrawerMenuItem(text = stringResource(id = R.string.title_inicio)) { navigateTo(AppRoutes.INICIO) }\r\n            DrawerMenuItem(text = stringResource(id = R.string.menu_info)) { navigateTo(AppRoutes.INFO) }\r\n            DrawerMenuItem(text = stringResource(id = R.string.menu_history)) { navigateTo(AppRoutes.HISTORIA) }\r\n            DrawerMenuItem(text = stringResource(id = R.string.menu_gallery)) { navigateTo(AppRoutes.GALERIA) }\r\n            DrawerMenuItem(text = stringResource(id = R.string.menu_profile)) { navigateTo(AppRoutes.PERFIL) }\r\n            DrawerMenuItem(text = stringResource(id = R.string.menu_settings)) { navigateTo(AppRoutes.AJUSTES) }\r\n        }\r\n    }\r\n}\r\n\r\n@Composable\r\nfun DrawerMenuItem(text: String, onClick: () -> Unit) {\r\n    Row(\r\n        modifier = Modifier\r\n            .fillMaxWidth()\r\n            .clickable(onClick = onClick)\r\n            .padding(vertical = 12.dp),\r\n        verticalAlignment = Alignment.CenterVertically\r\n    ) {\r\n        Icon(\r\n            painter = painterResource(id = R.drawable.arrow_right),\r\n            contentDescription = null,\r\n            modifier = Modifier.size(20.dp)\r\n        )\r\n        Spacer(modifier = Modifier.width(16.dp))\r\n        Text(text = text, color = White, style = MaterialTheme.typography.bodyMedium)\r\n    }\r\n}\r\n
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt b/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt
+------ a/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt	(revision 39a86368e80442156ba767c8ea88d7fdae822333)
+---+++ b/app/src/main/java/com/nextapp/monasterio/ui/navigation/AppNavigation.kt	(date 1762638506592)
+---@@ -40,9 +40,27 @@
+---         composable(AppRoutes.GALERIA)  { GaleriaScreen() }
+---         composable(AppRoutes.PERFIL)   { ProfileScreen() }
+---         composable(AppRoutes.AJUSTES)  { AjustesScreen() }
+---+
+---+        composable(
+---+            route = AppRoutes.PANORAMA + "/{vistaId}", // Define la ruta con argumento
+---+            arguments = listOf(navArgument("vistaId") { type = NavType.StringType })
+---+        ) { backStackEntry ->
+---+            // Recoge el argumento
+---+            val vistaId = backStackEntry.arguments?.getString("vistaId")
+---+
+---+            // Llama a PanoramaScreen con el ID y el NavController
+---+            if (vistaId != null) {
+---+                PanoramaScreen(
+---+                    vistaId = vistaId,
+---+                    navController = navController
+---+                )
+---+            }
+---+        }
+---+
+---         composable(AppRoutes.OPCIONES_RESERVA) { OpcionesReservaScreen(navController = navController) }
+---         composable(AppRoutes.RESERVA) { ReservaScreen(navController = navController) }
+--- 
+---+
+---         composable(
+---             route = AppRoutes.CONFIRMACION_RESERVA + "/{nombre}/{email}/{fecha}/{hora}",
+---             arguments = listOf(
+---Index: app/build.gradle.kts
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+>plugins {\r\n    alias(libs.plugins.android.application)\r\n    alias(libs.plugins.kotlin.android)\r\n    alias(libs.plugins.kotlin.compose)\r\n    alias(libs.plugins.firebase.gservices)\r\n}\r\n\r\nandroid {\r\n    namespace = \"com.nextapp.monasterio\"\r\n    compileSdk = 36\r\n\r\n    defaultConfig {\r\n        applicationId = \"com.nextapp.monasterio\"\r\n        minSdk = 24\r\n        targetSdk = 36\r\n        versionCode = 1\r\n        versionName = \"1.0\"\r\n\r\n        testInstrumentationRunner = \"androidx.test.runner.AndroidJUnitRunner\"\r\n    }\r\n\r\n    buildTypes {\r\n        release {\r\n            isMinifyEnabled = false\r\n            proguardFiles(\r\n                getDefaultProguardFile(\"proguard-android-optimize.txt\"),\r\n                \"proguard-rules.pro\"\r\n            )\r\n        }\r\n    }\r\n    compileOptions {\r\n        sourceCompatibility = JavaVersion.VERSION_11\r\n        targetCompatibility = JavaVersion.VERSION_11\r\n    }\r\n    kotlinOptions {\r\n        jvmTarget = \"11\"\r\n    }\r\n    buildFeatures {\r\n        compose = true\r\n    }\r\n}\r\n\r\ndependencies {\r\n\r\n    implementation(libs.androidx.core.ktx)\r\n    implementation(libs.androidx.lifecycle.runtime.ktx)\r\n    implementation(libs.androidx.activity.compose)\r\n    implementation(platform(libs.androidx.compose.bom))\r\n    implementation(libs.androidx.ui)\r\n    implementation(libs.androidx.ui.graphics)\r\n    implementation(libs.androidx.ui.tooling.preview)\r\n    implementation(libs.androidx.material3)\r\n    implementation(libs.androidx.compose.foundation)\r\n    implementation(libs.google.firebase.firestore)\r\n    testImplementation(libs.junit)\r\n    androidTestImplementation(libs.androidx.junit)\r\n    androidTestImplementation(libs.androidx.espresso.core)\r\n    androidTestImplementation(platform(libs.androidx.compose.bom))\r\n    androidTestImplementation(libs.androidx.ui.test.junit4)\r\n    debugImplementation(libs.androidx.ui.tooling)\r\n    debugImplementation(libs.androidx.ui.test.manifest)\r\n    //Practica\r\n    implementation(libs.constraintlayout.compose)\r\n    implementation(libs.navigation.compose)\r\n    implementation (libs.androidx.appcompat)\r\n    implementation (libs.google.material)\r\n\r\n    // Firebase\r\n    implementation(platform(libs.firebase.bom))\r\n    implementation(libs.firebase.firestore)\r\n    implementation(\"com.google.firebase:firebase-auth-ktx\")\r\n\r\n    implementation(\"com.caverock:androidsvg:1.4\")\r\n    implementation(\"androidx.core:core-ktx:1.12.0\")\r\n    implementation(\"com.google.android.material:material:1.10.0\")\r\n\r\n    // Plano Interactivo\r\n    implementation(\"io.github.chrisbanes:PhotoView:2.3.0\")\r\n\r\n    // Cloudinary\r\n    implementation(\"io.coil-kt:coil-compose:2.7.0\")\r\n\r\n\r\n\r\n}\r\n
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/build.gradle.kts b/app/build.gradle.kts
+------ a/app/build.gradle.kts	(revision 39a86368e80442156ba767c8ea88d7fdae822333)
+---+++ b/app/build.gradle.kts	(date 1762638050671)
+---@@ -80,6 +80,8 @@
+---     // Cloudinary
+---     implementation("io.coil-kt:coil-compose:2.7.0")
+--- 
+---+    implementation("com.github.hannesa2:panoramagl:1.14")
+---+
+--- 
+--- 
+--- }
+---Index: app/src/main/java/com/nextapp/monasterio/AppRoutes.kt
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+>package com.nextapp.monasterio\r\n\r\n/**\r\n * Define todas las rutas (llaves) de navegación en un solo lugar\r\n * para evitar errores de escritura y centralizar la gestión.\r\n */\r\nobject AppRoutes {\r\n    const val INICIO = \"inicio\"\r\n    const val INFO = \"info\"\r\n    const val HISTORIA = \"historia\"\r\n    const val GALERIA = \"galeria\"\r\n    const val PERFIL = \"perfil\"\r\n    const val AJUSTES = \"ajustes\"\r\n    const val OPCIONES_RESERVA = \"opciones_reserva\"\r\n    const val RESERVA = \"reserva\"\r\n    const val CONFIRMACION_RESERVA = \"confirmacion_reserva\"\r\n    const val VIRTUAL_VISIT = \"virtual_visit\"\r\n    const val PIN_DETALLE = \"pin_detalle\"\r\n}\r\n
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/app/src/main/java/com/nextapp/monasterio/AppRoutes.kt b/app/src/main/java/com/nextapp/monasterio/AppRoutes.kt
+------ a/app/src/main/java/com/nextapp/monasterio/AppRoutes.kt	(revision 39a86368e80442156ba767c8ea88d7fdae822333)
+---+++ b/app/src/main/java/com/nextapp/monasterio/AppRoutes.kt	(date 1762638506598)
+---@@ -16,4 +16,6 @@
+---     const val CONFIRMACION_RESERVA = "confirmacion_reserva"
+---     const val VIRTUAL_VISIT = "virtual_visit"
+---     const val PIN_DETALLE = "pin_detalle"
+---+
+---+    const val PANORAMA = "panorama"
+--- }
+---Index: gradle/libs.versions.toml
+---IDEA additional info:
+---Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+---<+>[versions]\r\nagp = \"8.11.1\" #no cambiar de la 8.11.1\r\nkotlin = \"2.0.21\"\r\ncoreKtx = \"1.17.0\"\r\njunit = \"4.13.2\"\r\njunitVersion = \"1.3.0\"\r\nespressoCore = \"3.7.0\"\r\nlifecycleRuntimeKtx = \"2.9.4\"\r\nactivityCompose = \"1.11.0\"\r\ncomposeBom = \"2025.10.01\"\r\n#Practica\r\nconstraintlayoutCompose = \"1.1.1\"\r\nnavigationCompose = \"2.9.5\"\r\nfoundation = \"1.9.4\"\r\nappcompat = \"1.7.0\"\r\nmaterial = \"1.12.0\"\r\nfirebase-gservices = \"4.4.4\"\r\nfirebase-bom = \"33.1.0\"\r\nfirebaseFirestore = \"26.0.2\"\r\n\r\n[libraries]\r\nandroidx-core-ktx = { group = \"androidx.core\", name = \"core-ktx\", version.ref = \"coreKtx\" }\r\njunit = { group = \"junit\", name = \"junit\", version.ref = \"junit\" }\r\nandroidx-junit = { group = \"androidx.test.ext\", name = \"junit\", version.ref = \"junitVersion\" }\r\nandroidx-espresso-core = { group = \"androidx.test.espresso\", name = \"espresso-core\", version.ref = \"espressoCore\" }\r\nandroidx-lifecycle-runtime-ktx = { group = \"androidx.lifecycle\", name = \"lifecycle-runtime-ktx\", version.ref = \"lifecycleRuntimeKtx\" }\r\nandroidx-activity-compose = { group = \"androidx.activity\", name = \"activity-compose\", version.ref = \"activityCompose\" }\r\nandroidx-compose-bom = { group = \"androidx.compose\", name = \"compose-bom\", version.ref = \"composeBom\" }\r\nandroidx-ui = { group = \"androidx.compose.ui\", name = \"ui\" }\r\nandroidx-ui-graphics = { group = \"androidx.compose.ui\", name = \"ui-graphics\" }\r\nandroidx-ui-tooling = { group = \"androidx.compose.ui\", name = \"ui-tooling\" }\r\nandroidx-ui-tooling-preview = { group = \"androidx.compose.ui\", name = \"ui-tooling-preview\" }\r\nandroidx-ui-test-manifest = { group = \"androidx.compose.ui\", name = \"ui-test-manifest\" }\r\nandroidx-ui-test-junit4 = { group = \"androidx.compose.ui\", name = \"ui-test-junit4\" }\r\nandroidx-material3 = { group = \"androidx.compose.material3\", name = \"material3\" }\r\n#Practica\r\nconstraintlayout-compose = { module = \"androidx.constraintlayout:constraintlayout-compose\", version.ref = \"constraintlayoutCompose\" }\r\nnavigation-compose = { module = \"androidx.navigation:navigation-compose\", version.ref = \"navigationCompose\" }\r\nandroidx-compose-foundation = { group = \"androidx.compose.foundation\", name = \"foundation\", version.ref = \"foundation\" }\r\nandroidx-appcompat = { module = \"androidx.appcompat:appcompat\", version.ref = \"appcompat\" }\r\ngoogle-material = { module = \"com.google.android.material:material\", version.ref = \"material\" }\r\nfirebase-bom = { module = \"com.google.firebase:firebase-bom\", version.ref = \"firebase-bom\" }\r\nfirebase-firestore = { module = \"com.google.firebase:firebase-firestore-ktx\" }\r\ngoogle-firebase-firestore = { group = \"com.google.firebase\", name = \"firebase-firestore\", version.ref = \"firebaseFirestore\" }\r\n\r\n[plugins]\r\nandroid-application = { id = \"com.android.application\", version.ref = \"agp\" }\r\nkotlin-android = { id = \"org.jetbrains.kotlin.android\", version.ref = \"kotlin\" }\r\nkotlin-compose = { id = \"org.jetbrains.kotlin.plugin.compose\", version.ref = \"kotlin\" }\r\nfirebase-gservices = { id = \"com.google.gms.google-services\", version.ref = \"firebase-gservices\" }\r\n\r\n\r\n
+---Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+---<+>UTF-8
+---===================================================================
+---diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
+------ a/gradle/libs.versions.toml	(revision 39a86368e80442156ba767c8ea88d7fdae822333)
+---+++ b/gradle/libs.versions.toml	(date 1762638710995)
+---@@ -1,6 +1,6 @@
+--- [versions]
+--- agp = "8.11.1" #no cambiar de la 8.11.1
+----kotlin = "2.0.21"
+---+kotlin = "2.2.0"
+--- coreKtx = "1.17.0"
+--- junit = "4.13.2"
+--- junitVersion = "1.3.0"
+--Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_18__Changes_.xml
+--===================================================================
+--diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_18__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_18__Changes_.xml
+--deleted file mode 100644
+----- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_18__Changes_.xml	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--+++ /dev/null	(revision d076f828ce2f52136802345ea495ef475f1af8b2)
+--@@ -1,4 +0,0 @@
+---<changelist name="Uncommitted_changes_before_Checkout_at_08_11_2025_22_18_[Changes]" date="1762636735672" recycled="true" deleted="true">
+---  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_08_11_2025_22_18_[Changes]/shelved.patch" />
+---  <option name="DESCRIPTION" value="Uncommitted changes before Checkout at 08/11/2025 22:18 [Changes]" />
+---</changelist>
+--\ No newline at end of file
+-Index: .idea/deploymentTargetSelector.xml
+-IDEA additional info:
+-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+-<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"deploymentTargetSelector\">\r\n    <selectionStates>\r\n      <SelectionState runConfigName=\"app\">\r\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\r\n        <DropdownSelection timestamp=\"2025-11-23T22:20:18.637120500Z\">\r\n          <Target type=\"DEFAULT_BOOT\">\r\n            <handle>\r\n              <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=RZCX7216PCM\" />\r\n            </handle>\r\n          </Target>\r\n        </DropdownSelection>\r\n        <DialogSelection>\r\n          <targets>\r\n            <Target type=\"DEFAULT_BOOT\">\r\n              <handle>\r\n                <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=RZCX7216PCM\" />\r\n              </handle>\r\n            </Target>\r\n            <Target type=\"DEFAULT_BOOT\">\r\n              <handle>\r\n                <DeviceId pluginId=\"PhysicalDevice\" identifier=\"serial=R52T40GVQQB\" />\r\n              </handle>\r\n            </Target>\r\n          </targets>\r\n        </DialogSelection>\r\n      </SelectionState>\r\n    </selectionStates>\r\n  </component>\r\n</project>
+-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+-<+>UTF-8
+-===================================================================
+-diff --git a/.idea/deploymentTargetSelector.xml b/.idea/deploymentTargetSelector.xml
+---- a/.idea/deploymentTargetSelector.xml	(revision 1714c52c981cd82e544abc43b0ceffe53fa17617)
+-+++ b/.idea/deploymentTargetSelector.xml	(date 1764075324509)
+-@@ -4,27 +4,14 @@
+-     <selectionStates>
+-       <SelectionState runConfigName="app">
+-         <option name="selectionMode" value="DROPDOWN" />
+--        <DropdownSelection timestamp="2025-11-23T22:20:18.637120500Z">
+-+        <DropdownSelection timestamp="2025-11-25T12:50:14.655533900Z">
+-           <Target type="DEFAULT_BOOT">
+-             <handle>
+--              <DeviceId pluginId="PhysicalDevice" identifier="serial=RZCX7216PCM" />
+-+              <DeviceId pluginId="LocalEmulator" identifier="path=C:\Users\frinc\.android\avd\Medium_Tablet.avd" />
+-             </handle>
+-           </Target>
+-         </DropdownSelection>
+--        <DialogSelection>
+--          <targets>
+--            <Target type="DEFAULT_BOOT">
+--              <handle>
+--                <DeviceId pluginId="PhysicalDevice" identifier="serial=RZCX7216PCM" />
+--              </handle>
+--            </Target>
+--            <Target type="DEFAULT_BOOT">
+--              <handle>
+--                <DeviceId pluginId="PhysicalDevice" identifier="serial=R52T40GVQQB" />
+--              </handle>
+--            </Target>
+--          </targets>
+--        </DialogSelection>
+-+        <DialogSelection />
+-       </SelectionState>
+-     </selectionStates>
+-   </component>
+Index: .idea/shelf/Uncommitted_changes_before_Update_at_26_11_2025_23_48__Changes_.xml
+===================================================================
+diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_26_11_2025_23_48__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_26_11_2025_23_48__Changes_.xml
+deleted file mode 100644
+--- a/.idea/shelf/Uncommitted_changes_before_Update_at_26_11_2025_23_48__Changes_.xml	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
++++ /dev/null	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
+@@ -1,4 +0,0 @@
+-<changelist name="Uncommitted_changes_before_Update_at_26_11_2025_23_48_[Changes]" date="1764197299549" recycled="true" deleted="true">
+-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_26_11_2025_23_48_[Changes]/shelved.patch" />
+-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 26/11/2025 23:48 [Changes]" />
+-</changelist>
+\ No newline at end of file
+Index: app/src/main/res/drawable/microphone.xml
+===================================================================
+diff --git a/app/src/main/res/drawable/microphone.xml b/app/src/main/res/drawable/microphone.xml
+deleted file mode 100644
+--- a/app/src/main/res/drawable/microphone.xml	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
++++ /dev/null	(revision 72e5c0d143729e2f66ad5e6c4f10e9c46cde8ddd)
+@@ -1,10 +0,0 @@
+-<vector xmlns:android="http://schemas.android.com/apk/res/android"
+-    android:width="24dp"
+-    android:height="24dp"
+-    android:viewportWidth="960"
+-    android:viewportHeight="960"
+-    android:tint="?attr/colorControlNormal">
+-  <path
+-      android:fillColor="@android:color/white"
+-      android:pathData="M480,560Q430,560 395,525Q360,490 360,440L360,200Q360,150 395,115Q430,80 480,80Q530,80 565,115Q600,150 600,200L600,440Q600,490 565,525Q530,560 480,560ZM480,320Q480,320 480,320Q480,320 480,320L480,320Q480,320 480,320Q480,320 480,320Q480,320 480,320Q480,320 480,320L480,320Q480,320 480,320Q480,320 480,320ZM440,840L440,717Q336,703 268,624Q200,545 200,440L280,440Q280,523 338.5,581.5Q397,640 480,640Q563,640 621.5,581.5Q680,523 680,440L760,440Q760,545 692,624Q624,703 520,717L520,840L440,840ZM480,480Q497,480 508.5,468.5Q520,457 520,440L520,200Q520,183 508.5,171.5Q497,160 480,160Q463,160 451.5,171.5Q440,183 440,200L440,440Q440,457 451.5,468.5Q463,480 480,480Z"/>
+-</vector>
